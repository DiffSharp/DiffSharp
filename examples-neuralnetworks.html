<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <!--
      The Neural Networks
 parameters will be replaced with the
      document title extracted from the <h1> element or
      file name, if there is no <h1> heading
    -->
    <title>Neural Networks
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Atılım Güneş Baydin; Barak A. Pearlmutter">
    <meta name="description" content="DiffSharp is an automatic differentiation (AD) library implemented in the F# language by Atılım Güneş Baydin and Barak A. Pearlmutter, mainly for research applications in machine learning, as part of their work at the Brain and Computation Lab, Hamilton Institute, National University of Ireland Maynooth.">

    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">

    <link type="text/css" rel="stylesheet" href="misc/style.css" />
    <script src="misc/tips.js" type="text/javascript"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-48900508-3', 'auto');
      ga('require', 'displayfeatures');
      ga('send', 'pageview');
    </script>
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="https://fsharp.org">fsharp.org</a></li>
        </ul>
        <h3 class="muted">DiffSharp</h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          <div class="row">
    <div class="span9">
    <div class="well well-small" id="nuget" style="background-color:#E0EBEB">
        <b>Please note:</b> this is an introductory example and therefore the code is kept very simple. More advanced cases, including recurrent and convolutional networks, will be released as part of the <a href="https://hypelib.github.io/Hype/">Hype</a> library built on top of DiffSharp.
    </div>
    </div>
</div>

<h1>Neural Networks</h1>
<p><b>NOTE: This page is about an old and deprecated version of DiffSharp.</b></br>
  <b>For DiffSharp 1.0 see <a href="https://diffsharp.github.io/">https://diffsharp.github.io/</a></b>.</p>

<p><a href="https://en.wikipedia.org/wiki/Artificial_neural_network">Artificial neural networks</a> are computational models inspired by biological nervous systems, capable of approximating functions that depend on a large number of inputs. A network is defined by a connectivity structure and a set of weights between interconnected processing units ("neurons"). Neural networks "learn" a given task by tuning the set of weights under an optimization procedure.</p>

<p>Let's create a <a href="https://en.wikipedia.org/wiki/Feedforward_neural_network">feedforward neural network</a> with DiffSharp and implement the <a href="https://en.wikipedia.org/wiki/Backpropagation">backpropagation</a> algorithm for training it. As mentioned before, backpropagation is just a special case of reverse mode AD.</p>

<p>We start by defining our neural network structure.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">DiffSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">AD</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">Float64</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 4)" onmouseover="showTip(event, 'fs1', 4)" class="i">DiffSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs4', 5)" onmouseover="showTip(event, 'fs4', 5)" class="i">Util</span>

<span class="c">// A layer of neurons</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs5', 6)" onmouseover="showTip(event, 'fs5', 6)" class="t">Layer</span> <span class="o">=</span>
    {<span class="k">mutable</span> <span onmouseout="hideTip(event, 'fs6', 7)" onmouseover="showTip(event, 'fs6', 7)" class="v">W</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs7', 8)" onmouseover="showTip(event, 'fs7', 8)" class="t">DM</span>  <span class="c">// Weight matrix</span>
     <span class="k">mutable</span> <span onmouseout="hideTip(event, 'fs8', 9)" onmouseover="showTip(event, 'fs8', 9)" class="v">b</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs9', 10)" onmouseover="showTip(event, 'fs9', 10)" class="t">DV</span>  <span class="c">// Bias vector</span>
     <span onmouseout="hideTip(event, 'fs10', 11)" onmouseover="showTip(event, 'fs10', 11)" class="i">a</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs9', 12)" onmouseover="showTip(event, 'fs9', 12)" class="t">DV</span><span class="k">-&gt;</span><span onmouseout="hideTip(event, 'fs9', 13)" onmouseover="showTip(event, 'fs9', 13)" class="t">DV</span>}     <span class="c">// Activation function</span>

<span class="c">// A feedforward network of several layers</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs11', 14)" onmouseover="showTip(event, 'fs11', 14)" class="t">Network</span> <span class="o">=</span>
    {<span onmouseout="hideTip(event, 'fs12', 15)" onmouseover="showTip(event, 'fs12', 15)" class="i">layers</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs5', 16)" onmouseover="showTip(event, 'fs5', 16)" class="t">Layer</span>[]} <span class="c">// The layers forming this network</span>
</code></pre></td>
</tr>
</table>

<p>The network will consist of several layers of neurons. Each neuron works by taking an input vector <span class="math">\(\mathbf{x}\)</span> and calculating the activation (output)</p>

<p><span class="math">\[  a = \sigma \left(\sum_{i} w_i x_i + b\right) \; ,\]</span></p>

<p>where <span class="math">\(w_i\)</span> are synapse weights associated with each input, <span class="math">\(b\)</span> is a bias, and <span class="math">\(\sigma\)</span> is an <a href="https://en.wikipedia.org/wiki/Activation_function">activation function</a> representing the rate of <a href="https://en.wikipedia.org/wiki/Action_potential">action potential</a> firing in the neuron.</p>

<div class="row">
    <div class="span6 offset2">
        <img src="img/examples-neuralnetworks-neuron.png" alt="Chart" style="width:400px;"/>
    </div>
</div>

<p>A conventional choice for the activation function had been the <a href="https://en.wikipedia.org/wiki/Sigmoid_function">sigmoid</a> <span class="math">\(\sigma (z) = 1 / (1 + e^{-z})\)</span> for a long period because of its simple derivative and gain control properties. Recently the hyperbolic tangent <span class="math">\(\tanh\)</span> and the <a href="https://en.wikipedia.org/wiki/Rectifier_(neural_networks)">rectified linear unit</a> <span class="math">\(\textrm{ReLU}(z) = \max(0, z)\)</span> have been more popular choices due to their convergence and performance characteristics.</p>

<p>Now let's write the network evaluation code and a function for creating a given network configuration and initializing the weights and biases with small random values. In practice, proper weight initialization has been demonstrated to have an important effect on training convergence and it would depend on the network structure and the type of activation functions used.</p>

<p>Network evaluation is implemented using linear algebra, where we have a weight matrix <span class="math">\(\mathbf{W}^l\)</span> holding the weights of all neurons in layer <span class="math">\(l\)</span>. The elements of this matrix <span class="math">\(w_{ij}\)</span> represent the weight between the <span class="math">\(j\)</span>-th neuron in layer <span class="math">\(l - 1\)</span> and the <span class="math">\(i\)</span>-th neuron in layer <span class="math">\(l\)</span>. We also have a bias vector <span class="math">\(\mathbf{b}^l\)</span> holding the biases of all neurons in layer <span class="math">\(l\)</span> (one bias per neuron). Thus evaluating the network is just a matter of computing the activation</p>

<p><span class="math">\[  \mathbf{a}^l = \mathbf{W}^l \mathbf{a}^{l - 1} + \mathbf{b}^l \; ,\]</span></p>

<p>for each layer and passing the activation vector (output) of each layer as the input to the next layer, until we get the network output as the output vector of the last layer.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs13', 17)" onmouseover="showTip(event, 'fs13', 17)" class="f">runLayer</span> (<span onmouseout="hideTip(event, 'fs14', 18)" onmouseover="showTip(event, 'fs14', 18)" class="i">x</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs9', 19)" onmouseover="showTip(event, 'fs9', 19)" class="t">DV</span>) (<span onmouseout="hideTip(event, 'fs15', 20)" onmouseover="showTip(event, 'fs15', 20)" class="i">l</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs5', 21)" onmouseover="showTip(event, 'fs5', 21)" class="t">Layer</span>) <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs15', 22)" onmouseover="showTip(event, 'fs15', 22)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs6', 23)" onmouseover="showTip(event, 'fs6', 23)" class="v">W</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs14', 24)" onmouseover="showTip(event, 'fs14', 24)" class="i">x</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs15', 25)" onmouseover="showTip(event, 'fs15', 25)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs8', 26)" onmouseover="showTip(event, 'fs8', 26)" class="v">b</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs15', 27)" onmouseover="showTip(event, 'fs15', 27)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs10', 28)" onmouseover="showTip(event, 'fs10', 28)" class="i">a</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs16', 29)" onmouseover="showTip(event, 'fs16', 29)" class="f">runNetwork</span> (<span onmouseout="hideTip(event, 'fs14', 30)" onmouseover="showTip(event, 'fs14', 30)" class="i">x</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs9', 31)" onmouseover="showTip(event, 'fs9', 31)" class="t">DV</span>) (<span onmouseout="hideTip(event, 'fs17', 32)" onmouseover="showTip(event, 'fs17', 32)" class="i">n</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs11', 33)" onmouseover="showTip(event, 'fs11', 33)" class="t">Network</span>) <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs18', 34)" onmouseover="showTip(event, 'fs18', 34)" class="t">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs19', 35)" onmouseover="showTip(event, 'fs19', 35)" class="f">fold</span> <span onmouseout="hideTip(event, 'fs13', 36)" onmouseover="showTip(event, 'fs13', 36)" class="f">runLayer</span> <span onmouseout="hideTip(event, 'fs14', 37)" onmouseover="showTip(event, 'fs14', 37)" class="i">x</span> <span onmouseout="hideTip(event, 'fs17', 38)" onmouseover="showTip(event, 'fs17', 38)" class="i">n</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 39)" onmouseover="showTip(event, 'fs12', 39)" class="i">layers</span>


<span class="k">let</span> <span onmouseout="hideTip(event, 'fs20', 40)" onmouseover="showTip(event, 'fs20', 40)" class="i">rnd</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs21', 41)" onmouseover="showTip(event, 'fs21', 41)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 42)" onmouseover="showTip(event, 'fs22', 42)" class="t">Random</span>()

<span class="c">// Initialize a fully connected feedforward neural network</span>
<span class="c">// Weights and biases between -0.5 and 0.5</span>
<span class="c">// l : number of inputs, followed by the number of neurons in each subsequent layer</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs23', 43)" onmouseover="showTip(event, 'fs23', 43)" class="f">createNetwork</span> (<span onmouseout="hideTip(event, 'fs24', 44)" onmouseover="showTip(event, 'fs24', 44)" class="i">l</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs25', 45)" onmouseover="showTip(event, 'fs25', 45)" class="t">int</span>[]) <span class="o">=</span>
    {<span class="i">layers</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs18', 46)" onmouseover="showTip(event, 'fs18', 46)" class="t">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs26', 47)" onmouseover="showTip(event, 'fs26', 47)" class="f">init</span> (<span onmouseout="hideTip(event, 'fs24', 48)" onmouseover="showTip(event, 'fs24', 48)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs27', 49)" onmouseover="showTip(event, 'fs27', 49)" class="i">Length</span> <span class="o">-</span> <span class="n">1</span>) (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs28', 50)" onmouseover="showTip(event, 'fs28', 50)" class="i">i</span> <span class="k">-&gt;</span>
        {<span onmouseout="hideTip(event, 'fs6', 51)" onmouseover="showTip(event, 'fs6', 51)" class="v">W</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs7', 52)" onmouseover="showTip(event, 'fs7', 52)" class="t">DM</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs29', 53)" onmouseover="showTip(event, 'fs29', 53)" class="f">init</span> <span onmouseout="hideTip(event, 'fs24', 54)" onmouseover="showTip(event, 'fs24', 54)" class="i">l</span><span class="o">.</span>[<span onmouseout="hideTip(event, 'fs28', 55)" onmouseover="showTip(event, 'fs28', 55)" class="i">i</span> <span class="o">+</span> <span class="n">1</span>] <span onmouseout="hideTip(event, 'fs24', 56)" onmouseover="showTip(event, 'fs24', 56)" class="i">l</span><span class="o">.</span>[<span onmouseout="hideTip(event, 'fs28', 57)" onmouseover="showTip(event, 'fs28', 57)" class="i">i</span>] (<span class="k">fun</span> _ _ <span class="k">-&gt;</span> <span class="o">-</span><span class="n">0.5</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs20', 58)" onmouseover="showTip(event, 'fs20', 58)" class="i">rnd</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs30', 59)" onmouseover="showTip(event, 'fs30', 59)" class="f">NextDouble</span>())
         <span onmouseout="hideTip(event, 'fs8', 60)" onmouseover="showTip(event, 'fs8', 60)" class="v">b</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs9', 61)" onmouseover="showTip(event, 'fs9', 61)" class="t">DV</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs31', 62)" onmouseover="showTip(event, 'fs31', 62)" class="f">init</span> <span onmouseout="hideTip(event, 'fs24', 63)" onmouseover="showTip(event, 'fs24', 63)" class="i">l</span><span class="o">.</span>[<span onmouseout="hideTip(event, 'fs28', 64)" onmouseover="showTip(event, 'fs28', 64)" class="i">i</span> <span class="o">+</span> <span class="n">1</span>] (<span class="k">fun</span> _ <span class="k">-&gt;</span> <span class="o">-</span><span class="n">0.5</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs20', 65)" onmouseover="showTip(event, 'fs20', 65)" class="i">rnd</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs30', 66)" onmouseover="showTip(event, 'fs30', 66)" class="f">NextDouble</span>())
         <span onmouseout="hideTip(event, 'fs10', 67)" onmouseover="showTip(event, 'fs10', 67)" class="i">a</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs32', 68)" onmouseover="showTip(event, 'fs32', 68)" class="f">sigmoid</span>})}
</code></pre></td>
</tr>
</table>

<p>This gives us an easily scalable feedforward network architecture capable of expressing any number of inputs, outputs, and hidden layers. The network is fully connected, meaning that each neuron in a layer receives the output of all the neurons in the previous layer.</p>

<p>For example,</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs33', 69)" onmouseover="showTip(event, 'fs33', 69)" class="i">net1</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs23', 70)" onmouseover="showTip(event, 'fs23', 70)" class="f">createNetwork</span> [|<span class="n">3</span>; <span class="n">4</span>; <span class="n">2</span>|]
</code></pre></td>
</tr>
</table>

<p>would give us the following network with 3 input nodes, a hidden layer with 4 neurons, and an output layer with 2 neurons:</p>

<div class="row">
    <div class="span6 offset2">
        <img src="img/examples-neuralnetworks-network.png" alt="Chart" style="width:400px;"/>
    </div>
</div>

<p>We can also have more than one hidden layer.</p>

<p>For training networks, we will make use of reverse mode AD for propagating a loss <span class="math">\(Q\)</span> at the output backwards through the network weights. This will give us the partial derivative of the loss at the output with respect to each weight <span class="math">\(w_i\)</span> and bias <span class="math">\(b_i\)</span> in the network, which we will then use in an update rule</p>

<p><span class="math">\[ \begin{eqnarray*}
 \Delta w_i &amp;=&amp; -\eta \frac{\partial Q}{\partial w_i} \; ,\\
 \Delta b_i &amp;=&amp; -\eta \frac{\partial Q}{\partial b_i} \; ,\\
 \end{eqnarray*}\]</span></p>

<p>where <span class="math">\(\eta\)</span> is the learning rate.</p>

<p>We will use the <a href="https://en.wikipedia.org/wiki/Mean_squared_error">quadratic loss</a></p>

<p><span class="math">\[ Q = \sum_{i=1}^{d} \Vert \mathbf{y}_i - \mathbf{a}(\mathbf{x}_i) \Vert^{2} \; ,\]</span></p>

<p>where there are <span class="math">\(d\)</span> cases in the training set, <span class="math">\(\mathbf{y}_i\)</span> is the <span class="math">\(i\)</span>-th training target and <span class="math">\(\mathbf{a}(\mathbf{x}_i)\)</span> is the output vector of the last layer when the <span class="math">\(i\)</span>-th training input <span class="math">\(\mathbf{x}_i\)</span> is supplied to the first layer.</p>

<p>Please see the <a href="gettingstarted-nestedad.html">Nested AD</a> page for a better understanding of the low-level usage of adjoints and their backwards propagation.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// The backpropagation algorithm</span>
<span class="c">// n: network to be trained</span>
<span class="c">// eta: learning rate</span>
<span class="c">// epochs: number of training epochs</span>
<span class="c">// x: training input vectors</span>
<span class="c">// y: training target vectors</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs34', 71)" onmouseover="showTip(event, 'fs34', 71)" class="f">backprop</span> (<span onmouseout="hideTip(event, 'fs17', 72)" onmouseover="showTip(event, 'fs17', 72)" class="i">n</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs11', 73)" onmouseover="showTip(event, 'fs11', 73)" class="t">Network</span>) <span onmouseout="hideTip(event, 'fs35', 74)" onmouseover="showTip(event, 'fs35', 74)" class="i">eta</span> <span onmouseout="hideTip(event, 'fs36', 75)" onmouseover="showTip(event, 'fs36', 75)" class="i">epochs</span> (<span onmouseout="hideTip(event, 'fs37', 76)" onmouseover="showTip(event, 'fs37', 76)" class="i">x</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs9', 77)" onmouseover="showTip(event, 'fs9', 77)" class="t">DV</span>[]) (<span onmouseout="hideTip(event, 'fs38', 78)" onmouseover="showTip(event, 'fs38', 78)" class="i">y</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs9', 79)" onmouseover="showTip(event, 'fs9', 79)" class="t">DV</span>[]) <span class="o">=</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs39', 80)" onmouseover="showTip(event, 'fs39', 80)" class="i">i</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs1', 81)" onmouseover="showTip(event, 'fs1', 81)" class="i">DiffSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs4', 82)" onmouseover="showTip(event, 'fs4', 82)" class="t">Util</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs40', 83)" onmouseover="showTip(event, 'fs40', 83)" class="t">GlobalTagger</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs41', 84)" onmouseover="showTip(event, 'fs41', 84)" class="i">Next</span>
    <span onmouseout="hideTip(event, 'fs42', 85)" onmouseover="showTip(event, 'fs42', 85)" class="i">seq</span> {<span class="k">for</span> <span onmouseout="hideTip(event, 'fs43', 86)" onmouseover="showTip(event, 'fs43', 86)" class="i">j</span> <span class="k">in</span> <span class="n">0</span> <span class="o">..</span> <span onmouseout="hideTip(event, 'fs36', 87)" onmouseover="showTip(event, 'fs36', 87)" class="i">epochs</span> <span class="k">do</span>
            <span class="k">for</span> <span onmouseout="hideTip(event, 'fs15', 88)" onmouseover="showTip(event, 'fs15', 88)" class="i">l</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs17', 89)" onmouseover="showTip(event, 'fs17', 89)" class="i">n</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 90)" onmouseover="showTip(event, 'fs12', 90)" class="i">layers</span> <span class="k">do</span>
                <span onmouseout="hideTip(event, 'fs15', 91)" onmouseover="showTip(event, 'fs15', 91)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs6', 92)" onmouseover="showTip(event, 'fs6', 92)" class="v">W</span> <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs15', 93)" onmouseover="showTip(event, 'fs15', 93)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs6', 94)" onmouseover="showTip(event, 'fs6', 94)" class="v">W</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs44', 95)" onmouseover="showTip(event, 'fs44', 95)" class="f">makeReverse</span> <span onmouseout="hideTip(event, 'fs39', 96)" onmouseover="showTip(event, 'fs39', 96)" class="i">i</span>
                <span onmouseout="hideTip(event, 'fs15', 97)" onmouseover="showTip(event, 'fs15', 97)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs8', 98)" onmouseover="showTip(event, 'fs8', 98)" class="v">b</span> <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs15', 99)" onmouseover="showTip(event, 'fs15', 99)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs8', 100)" onmouseover="showTip(event, 'fs8', 100)" class="v">b</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs44', 101)" onmouseover="showTip(event, 'fs44', 101)" class="f">makeReverse</span> <span onmouseout="hideTip(event, 'fs39', 102)" onmouseover="showTip(event, 'fs39', 102)" class="i">i</span>

            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs45', 103)" onmouseover="showTip(event, 'fs45', 103)" class="i">L</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs18', 104)" onmouseover="showTip(event, 'fs18', 104)" class="t">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs46', 105)" onmouseover="showTip(event, 'fs46', 105)" class="f">map2</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs14', 106)" onmouseover="showTip(event, 'fs14', 106)" class="i">x</span> <span onmouseout="hideTip(event, 'fs47', 107)" onmouseover="showTip(event, 'fs47', 107)" class="i">y</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs9', 108)" onmouseover="showTip(event, 'fs9', 108)" class="t">DV</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs48', 109)" onmouseover="showTip(event, 'fs48', 109)" class="f">l2normSq</span> (<span onmouseout="hideTip(event, 'fs47', 110)" onmouseover="showTip(event, 'fs47', 110)" class="i">y</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs16', 111)" onmouseover="showTip(event, 'fs16', 111)" class="f">runNetwork</span> <span onmouseout="hideTip(event, 'fs14', 112)" onmouseover="showTip(event, 'fs14', 112)" class="i">x</span> <span onmouseout="hideTip(event, 'fs17', 113)" onmouseover="showTip(event, 'fs17', 113)" class="i">n</span>)) <span onmouseout="hideTip(event, 'fs37', 114)" onmouseover="showTip(event, 'fs37', 114)" class="i">x</span> <span onmouseout="hideTip(event, 'fs38', 115)" onmouseover="showTip(event, 'fs38', 115)" class="i">y</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs18', 116)" onmouseover="showTip(event, 'fs18', 116)" class="t">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs49', 117)" onmouseover="showTip(event, 'fs49', 117)" class="f">sum</span>
            <span onmouseout="hideTip(event, 'fs45', 118)" onmouseover="showTip(event, 'fs45', 118)" class="i">L</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs50', 119)" onmouseover="showTip(event, 'fs50', 119)" class="f">reverseProp</span> (<span onmouseout="hideTip(event, 'fs51', 120)" onmouseover="showTip(event, 'fs51', 120)" class="p">D</span> <span class="n">1.</span>) <span class="c">// Propagate adjoint value 1 backward</span>

            <span class="k">for</span> <span onmouseout="hideTip(event, 'fs15', 121)" onmouseover="showTip(event, 'fs15', 121)" class="i">l</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs17', 122)" onmouseover="showTip(event, 'fs17', 122)" class="i">n</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 123)" onmouseover="showTip(event, 'fs12', 123)" class="i">layers</span> <span class="k">do</span>
                <span onmouseout="hideTip(event, 'fs15', 124)" onmouseover="showTip(event, 'fs15', 124)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs6', 125)" onmouseover="showTip(event, 'fs6', 125)" class="v">W</span> <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs52', 126)" onmouseover="showTip(event, 'fs52', 126)" class="f">primal</span> (<span onmouseout="hideTip(event, 'fs15', 127)" onmouseover="showTip(event, 'fs15', 127)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs6', 128)" onmouseover="showTip(event, 'fs6', 128)" class="v">W</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs53', 129)" onmouseover="showTip(event, 'fs53', 129)" class="i">P</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs35', 130)" onmouseover="showTip(event, 'fs35', 130)" class="i">eta</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs15', 131)" onmouseover="showTip(event, 'fs15', 131)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs6', 132)" onmouseover="showTip(event, 'fs6', 132)" class="v">W</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs54', 133)" onmouseover="showTip(event, 'fs54', 133)" class="i">A</span>)
                <span onmouseout="hideTip(event, 'fs15', 134)" onmouseover="showTip(event, 'fs15', 134)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs8', 135)" onmouseover="showTip(event, 'fs8', 135)" class="v">b</span> <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs52', 136)" onmouseover="showTip(event, 'fs52', 136)" class="f">primal</span> (<span onmouseout="hideTip(event, 'fs15', 137)" onmouseover="showTip(event, 'fs15', 137)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs8', 138)" onmouseover="showTip(event, 'fs8', 138)" class="v">b</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs55', 139)" onmouseover="showTip(event, 'fs55', 139)" class="i">P</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs35', 140)" onmouseover="showTip(event, 'fs35', 140)" class="i">eta</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs15', 141)" onmouseover="showTip(event, 'fs15', 141)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs8', 142)" onmouseover="showTip(event, 'fs8', 142)" class="v">b</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs56', 143)" onmouseover="showTip(event, 'fs56', 143)" class="i">A</span>)

            <span onmouseout="hideTip(event, 'fs57', 144)" onmouseover="showTip(event, 'fs57', 144)" class="f">printfn</span> <span class="s">&quot;Iteration </span><span class="pf">%i</span><span class="s">, loss </span><span class="pf">%f</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs43', 145)" onmouseover="showTip(event, 'fs43', 145)" class="i">j</span> (<span onmouseout="hideTip(event, 'fs58', 146)" onmouseover="showTip(event, 'fs58', 146)" class="f">float</span> <span onmouseout="hideTip(event, 'fs45', 147)" onmouseover="showTip(event, 'fs45', 147)" class="i">L</span>)
            <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs58', 148)" onmouseover="showTip(event, 'fs58', 148)" class="f">float</span> <span onmouseout="hideTip(event, 'fs45', 149)" onmouseover="showTip(event, 'fs45', 149)" class="i">L</span>}
</code></pre></td>
</tr>
</table>

<p>Using reverse mode AD here has two big advantages: (1) it makes the backpropagation code succinct and straightforward to write and maintain; and (2) it allows us to freely code our neural network without the burden of coding derivatives or modifying the backpropagation code accordingly.</p>

<p>We can now test the algorithm by training some networks.</p>

<p>It is known that <a href="https://en.wikipedia.org/wiki/Linear_separability">linearly separable</a> rules such as <a href="https://en.wikipedia.org/wiki/Logical_disjunction">logical disjunction</a> can be learned by a single neuron.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs59', 150)" onmouseover="showTip(event, 'fs59', 150)" class="i">FSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs60', 151)" onmouseover="showTip(event, 'fs60', 151)" class="i">Charting</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs61', 152)" onmouseover="showTip(event, 'fs61', 152)" class="i">ORx</span> <span class="o">=</span> [|<span onmouseout="hideTip(event, 'fs62', 153)" onmouseover="showTip(event, 'fs62', 153)" class="f">toDV</span> [<span class="n">0.</span>; <span class="n">0.</span>]
            <span onmouseout="hideTip(event, 'fs62', 154)" onmouseover="showTip(event, 'fs62', 154)" class="f">toDV</span> [<span class="n">0.</span>; <span class="n">1.</span>]
            <span onmouseout="hideTip(event, 'fs62', 155)" onmouseover="showTip(event, 'fs62', 155)" class="f">toDV</span> [<span class="n">1.</span>; <span class="n">0.</span>]
            <span onmouseout="hideTip(event, 'fs62', 156)" onmouseover="showTip(event, 'fs62', 156)" class="f">toDV</span> [<span class="n">1.</span>; <span class="n">1.</span>]|]
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs63', 157)" onmouseover="showTip(event, 'fs63', 157)" class="i">ORy</span> <span class="o">=</span> [|<span onmouseout="hideTip(event, 'fs62', 158)" onmouseover="showTip(event, 'fs62', 158)" class="f">toDV</span> [<span class="n">0.</span>]
            <span onmouseout="hideTip(event, 'fs62', 159)" onmouseover="showTip(event, 'fs62', 159)" class="f">toDV</span> [<span class="n">1.</span>]
            <span onmouseout="hideTip(event, 'fs62', 160)" onmouseover="showTip(event, 'fs62', 160)" class="f">toDV</span> [<span class="n">1.</span>]
            <span onmouseout="hideTip(event, 'fs62', 161)" onmouseover="showTip(event, 'fs62', 161)" class="f">toDV</span> [<span class="n">1.</span>]|]

<span class="c">// 2 inputs, one layer with one neuron</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs64', 162)" onmouseover="showTip(event, 'fs64', 162)" class="i">net2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs23', 163)" onmouseover="showTip(event, 'fs23', 163)" class="f">createNetwork</span> [|<span class="n">2</span>; <span class="n">1</span>|]

<span class="c">// Train</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs65', 164)" onmouseover="showTip(event, 'fs65', 164)" class="i">train2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs34', 165)" onmouseover="showTip(event, 'fs34', 165)" class="f">backprop</span> <span onmouseout="hideTip(event, 'fs64', 166)" onmouseover="showTip(event, 'fs64', 166)" class="i">net2</span> <span class="n">0.9</span> <span class="n">1000</span> <span onmouseout="hideTip(event, 'fs61', 167)" onmouseover="showTip(event, 'fs61', 167)" class="i">ORx</span> <span onmouseout="hideTip(event, 'fs63', 168)" onmouseover="showTip(event, 'fs63', 168)" class="i">ORy</span>

<span class="c">// Plot the error during training</span>
<span onmouseout="hideTip(event, 'fs66', 169)" onmouseover="showTip(event, 'fs66', 169)" class="t">Chart</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs67', 170)" onmouseover="showTip(event, 'fs67', 170)" class="f">Line</span> <span onmouseout="hideTip(event, 'fs65', 171)" onmouseover="showTip(event, 'fs65', 171)" class="i">train2</span>
</code></pre></td>
</tr>
</table>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="cs">val net2 <span class="o">:</span> Network <span class="o">=</span> {layers <span class="o">=</span> [<span class="o">|</span>{W <span class="o">=</span> DM [[0.230677625; 0.1414874814]];
                                  b <span class="o">=</span> DV [|0.4233988253|];}<span class="o">|</span>];}
</code></pre></td></tr></table>

<div class="row">
    <div class="span6 offset1">
        <img src="img/examples-neuralnetworks-chart1.png" alt="Chart" style="width:550px"/>
    </div>
</div>

<p>Linearly inseparable problems such as <a href="https://en.wikipedia.org/wiki/Exclusive_or">exclusive or</a> require one or more hidden layers to learn.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs68', 172)" onmouseover="showTip(event, 'fs68', 172)" class="i">XORx</span> <span class="o">=</span> [|<span onmouseout="hideTip(event, 'fs62', 173)" onmouseover="showTip(event, 'fs62', 173)" class="f">toDV</span> [<span class="n">0.</span>; <span class="n">0.</span>]
             <span onmouseout="hideTip(event, 'fs62', 174)" onmouseover="showTip(event, 'fs62', 174)" class="f">toDV</span> [<span class="n">0.</span>; <span class="n">1.</span>]
             <span onmouseout="hideTip(event, 'fs62', 175)" onmouseover="showTip(event, 'fs62', 175)" class="f">toDV</span> [<span class="n">1.</span>; <span class="n">0.</span>]
             <span onmouseout="hideTip(event, 'fs62', 176)" onmouseover="showTip(event, 'fs62', 176)" class="f">toDV</span> [<span class="n">1.</span>; <span class="n">1.</span>]|]
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs69', 177)" onmouseover="showTip(event, 'fs69', 177)" class="i">XORy</span> <span class="o">=</span> [|<span onmouseout="hideTip(event, 'fs62', 178)" onmouseover="showTip(event, 'fs62', 178)" class="f">toDV</span> [<span class="n">0.</span>]
             <span onmouseout="hideTip(event, 'fs62', 179)" onmouseover="showTip(event, 'fs62', 179)" class="f">toDV</span> [<span class="n">1.</span>]
             <span onmouseout="hideTip(event, 'fs62', 180)" onmouseover="showTip(event, 'fs62', 180)" class="f">toDV</span> [<span class="n">1.</span>]
             <span onmouseout="hideTip(event, 'fs62', 181)" onmouseover="showTip(event, 'fs62', 181)" class="f">toDV</span> [<span class="n">0.</span>]|]

<span class="c">// 2 inputs, 3 neurons in a hidden layer, 1 neuron in the output layer</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs70', 182)" onmouseover="showTip(event, 'fs70', 182)" class="i">net3</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs23', 183)" onmouseover="showTip(event, 'fs23', 183)" class="f">createNetwork</span> [|<span class="n">2</span>; <span class="n">3</span>; <span class="n">1</span>|]

<span class="c">// Train</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs71', 184)" onmouseover="showTip(event, 'fs71', 184)" class="i">train3</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs34', 185)" onmouseover="showTip(event, 'fs34', 185)" class="f">backprop</span> <span onmouseout="hideTip(event, 'fs70', 186)" onmouseover="showTip(event, 'fs70', 186)" class="i">net3</span> <span class="n">0.9</span> <span class="n">1000</span> <span onmouseout="hideTip(event, 'fs68', 187)" onmouseover="showTip(event, 'fs68', 187)" class="i">XORx</span> <span onmouseout="hideTip(event, 'fs69', 188)" onmouseover="showTip(event, 'fs69', 188)" class="i">XORy</span>

<span class="c">// Plot the error during training</span>
<span onmouseout="hideTip(event, 'fs66', 189)" onmouseover="showTip(event, 'fs66', 189)" class="t">Chart</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs67', 190)" onmouseover="showTip(event, 'fs67', 190)" class="f">Line</span> <span onmouseout="hideTip(event, 'fs71', 191)" onmouseover="showTip(event, 'fs71', 191)" class="i">train3</span>
</code></pre></td>
</tr>
</table>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="cs">val net3 <span class="o">:</span> Network <span class="o">=</span>
  {layers <span class="o">=</span>
    [<span class="o">|</span>{W <span class="o">=</span> DM [[-0.04536837132; -0.3447727025]
               [-0.07626016418; 0.06522091877]
               [0.2581558948; 0.1597980939]];
       b <span class="o">=</span> DV [<span class="o">|</span>-0.3051199176; 0.2980325892; 0.4621827649|];};
      {W <span class="o">=</span> DM [[-0.347911722; 0.2696812725; 0.2704776571]];
       b <span class="o">=</span> DV [<span class="o">|</span>-0.1477482923|];}<span class="o">|</span>];}
</code></pre></td></tr></table>

<div class="row">
    <div class="span6 offset1">
        <img src="img/examples-neuralnetworks-chart2.png" alt="Chart" style="width:550px"/>
    </div>
</div>

<h2>Some Performance Tricks</h2>

<p>For higher training performance, it is better to propagate matrices, instead of vectors, through the network. In other words, instead of treating the traning data as a set of input vectors <span class="math">\(\mathbf{x}_i \in \mathbb{R}^n\)</span> and target vectors <span class="math">\(\mathbf{y}_i \in \mathbb{R}^m\)</span>, <span class="math">\(i = 1 \dots d\)</span>, we can have an input matrix <span class="math">\(\mathbf{X} \in \mathbb{R}^{n\times d}\)</span> and a target matrix <span class="math">\(\mathbf{Y} \in \mathbb{R}^{m\times d}\)</span>, where <span class="math">\(d\)</span> is the number of examples in the training set. In this scheme, vectors <span class="math">\(\mathbf{x}_i\)</span> form the columns of the input matrix <span class="math">\(\mathbf{X}\)</span>, and propagating <span class="math">\(\mathbf{X}\)</span> through the layers computes the network's output for all <span class="math">\(\mathbf{x}_i\)</span> simultaneously. In DiffSharp, as in other linear algebra libraries, computing matrix-matrix multiplications are a lot more efficient than computing a series of matrix-vector multiplications.</p>

<p>Let's modify the network evaluation code to propagate matrices.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// A layer of neurons</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs72', 192)" onmouseover="showTip(event, 'fs72', 192)" class="t">Layer&#39;</span> <span class="o">=</span>
    {<span class="k">mutable</span> <span onmouseout="hideTip(event, 'fs73', 193)" onmouseover="showTip(event, 'fs73', 193)" class="v">W</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs7', 194)" onmouseover="showTip(event, 'fs7', 194)" class="t">DM</span>  <span class="c">// Weight matrix</span>
     <span class="k">mutable</span> <span onmouseout="hideTip(event, 'fs74', 195)" onmouseover="showTip(event, 'fs74', 195)" class="v">b</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs9', 196)" onmouseover="showTip(event, 'fs9', 196)" class="t">DV</span>  <span class="c">// Bias vector</span>
     <span onmouseout="hideTip(event, 'fs75', 197)" onmouseover="showTip(event, 'fs75', 197)" class="i">a</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs7', 198)" onmouseover="showTip(event, 'fs7', 198)" class="t">DM</span><span class="k">-&gt;</span><span onmouseout="hideTip(event, 'fs7', 199)" onmouseover="showTip(event, 'fs7', 199)" class="t">DM</span>}     <span class="c">// Activation function</span>

<span class="c">// A feedforward network of neuron layers</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs76', 200)" onmouseover="showTip(event, 'fs76', 200)" class="t">Network&#39;</span> <span class="o">=</span>
    {<span onmouseout="hideTip(event, 'fs77', 201)" onmouseover="showTip(event, 'fs77', 201)" class="i">layers</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs72', 202)" onmouseover="showTip(event, 'fs72', 202)" class="t">Layer&#39;</span>[]} <span class="c">// The layers forming this network</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs78', 203)" onmouseover="showTip(event, 'fs78', 203)" class="f">runLayer&#39;</span> (<span onmouseout="hideTip(event, 'fs79', 204)" onmouseover="showTip(event, 'fs79', 204)" class="i">x</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs7', 205)" onmouseover="showTip(event, 'fs7', 205)" class="t">DM</span>) (<span onmouseout="hideTip(event, 'fs80', 206)" onmouseover="showTip(event, 'fs80', 206)" class="i">l</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs72', 207)" onmouseover="showTip(event, 'fs72', 207)" class="t">Layer&#39;</span>) <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs80', 208)" onmouseover="showTip(event, 'fs80', 208)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs73', 209)" onmouseover="showTip(event, 'fs73', 209)" class="v">W</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs79', 210)" onmouseover="showTip(event, 'fs79', 210)" class="i">x</span> <span class="o">+</span> (<span onmouseout="hideTip(event, 'fs7', 211)" onmouseover="showTip(event, 'fs7', 211)" class="t">DM</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs81', 212)" onmouseover="showTip(event, 'fs81', 212)" class="f">createCols</span> <span onmouseout="hideTip(event, 'fs79', 213)" onmouseover="showTip(event, 'fs79', 213)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs82', 214)" onmouseover="showTip(event, 'fs82', 214)" class="i">Cols</span> <span onmouseout="hideTip(event, 'fs80', 215)" onmouseover="showTip(event, 'fs80', 215)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs74', 216)" onmouseover="showTip(event, 'fs74', 216)" class="v">b</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs80', 217)" onmouseover="showTip(event, 'fs80', 217)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs75', 218)" onmouseover="showTip(event, 'fs75', 218)" class="i">a</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs83', 219)" onmouseover="showTip(event, 'fs83', 219)" class="f">runNetwork&#39;</span> (<span onmouseout="hideTip(event, 'fs79', 220)" onmouseover="showTip(event, 'fs79', 220)" class="i">x</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs7', 221)" onmouseover="showTip(event, 'fs7', 221)" class="t">DM</span>) (<span onmouseout="hideTip(event, 'fs84', 222)" onmouseover="showTip(event, 'fs84', 222)" class="i">n</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs76', 223)" onmouseover="showTip(event, 'fs76', 223)" class="t">Network&#39;</span>) <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs18', 224)" onmouseover="showTip(event, 'fs18', 224)" class="t">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs19', 225)" onmouseover="showTip(event, 'fs19', 225)" class="f">fold</span> <span onmouseout="hideTip(event, 'fs78', 226)" onmouseover="showTip(event, 'fs78', 226)" class="f">runLayer&#39;</span> <span onmouseout="hideTip(event, 'fs79', 227)" onmouseover="showTip(event, 'fs79', 227)" class="i">x</span> <span onmouseout="hideTip(event, 'fs84', 228)" onmouseover="showTip(event, 'fs84', 228)" class="i">n</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs77', 229)" onmouseover="showTip(event, 'fs77', 229)" class="i">layers</span>
</code></pre></td>
</tr>
</table>

<p>The backpropagation code given previously computed the loss over the whole set of training cases at each iteration and used simple gradient descent to iteratively decrease this loss. When the training set is large, this leads to training time bottlenecks.</p>

<p>In practice, backpropagation is combined with stochastic gradient descent (SGD), which makes the duration of each training iteration independent from the training set size (also see the <a href="examples-stochasticgradientdescent.html">SGD example</a>). Furthermore, instead of using one random case at a time to compute the loss, SGD is used with "minibatches" of more than one case (a small number compared to the full training set size). Minibatches allow us to exploit the matrix-matrix multiplication trick for performance and also have the added benefit of smoothing the SGD estimation of the true gradient.</p>

<p>Backpropagation combined with SGD and minibatches is the de facto standard for training neural networks.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// Backpropagation with SGD and minibatches</span>
<span class="c">// n: network</span>
<span class="c">// eta: learning rate</span>
<span class="c">// epochs: number of training epochs</span>
<span class="c">// mbsize: minibatch size</span>
<span class="c">// loss: loss function</span>
<span class="c">// x: training input matrix</span>
<span class="c">// y: training target matrix</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs85', 230)" onmouseover="showTip(event, 'fs85', 230)" class="f">backprop&#39;</span> (<span onmouseout="hideTip(event, 'fs84', 231)" onmouseover="showTip(event, 'fs84', 231)" class="i">n</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs76', 232)" onmouseover="showTip(event, 'fs76', 232)" class="t">Network&#39;</span>) (<span onmouseout="hideTip(event, 'fs35', 233)" onmouseover="showTip(event, 'fs35', 233)" class="i">eta</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs58', 234)" onmouseover="showTip(event, 'fs58', 234)" class="t">float</span>) <span onmouseout="hideTip(event, 'fs36', 235)" onmouseover="showTip(event, 'fs36', 235)" class="i">epochs</span> <span onmouseout="hideTip(event, 'fs86', 236)" onmouseover="showTip(event, 'fs86', 236)" class="i">mbsize</span> <span onmouseout="hideTip(event, 'fs87', 237)" onmouseover="showTip(event, 'fs87', 237)" class="f">loss</span> (<span onmouseout="hideTip(event, 'fs79', 238)" onmouseover="showTip(event, 'fs79', 238)" class="i">x</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs7', 239)" onmouseover="showTip(event, 'fs7', 239)" class="t">DM</span>) (<span onmouseout="hideTip(event, 'fs88', 240)" onmouseover="showTip(event, 'fs88', 240)" class="i">y</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs7', 241)" onmouseover="showTip(event, 'fs7', 241)" class="t">DM</span>) <span class="o">=</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs39', 242)" onmouseover="showTip(event, 'fs39', 242)" class="i">i</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs1', 243)" onmouseover="showTip(event, 'fs1', 243)" class="i">DiffSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs4', 244)" onmouseover="showTip(event, 'fs4', 244)" class="t">Util</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs40', 245)" onmouseover="showTip(event, 'fs40', 245)" class="t">GlobalTagger</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs41', 246)" onmouseover="showTip(event, 'fs41', 246)" class="i">Next</span>
    <span class="k">let</span> <span class="k">mutable</span> <span onmouseout="hideTip(event, 'fs89', 247)" onmouseover="showTip(event, 'fs89', 247)" class="v">b</span> <span class="o">=</span> <span class="n">0</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs90', 248)" onmouseover="showTip(event, 'fs90', 248)" class="i">batches</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs79', 249)" onmouseover="showTip(event, 'fs79', 249)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs82', 250)" onmouseover="showTip(event, 'fs82', 250)" class="i">Cols</span> <span class="o">/</span> <span onmouseout="hideTip(event, 'fs86', 251)" onmouseover="showTip(event, 'fs86', 251)" class="i">mbsize</span>
    <span class="k">let</span> <span class="k">mutable</span> <span onmouseout="hideTip(event, 'fs91', 252)" onmouseover="showTip(event, 'fs91', 252)" class="v">j</span> <span class="o">=</span> <span class="n">0</span>
    <span class="k">while</span> <span onmouseout="hideTip(event, 'fs91', 253)" onmouseover="showTip(event, 'fs91', 253)" class="v">j</span> <span class="o">&lt;</span> <span onmouseout="hideTip(event, 'fs36', 254)" onmouseover="showTip(event, 'fs36', 254)" class="i">epochs</span> <span class="k">do</span>
        <span onmouseout="hideTip(event, 'fs89', 255)" onmouseover="showTip(event, 'fs89', 255)" class="v">b</span> <span class="o">&lt;-</span> <span class="n">0</span>
        <span class="k">while</span> <span onmouseout="hideTip(event, 'fs89', 256)" onmouseover="showTip(event, 'fs89', 256)" class="v">b</span> <span class="o">&lt;</span> <span onmouseout="hideTip(event, 'fs90', 257)" onmouseover="showTip(event, 'fs90', 257)" class="i">batches</span> <span class="k">do</span>
            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs92', 258)" onmouseover="showTip(event, 'fs92', 258)" class="i">mbX</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs79', 259)" onmouseover="showTip(event, 'fs79', 259)" class="i">x</span><span class="o">.</span>[<span class="o">*</span>, (<span onmouseout="hideTip(event, 'fs89', 260)" onmouseover="showTip(event, 'fs89', 260)" class="v">b</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs86', 261)" onmouseover="showTip(event, 'fs86', 261)" class="i">mbsize</span>)<span class="o">..</span>((<span onmouseout="hideTip(event, 'fs89', 262)" onmouseover="showTip(event, 'fs89', 262)" class="v">b</span> <span class="o">+</span> <span class="n">1</span>) <span class="o">*</span> <span onmouseout="hideTip(event, 'fs86', 263)" onmouseover="showTip(event, 'fs86', 263)" class="i">mbsize</span> <span class="o">-</span> <span class="n">1</span>)]
            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs93', 264)" onmouseover="showTip(event, 'fs93', 264)" class="i">mbY</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs88', 265)" onmouseover="showTip(event, 'fs88', 265)" class="i">y</span><span class="o">.</span>[<span class="o">*</span>, (<span onmouseout="hideTip(event, 'fs89', 266)" onmouseover="showTip(event, 'fs89', 266)" class="v">b</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs86', 267)" onmouseover="showTip(event, 'fs86', 267)" class="i">mbsize</span>)<span class="o">..</span>((<span onmouseout="hideTip(event, 'fs89', 268)" onmouseover="showTip(event, 'fs89', 268)" class="v">b</span> <span class="o">+</span> <span class="n">1</span>) <span class="o">*</span> <span onmouseout="hideTip(event, 'fs86', 269)" onmouseover="showTip(event, 'fs86', 269)" class="i">mbsize</span> <span class="o">-</span> <span class="n">1</span>)]

            <span class="k">for</span> <span onmouseout="hideTip(event, 'fs80', 270)" onmouseover="showTip(event, 'fs80', 270)" class="i">l</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs84', 271)" onmouseover="showTip(event, 'fs84', 271)" class="i">n</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs77', 272)" onmouseover="showTip(event, 'fs77', 272)" class="i">layers</span> <span class="k">do</span>
                <span onmouseout="hideTip(event, 'fs80', 273)" onmouseover="showTip(event, 'fs80', 273)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs73', 274)" onmouseover="showTip(event, 'fs73', 274)" class="v">W</span> <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs80', 275)" onmouseover="showTip(event, 'fs80', 275)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs73', 276)" onmouseover="showTip(event, 'fs73', 276)" class="v">W</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs44', 277)" onmouseover="showTip(event, 'fs44', 277)" class="f">makeReverse</span> <span onmouseout="hideTip(event, 'fs39', 278)" onmouseover="showTip(event, 'fs39', 278)" class="i">i</span>
                <span onmouseout="hideTip(event, 'fs80', 279)" onmouseover="showTip(event, 'fs80', 279)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs74', 280)" onmouseover="showTip(event, 'fs74', 280)" class="v">b</span> <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs80', 281)" onmouseover="showTip(event, 'fs80', 281)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs74', 282)" onmouseover="showTip(event, 'fs74', 282)" class="v">b</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs44', 283)" onmouseover="showTip(event, 'fs44', 283)" class="f">makeReverse</span> <span onmouseout="hideTip(event, 'fs39', 284)" onmouseover="showTip(event, 'fs39', 284)" class="i">i</span>

            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs45', 285)" onmouseover="showTip(event, 'fs45', 285)" class="i">L</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs94', 286)" onmouseover="showTip(event, 'fs94', 286)" class="t">D</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs87', 287)" onmouseover="showTip(event, 'fs87', 287)" class="f">loss</span> (<span onmouseout="hideTip(event, 'fs83', 288)" onmouseover="showTip(event, 'fs83', 288)" class="f">runNetwork&#39;</span> <span onmouseout="hideTip(event, 'fs92', 289)" onmouseover="showTip(event, 'fs92', 289)" class="i">mbX</span> <span onmouseout="hideTip(event, 'fs84', 290)" onmouseover="showTip(event, 'fs84', 290)" class="i">n</span>) <span onmouseout="hideTip(event, 'fs93', 291)" onmouseover="showTip(event, 'fs93', 291)" class="i">mbY</span>
            <span onmouseout="hideTip(event, 'fs45', 292)" onmouseover="showTip(event, 'fs45', 292)" class="i">L</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs50', 293)" onmouseover="showTip(event, 'fs50', 293)" class="f">reverseProp</span> (<span onmouseout="hideTip(event, 'fs51', 294)" onmouseover="showTip(event, 'fs51', 294)" class="p">D</span> <span class="n">1.</span>)

            <span class="k">for</span> <span onmouseout="hideTip(event, 'fs80', 295)" onmouseover="showTip(event, 'fs80', 295)" class="i">l</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs84', 296)" onmouseover="showTip(event, 'fs84', 296)" class="i">n</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs77', 297)" onmouseover="showTip(event, 'fs77', 297)" class="i">layers</span> <span class="k">do</span>
                <span onmouseout="hideTip(event, 'fs80', 298)" onmouseover="showTip(event, 'fs80', 298)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs73', 299)" onmouseover="showTip(event, 'fs73', 299)" class="v">W</span> <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs52', 300)" onmouseover="showTip(event, 'fs52', 300)" class="f">primal</span> (<span onmouseout="hideTip(event, 'fs80', 301)" onmouseover="showTip(event, 'fs80', 301)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs73', 302)" onmouseover="showTip(event, 'fs73', 302)" class="v">W</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs53', 303)" onmouseover="showTip(event, 'fs53', 303)" class="i">P</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs35', 304)" onmouseover="showTip(event, 'fs35', 304)" class="i">eta</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs80', 305)" onmouseover="showTip(event, 'fs80', 305)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs73', 306)" onmouseover="showTip(event, 'fs73', 306)" class="v">W</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs54', 307)" onmouseover="showTip(event, 'fs54', 307)" class="i">A</span>)
                <span onmouseout="hideTip(event, 'fs80', 308)" onmouseover="showTip(event, 'fs80', 308)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs74', 309)" onmouseover="showTip(event, 'fs74', 309)" class="v">b</span> <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs52', 310)" onmouseover="showTip(event, 'fs52', 310)" class="f">primal</span> (<span onmouseout="hideTip(event, 'fs80', 311)" onmouseover="showTip(event, 'fs80', 311)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs74', 312)" onmouseover="showTip(event, 'fs74', 312)" class="v">b</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs55', 313)" onmouseover="showTip(event, 'fs55', 313)" class="i">P</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs35', 314)" onmouseover="showTip(event, 'fs35', 314)" class="i">eta</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs80', 315)" onmouseover="showTip(event, 'fs80', 315)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs74', 316)" onmouseover="showTip(event, 'fs74', 316)" class="v">b</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs56', 317)" onmouseover="showTip(event, 'fs56', 317)" class="i">A</span>)

            <span onmouseout="hideTip(event, 'fs57', 318)" onmouseover="showTip(event, 'fs57', 318)" class="f">printfn</span> <span class="s">&quot;Epoch </span><span class="pf">%i</span><span class="s">, minibatch </span><span class="pf">%i</span><span class="s">, loss </span><span class="pf">%f</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs91', 319)" onmouseover="showTip(event, 'fs91', 319)" class="v">j</span> <span onmouseout="hideTip(event, 'fs89', 320)" onmouseover="showTip(event, 'fs89', 320)" class="v">b</span> (<span onmouseout="hideTip(event, 'fs58', 321)" onmouseover="showTip(event, 'fs58', 321)" class="f">float</span> <span onmouseout="hideTip(event, 'fs45', 322)" onmouseover="showTip(event, 'fs45', 322)" class="i">L</span>)
            <span onmouseout="hideTip(event, 'fs89', 323)" onmouseover="showTip(event, 'fs89', 323)" class="v">b</span> <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs89', 324)" onmouseover="showTip(event, 'fs89', 324)" class="v">b</span> <span class="o">+</span> <span class="n">1</span>
        <span onmouseout="hideTip(event, 'fs91', 325)" onmouseover="showTip(event, 'fs91', 325)" class="v">j</span> <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs91', 326)" onmouseover="showTip(event, 'fs91', 326)" class="v">j</span> <span class="o">+</span> <span class="n">1</span>
</code></pre></td>
</tr>
</table>

<h2>The Obligatory MNIST Example</h2>

<p>The MNIST database of handwritten digits is commonly used for demonstrating neural network training. The database contains 60,000 training images and 10,000 testing images. More information on the database and downloadable files can be found <a href="https://yann.lecun.com/exdb/mnist/">here</a>.</p>

<p>The following code reads the standard MNIST files into matrices.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs21', 327)" onmouseover="showTip(event, 'fs21', 327)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs95', 328)" onmouseover="showTip(event, 'fs95', 328)" class="i">IO</span>

<span class="k">type</span> <span onmouseout="hideTip(event, 'fs96', 329)" onmouseover="showTip(event, 'fs96', 329)" class="t">MNIST</span> <span class="o">=</span>
    <span class="k">static</span> <span class="k">member</span> <span onmouseout="hideTip(event, 'fs97', 330)" onmouseover="showTip(event, 'fs97', 330)" class="f">Load</span>(<span onmouseout="hideTip(event, 'fs98', 331)" onmouseover="showTip(event, 'fs98', 331)" class="i">filename</span>, <span onmouseout="hideTip(event, 'fs99', 332)" onmouseover="showTip(event, 'fs99', 332)" class="i">items</span>) <span class="o">=</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs100', 333)" onmouseover="showTip(event, 'fs100', 333)" class="i">d</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs101', 334)" onmouseover="showTip(event, 'fs101', 334)" class="t">BinaryReader</span>(<span onmouseout="hideTip(event, 'fs102', 335)" onmouseover="showTip(event, 'fs102', 335)" class="t">File</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs103', 336)" onmouseover="showTip(event, 'fs103', 336)" class="f">Open</span>(<span onmouseout="hideTip(event, 'fs98', 337)" onmouseover="showTip(event, 'fs98', 337)" class="i">filename</span>, <span onmouseout="hideTip(event, 'fs104', 338)" onmouseover="showTip(event, 'fs104', 338)" class="t">FileMode</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs105', 339)" onmouseover="showTip(event, 'fs105', 339)" class="i">Open</span>, <span onmouseout="hideTip(event, 'fs106', 340)" onmouseover="showTip(event, 'fs106', 340)" class="t">FileAccess</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs107', 341)" onmouseover="showTip(event, 'fs107', 341)" class="i">Read</span>, <span onmouseout="hideTip(event, 'fs108', 342)" onmouseover="showTip(event, 'fs108', 342)" class="t">FileShare</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs109', 343)" onmouseover="showTip(event, 'fs109', 343)" class="i">Read</span>))
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs110', 344)" onmouseover="showTip(event, 'fs110', 344)" class="i">magicnumber</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs100', 345)" onmouseover="showTip(event, 'fs100', 345)" class="i">d</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs111', 346)" onmouseover="showTip(event, 'fs111', 346)" class="f">ReadInt32</span>() <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs21', 347)" onmouseover="showTip(event, 'fs21', 347)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs112', 348)" onmouseover="showTip(event, 'fs112', 348)" class="i">Net</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs113', 349)" onmouseover="showTip(event, 'fs113', 349)" class="t">IPAddress</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs114', 350)" onmouseover="showTip(event, 'fs114', 350)" class="f">NetworkToHostOrder</span>
        <span class="k">match</span> <span onmouseout="hideTip(event, 'fs110', 351)" onmouseover="showTip(event, 'fs110', 351)" class="i">magicnumber</span> <span class="k">with</span>
        | <span class="n">2049</span> <span class="k">-&gt;</span> <span class="c">// Labels</span>
            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs115', 352)" onmouseover="showTip(event, 'fs115', 352)" class="i">maxitems</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs100', 353)" onmouseover="showTip(event, 'fs100', 353)" class="i">d</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs111', 354)" onmouseover="showTip(event, 'fs111', 354)" class="f">ReadInt32</span>() <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs21', 355)" onmouseover="showTip(event, 'fs21', 355)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs112', 356)" onmouseover="showTip(event, 'fs112', 356)" class="i">Net</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs113', 357)" onmouseover="showTip(event, 'fs113', 357)" class="t">IPAddress</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs114', 358)" onmouseover="showTip(event, 'fs114', 358)" class="f">NetworkToHostOrder</span>
            <span onmouseout="hideTip(event, 'fs100', 359)" onmouseover="showTip(event, 'fs100', 359)" class="i">d</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs116', 360)" onmouseover="showTip(event, 'fs116', 360)" class="f">ReadBytes</span>(<span onmouseout="hideTip(event, 'fs117', 361)" onmouseover="showTip(event, 'fs117', 361)" class="f">min</span> <span onmouseout="hideTip(event, 'fs99', 362)" onmouseover="showTip(event, 'fs99', 362)" class="i">items</span> <span onmouseout="hideTip(event, 'fs115', 363)" onmouseover="showTip(event, 'fs115', 363)" class="i">maxitems</span>)
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs18', 364)" onmouseover="showTip(event, 'fs18', 364)" class="t">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs118', 365)" onmouseover="showTip(event, 'fs118', 365)" class="f">map</span> <span onmouseout="hideTip(event, 'fs58', 366)" onmouseover="showTip(event, 'fs58', 366)" class="f">float</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 367)" onmouseover="showTip(event, 'fs9', 367)" class="p">DV</span>
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs7', 368)" onmouseover="showTip(event, 'fs7', 368)" class="t">DM</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs119', 369)" onmouseover="showTip(event, 'fs119', 369)" class="f">ofDV</span> <span class="n">1</span>
        | <span class="n">2051</span> <span class="k">-&gt;</span> <span class="c">// Images</span>
            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs115', 370)" onmouseover="showTip(event, 'fs115', 370)" class="i">maxitems</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs100', 371)" onmouseover="showTip(event, 'fs100', 371)" class="i">d</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs111', 372)" onmouseover="showTip(event, 'fs111', 372)" class="f">ReadInt32</span>() <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs21', 373)" onmouseover="showTip(event, 'fs21', 373)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs112', 374)" onmouseover="showTip(event, 'fs112', 374)" class="i">Net</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs113', 375)" onmouseover="showTip(event, 'fs113', 375)" class="t">IPAddress</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs114', 376)" onmouseover="showTip(event, 'fs114', 376)" class="f">NetworkToHostOrder</span>
            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs120', 377)" onmouseover="showTip(event, 'fs120', 377)" class="i">rows</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs100', 378)" onmouseover="showTip(event, 'fs100', 378)" class="i">d</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs111', 379)" onmouseover="showTip(event, 'fs111', 379)" class="f">ReadInt32</span>() <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs21', 380)" onmouseover="showTip(event, 'fs21', 380)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs112', 381)" onmouseover="showTip(event, 'fs112', 381)" class="i">Net</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs113', 382)" onmouseover="showTip(event, 'fs113', 382)" class="t">IPAddress</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs114', 383)" onmouseover="showTip(event, 'fs114', 383)" class="f">NetworkToHostOrder</span>
            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs121', 384)" onmouseover="showTip(event, 'fs121', 384)" class="i">cols</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs100', 385)" onmouseover="showTip(event, 'fs100', 385)" class="i">d</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs111', 386)" onmouseover="showTip(event, 'fs111', 386)" class="f">ReadInt32</span>() <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs21', 387)" onmouseover="showTip(event, 'fs21', 387)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs112', 388)" onmouseover="showTip(event, 'fs112', 388)" class="i">Net</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs113', 389)" onmouseover="showTip(event, 'fs113', 389)" class="t">IPAddress</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs114', 390)" onmouseover="showTip(event, 'fs114', 390)" class="f">NetworkToHostOrder</span>
            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs122', 391)" onmouseover="showTip(event, 'fs122', 391)" class="i">n</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs117', 392)" onmouseover="showTip(event, 'fs117', 392)" class="f">min</span> <span onmouseout="hideTip(event, 'fs99', 393)" onmouseover="showTip(event, 'fs99', 393)" class="i">items</span> <span onmouseout="hideTip(event, 'fs115', 394)" onmouseover="showTip(event, 'fs115', 394)" class="i">maxitems</span>
            <span onmouseout="hideTip(event, 'fs100', 395)" onmouseover="showTip(event, 'fs100', 395)" class="i">d</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs116', 396)" onmouseover="showTip(event, 'fs116', 396)" class="f">ReadBytes</span>(<span onmouseout="hideTip(event, 'fs122', 397)" onmouseover="showTip(event, 'fs122', 397)" class="i">n</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs120', 398)" onmouseover="showTip(event, 'fs120', 398)" class="i">rows</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs121', 399)" onmouseover="showTip(event, 'fs121', 399)" class="i">cols</span>)
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs18', 400)" onmouseover="showTip(event, 'fs18', 400)" class="t">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs118', 401)" onmouseover="showTip(event, 'fs118', 401)" class="f">map</span> <span onmouseout="hideTip(event, 'fs58', 402)" onmouseover="showTip(event, 'fs58', 402)" class="f">float</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 403)" onmouseover="showTip(event, 'fs9', 403)" class="p">DV</span>
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs7', 404)" onmouseover="showTip(event, 'fs7', 404)" class="t">DM</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs119', 405)" onmouseover="showTip(event, 'fs119', 405)" class="f">ofDV</span> <span onmouseout="hideTip(event, 'fs122', 406)" onmouseover="showTip(event, 'fs122', 406)" class="i">n</span>
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs7', 407)" onmouseover="showTip(event, 'fs7', 407)" class="t">DM</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs123', 408)" onmouseover="showTip(event, 'fs123', 408)" class="f">transpose</span>
        | _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs124', 409)" onmouseover="showTip(event, 'fs124', 409)" class="f">failwith</span> <span class="s">&quot;Given file is not in the MNIST format.&quot;</span>
    <span class="k">static</span> <span class="k">member</span> <span onmouseout="hideTip(event, 'fs125', 410)" onmouseover="showTip(event, 'fs125', 410)" class="f">Load</span>(<span onmouseout="hideTip(event, 'fs98', 411)" onmouseover="showTip(event, 'fs98', 411)" class="i">filename</span>) <span class="o">=</span> <span onmouseout="hideTip(event, 'fs96', 412)" onmouseover="showTip(event, 'fs96', 412)" class="t">MNIST</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs126', 413)" onmouseover="showTip(event, 'fs126', 413)" class="f">Load</span>(<span onmouseout="hideTip(event, 'fs98', 414)" onmouseover="showTip(event, 'fs98', 414)" class="i">filename</span>, <span onmouseout="hideTip(event, 'fs21', 415)" onmouseover="showTip(event, 'fs21', 415)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs127', 416)" onmouseover="showTip(event, 'fs127', 416)" class="t">Int32</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs128', 417)" onmouseover="showTip(event, 'fs128', 417)" class="i">MaxValue</span>)
</code></pre></td>
</tr>
</table>

<p>For a quick demonstration, let's start by loading 10,000 training images and their class labels.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs129', 418)" onmouseover="showTip(event, 'fs129', 418)" class="i">mnistTrainX</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs96', 419)" onmouseover="showTip(event, 'fs96', 419)" class="t">MNIST</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs126', 420)" onmouseover="showTip(event, 'fs126', 420)" class="f">Load</span>(<span class="s">&quot;C:/datasets/MNIST/train-images.idx3-ubyte&quot;</span>, <span class="n">10000</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs130', 421)" onmouseover="showTip(event, 'fs130', 421)" class="i">mnistTrainY</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs96', 422)" onmouseover="showTip(event, 'fs96', 422)" class="t">MNIST</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs126', 423)" onmouseover="showTip(event, 'fs126', 423)" class="f">Load</span>(<span class="s">&quot;C:/datasets/MNIST/train-labels.idx1-ubyte&quot;</span>, <span class="n">10000</span>)
</code></pre></td>
</tr>
</table>

<p>The first matrix, 784x10,000, contains one raster image of 784 pixels (28x28) in each column and the second matrix, 1x10,000, contains the class labels (0, 1, 2, 3, 4, 5, 6, 7, 8, 9) of each of these images.</p>

<p>For this classification task, we will have a neural network with 784 input nodes, one for each pixel in the input image; a hidden layer of 300 nodes; and an output layer of 10 nodes, representing the scores for each possible class. When an input image is propagated through the network, the output node with the highest score will be the class predicted for that image.</p>

<p>There are several ways of training such a network. Here we use <span class="math">\(\tanh\)</span> activations in the hidden layer and <a href="https://en.wikipedia.org/wiki/Softmax_function"><span class="math">\(\textrm{softmax}\)</span></a> activations in the output layer. The softmax function</p>

<p><span class="math">\[  \sigma(\mathbf{z})_{j} = \frac{e^{z_j}}{\sum_{k=1}^{K} e^{z_k}} \; ,\]</span></p>

<p>for a vector <span class="math">\(\mathbf{z}\)</span> of length <span class="math">\(K\)</span>, transforms real-valued scores <span class="math">\(z_k\)</span> into a vector <span class="math">\(\mathbf{\sigma}\)</span> of components <span class="math">\(\sigma_j\)</span> between zero and one, where <span class="math">\(\textrm{sum}(\mathbf{\sigma}) = 1\)</span>. Thus, the resulting vector <span class="math">\(\sigma\)</span> is interpretable as normalized class probabilities.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
<span class="l">9: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs131', 424)" onmouseover="showTip(event, 'fs131', 424)" class="i">l0</span> <span class="o">=</span> {<span onmouseout="hideTip(event, 'fs73', 425)" onmouseover="showTip(event, 'fs73', 425)" class="v">W</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs7', 426)" onmouseover="showTip(event, 'fs7', 426)" class="t">DM</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs29', 427)" onmouseover="showTip(event, 'fs29', 427)" class="f">init</span> <span class="n">300</span> <span class="n">784</span> (<span class="k">fun</span> _ _ <span class="k">-&gt;</span> <span class="o">-</span><span class="n">0.075</span> <span class="o">+</span> <span class="n">0.15</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs20', 428)" onmouseover="showTip(event, 'fs20', 428)" class="i">rnd</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs30', 429)" onmouseover="showTip(event, 'fs30', 429)" class="f">NextDouble</span>())
          <span onmouseout="hideTip(event, 'fs74', 430)" onmouseover="showTip(event, 'fs74', 430)" class="v">b</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs9', 431)" onmouseover="showTip(event, 'fs9', 431)" class="t">DV</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs132', 432)" onmouseover="showTip(event, 'fs132', 432)" class="f">zeroCreate</span> <span class="n">300</span>
          <span onmouseout="hideTip(event, 'fs75', 433)" onmouseover="showTip(event, 'fs75', 433)" class="i">a</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs133', 434)" onmouseover="showTip(event, 'fs133', 434)" class="f">tanh</span>}

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs134', 435)" onmouseover="showTip(event, 'fs134', 435)" class="i">l1</span> <span class="o">=</span> {<span onmouseout="hideTip(event, 'fs73', 436)" onmouseover="showTip(event, 'fs73', 436)" class="v">W</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs7', 437)" onmouseover="showTip(event, 'fs7', 437)" class="t">DM</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs29', 438)" onmouseover="showTip(event, 'fs29', 438)" class="f">init</span> <span class="n">10</span> <span class="n">300</span> (<span class="k">fun</span> _ _ <span class="k">-&gt;</span> <span class="o">-</span><span class="n">0.075</span> <span class="o">+</span> <span class="n">0.15</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs20', 439)" onmouseover="showTip(event, 'fs20', 439)" class="i">rnd</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs30', 440)" onmouseover="showTip(event, 'fs30', 440)" class="f">NextDouble</span>())
          <span onmouseout="hideTip(event, 'fs74', 441)" onmouseover="showTip(event, 'fs74', 441)" class="v">b</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs9', 442)" onmouseover="showTip(event, 'fs9', 442)" class="t">DV</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs132', 443)" onmouseover="showTip(event, 'fs132', 443)" class="f">zeroCreate</span> <span class="n">10</span>
          <span onmouseout="hideTip(event, 'fs75', 444)" onmouseover="showTip(event, 'fs75', 444)" class="i">a</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs7', 445)" onmouseover="showTip(event, 'fs7', 445)" class="t">DM</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs135', 446)" onmouseover="showTip(event, 'fs135', 446)" class="f">mapCols</span> <span onmouseout="hideTip(event, 'fs136', 447)" onmouseover="showTip(event, 'fs136', 447)" class="f">softmax</span>}

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs137', 448)" onmouseover="showTip(event, 'fs137', 448)" class="i">nn</span> <span class="o">=</span> {<span class="i">layers</span> <span class="o">=</span> [|<span onmouseout="hideTip(event, 'fs131', 449)" onmouseover="showTip(event, 'fs131', 449)" class="i">l0</span>; <span onmouseout="hideTip(event, 'fs134', 450)" onmouseover="showTip(event, 'fs134', 450)" class="i">l1</span>|]}
</code></pre></td>
</tr>
</table>

<p>We train this <em>softmax classifier</em> with a <a href="https://en.wikipedia.org/wiki/Cross_entropy">cross-entropy loss</a> of the form</p>

<p><span class="math">\[  Q(\mathbf{p}, \mathbf{q}) = -\sum_i \mathbf{p}(\mathbf{x}_i) \log \mathbf{q}(\mathbf{x}_i) \; ,\]</span></p>

<p>where <span class="math">\(\mathbf{q}\)</span> is the vector of predicted class probabilities (the output of the network) and <span class="math">\(\mathbf{p}\)</span> is the "true" distribution (e.g., <span class="math">\(\mathbf{p} = (0,0,1,0,0,0,0,0,0,0)\)</span> for <span class="math">\(\mathbf{y}_i = 2\)</span>).</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs138', 451)" onmouseover="showTip(event, 'fs138', 451)" class="f">crossEntropy</span> (<span onmouseout="hideTip(event, 'fs79', 452)" onmouseover="showTip(event, 'fs79', 452)" class="i">x</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs7', 453)" onmouseover="showTip(event, 'fs7', 453)" class="t">DM</span>) (<span onmouseout="hideTip(event, 'fs88', 454)" onmouseover="showTip(event, 'fs88', 454)" class="i">y</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs7', 455)" onmouseover="showTip(event, 'fs7', 455)" class="t">DM</span>) <span class="o">=</span>
    <span class="o">-</span>(<span onmouseout="hideTip(event, 'fs79', 456)" onmouseover="showTip(event, 'fs79', 456)" class="i">x</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs7', 457)" onmouseover="showTip(event, 'fs7', 457)" class="t">DM</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs139', 458)" onmouseover="showTip(event, 'fs139', 458)" class="f">toCols</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs140', 459)" onmouseover="showTip(event, 'fs140', 459)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs141', 460)" onmouseover="showTip(event, 'fs141', 460)" class="f">mapi</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs28', 461)" onmouseover="showTip(event, 'fs28', 461)" class="i">i</span> <span onmouseout="hideTip(event, 'fs142', 462)" onmouseover="showTip(event, 'fs142', 462)" class="i">v</span> <span class="k">-&gt;</span>
        (<span onmouseout="hideTip(event, 'fs9', 463)" onmouseover="showTip(event, 'fs9', 463)" class="t">DV</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs143', 464)" onmouseover="showTip(event, 'fs143', 464)" class="f">standardBasis</span> <span onmouseout="hideTip(event, 'fs142', 465)" onmouseover="showTip(event, 'fs142', 465)" class="i">v</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs144', 466)" onmouseover="showTip(event, 'fs144', 466)" class="i">Length</span> (<span onmouseout="hideTip(event, 'fs25', 467)" onmouseover="showTip(event, 'fs25', 467)" class="f">int</span> (<span onmouseout="hideTip(event, 'fs58', 468)" onmouseover="showTip(event, 'fs58', 468)" class="f">float</span> <span onmouseout="hideTip(event, 'fs88', 469)" onmouseover="showTip(event, 'fs88', 469)" class="i">y</span><span class="o">.</span>[<span class="n">0</span>, <span onmouseout="hideTip(event, 'fs28', 470)" onmouseover="showTip(event, 'fs28', 470)" class="i">i</span>]))) <span class="o">*</span> <span onmouseout="hideTip(event, 'fs145', 471)" onmouseover="showTip(event, 'fs145', 471)" class="f">log</span> <span onmouseout="hideTip(event, 'fs142', 472)" onmouseover="showTip(event, 'fs142', 472)" class="i">v</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs140', 473)" onmouseover="showTip(event, 'fs140', 473)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs146', 474)" onmouseover="showTip(event, 'fs146', 474)" class="f">sum</span>) <span class="o">/</span> <span onmouseout="hideTip(event, 'fs79', 475)" onmouseover="showTip(event, 'fs79', 475)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs82', 476)" onmouseover="showTip(event, 'fs82', 476)" class="i">Cols</span>

<span onmouseout="hideTip(event, 'fs85', 477)" onmouseover="showTip(event, 'fs85', 477)" class="f">backprop&#39;</span> <span onmouseout="hideTip(event, 'fs137', 478)" onmouseover="showTip(event, 'fs137', 478)" class="i">nn</span> <span class="n">0.01</span> <span class="n">10</span> <span class="n">500</span> <span onmouseout="hideTip(event, 'fs138', 479)" onmouseover="showTip(event, 'fs138', 479)" class="f">crossEntropy</span> <span onmouseout="hideTip(event, 'fs129', 480)" onmouseover="showTip(event, 'fs129', 480)" class="i">mnistTrainX</span> <span onmouseout="hideTip(event, 'fs130', 481)" onmouseover="showTip(event, 'fs130', 481)" class="i">mnistTrainY</span>
</code></pre></td>
</tr>
</table>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="cs"><span class="o">.</span><span class="o">.</span><span class="o">.</span>
Epoch 7, minibatch 17, loss 0.612930
Epoch 7, minibatch 18, loss 0.523338
Epoch 7, minibatch 19, loss 0.487236
<span class="o">.</span><span class="o">.</span><span class="o">.</span>
</code></pre></td></tr></table>

<p>Let's test the trained network on a few digits from the test set.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs147', 482)" onmouseover="showTip(event, 'fs147', 482)" class="i">mnistTestX</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs96', 483)" onmouseover="showTip(event, 'fs96', 483)" class="t">MNIST</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs126', 484)" onmouseover="showTip(event, 'fs126', 484)" class="f">Load</span>(<span class="s">&quot;C:/datasets/MNIST/t10k-images.idx3-ubyte&quot;</span>, <span class="n">5</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs148', 485)" onmouseover="showTip(event, 'fs148', 485)" class="i">mnistTestY</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs96', 486)" onmouseover="showTip(event, 'fs96', 486)" class="t">MNIST</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs126', 487)" onmouseover="showTip(event, 'fs126', 487)" class="f">Load</span>(<span class="s">&quot;C:/datasets/MNIST/t10k-labels.idx1-ubyte&quot;</span>, <span class="n">5</span>)

<span class="c">// Run the test set through the network</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs149', 488)" onmouseover="showTip(event, 'fs149', 488)" class="i">testY</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs83', 489)" onmouseover="showTip(event, 'fs83', 489)" class="f">runNetwork&#39;</span> <span onmouseout="hideTip(event, 'fs147', 490)" onmouseover="showTip(event, 'fs147', 490)" class="i">mnistTestX</span> <span onmouseout="hideTip(event, 'fs137', 491)" onmouseover="showTip(event, 'fs137', 491)" class="i">nn</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs52', 492)" onmouseover="showTip(event, 'fs52', 492)" class="f">primal</span>

<span class="c">// Compute the cross-entropy loss for the test set</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs150', 493)" onmouseover="showTip(event, 'fs150', 493)" class="i">testLoss</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs138', 494)" onmouseover="showTip(event, 'fs138', 494)" class="f">crossEntropy</span> <span onmouseout="hideTip(event, 'fs149', 495)" onmouseover="showTip(event, 'fs149', 495)" class="i">testY</span> <span onmouseout="hideTip(event, 'fs148', 496)" onmouseover="showTip(event, 'fs148', 496)" class="i">mnistTestY</span>

<span class="c">// Predicted classes</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs151', 497)" onmouseover="showTip(event, 'fs151', 497)" class="i">testPredict</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs149', 498)" onmouseover="showTip(event, 'fs149', 498)" class="i">testY</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs7', 499)" onmouseover="showTip(event, 'fs7', 499)" class="t">DM</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs139', 500)" onmouseover="showTip(event, 'fs139', 500)" class="f">toCols</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs140', 501)" onmouseover="showTip(event, 'fs140', 501)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs152', 502)" onmouseover="showTip(event, 'fs152', 502)" class="f">map</span> <span onmouseout="hideTip(event, 'fs9', 503)" onmouseover="showTip(event, 'fs9', 503)" class="t">DV</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs153', 504)" onmouseover="showTip(event, 'fs153', 504)" class="f">maxIndex</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs140', 505)" onmouseover="showTip(event, 'fs140', 505)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs154', 506)" onmouseover="showTip(event, 'fs154', 506)" class="f">toArray</span>

<span class="c">// Correct classes</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs155', 507)" onmouseover="showTip(event, 'fs155', 507)" class="i">testTrue</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs148', 508)" onmouseover="showTip(event, 'fs148', 508)" class="i">mnistTestY</span>
</code></pre></td>
</tr>
</table>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="cs">val testLoss <span class="o">:</span> D <span class="o">=</span> D 0.3540015679
val testPredict <span class="o">:</span> <span class="k">int</span> [] <span class="o">=</span> [|7; 2; 1; 0; 4|]
val testTrue <span class="o">:</span> DM <span class="o">=</span> DM [[7.0; 2.0; 1.0; 0.0; 4.0]]</code></pre></td></tr></table>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">for</span> <span onmouseout="hideTip(event, 'fs28', 509)" onmouseover="showTip(event, 'fs28', 509)" class="i">i</span> <span class="o">=</span> <span class="n">0</span> <span class="k">to</span> <span onmouseout="hideTip(event, 'fs149', 510)" onmouseover="showTip(event, 'fs149', 510)" class="i">testY</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs82', 511)" onmouseover="showTip(event, 'fs82', 511)" class="i">Cols</span> <span class="o">-</span> <span class="n">1</span> <span class="k">do</span>
    <span onmouseout="hideTip(event, 'fs57', 512)" onmouseover="showTip(event, 'fs57', 512)" class="f">printfn</span> <span class="s">&quot;Predicted label: </span><span class="pf">%i</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs151', 513)" onmouseover="showTip(event, 'fs151', 513)" class="i">testPredict</span><span class="o">.</span>[<span onmouseout="hideTip(event, 'fs28', 514)" onmouseover="showTip(event, 'fs28', 514)" class="i">i</span>]
    <span onmouseout="hideTip(event, 'fs57', 515)" onmouseover="showTip(event, 'fs57', 515)" class="f">printfn</span> <span class="s">&quot;Image:</span><span class="e">\n</span><span class="s"> </span><span class="pf">%s</span><span class="s">&quot;</span> ((<span onmouseout="hideTip(event, 'fs147', 516)" onmouseover="showTip(event, 'fs147', 516)" class="i">mnistTestX</span><span class="o">.</span>[<span class="o">*</span>,<span onmouseout="hideTip(event, 'fs28', 517)" onmouseover="showTip(event, 'fs28', 517)" class="i">i</span>] <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs7', 518)" onmouseover="showTip(event, 'fs7', 518)" class="t">DM</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs119', 519)" onmouseover="showTip(event, 'fs119', 519)" class="f">ofDV</span> <span class="n">28</span>)<span class="o">.</span><span class="f">Visualize</span>())
</code></pre></td>
</tr>
</table>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">  1: </span>
<span class="l">  2: </span>
<span class="l">  3: </span>
<span class="l">  4: </span>
<span class="l">  5: </span>
<span class="l">  6: </span>
<span class="l">  7: </span>
<span class="l">  8: </span>
<span class="l">  9: </span>
<span class="l"> 10: </span>
<span class="l"> 11: </span>
<span class="l"> 12: </span>
<span class="l"> 13: </span>
<span class="l"> 14: </span>
<span class="l"> 15: </span>
<span class="l"> 16: </span>
<span class="l"> 17: </span>
<span class="l"> 18: </span>
<span class="l"> 19: </span>
<span class="l"> 20: </span>
<span class="l"> 21: </span>
<span class="l"> 22: </span>
<span class="l"> 23: </span>
<span class="l"> 24: </span>
<span class="l"> 25: </span>
<span class="l"> 26: </span>
<span class="l"> 27: </span>
<span class="l"> 28: </span>
<span class="l"> 29: </span>
<span class="l"> 30: </span>
<span class="l"> 31: </span>
<span class="l"> 32: </span>
<span class="l"> 33: </span>
<span class="l"> 34: </span>
<span class="l"> 35: </span>
<span class="l"> 36: </span>
<span class="l"> 37: </span>
<span class="l"> 38: </span>
<span class="l"> 39: </span>
<span class="l"> 40: </span>
<span class="l"> 41: </span>
<span class="l"> 42: </span>
<span class="l"> 43: </span>
<span class="l"> 44: </span>
<span class="l"> 45: </span>
<span class="l"> 46: </span>
<span class="l"> 47: </span>
<span class="l"> 48: </span>
<span class="l"> 49: </span>
<span class="l"> 50: </span>
<span class="l"> 51: </span>
<span class="l"> 52: </span>
<span class="l"> 53: </span>
<span class="l"> 54: </span>
<span class="l"> 55: </span>
<span class="l"> 56: </span>
<span class="l"> 57: </span>
<span class="l"> 58: </span>
<span class="l"> 59: </span>
<span class="l"> 60: </span>
<span class="l"> 61: </span>
<span class="l"> 62: </span>
<span class="l"> 63: </span>
<span class="l"> 64: </span>
<span class="l"> 65: </span>
<span class="l"> 66: </span>
<span class="l"> 67: </span>
<span class="l"> 68: </span>
<span class="l"> 69: </span>
<span class="l"> 70: </span>
<span class="l"> 71: </span>
<span class="l"> 72: </span>
<span class="l"> 73: </span>
<span class="l"> 74: </span>
<span class="l"> 75: </span>
<span class="l"> 76: </span>
<span class="l"> 77: </span>
<span class="l"> 78: </span>
<span class="l"> 79: </span>
<span class="l"> 80: </span>
<span class="l"> 81: </span>
<span class="l"> 82: </span>
<span class="l"> 83: </span>
<span class="l"> 84: </span>
<span class="l"> 85: </span>
<span class="l"> 86: </span>
<span class="l"> 87: </span>
<span class="l"> 88: </span>
<span class="l"> 89: </span>
<span class="l"> 90: </span>
<span class="l"> 91: </span>
<span class="l"> 92: </span>
<span class="l"> 93: </span>
<span class="l"> 94: </span>
<span class="l"> 95: </span>
<span class="l"> 96: </span>
<span class="l"> 97: </span>
<span class="l"> 98: </span>
<span class="l"> 99: </span>
<span class="l">100: </span>
<span class="l">101: </span>
<span class="l">102: </span>
<span class="l">103: </span>
<span class="l">104: </span>
<span class="l">105: </span>
<span class="l">106: </span>
<span class="l">107: </span>
<span class="l">108: </span>
<span class="l">109: </span>
<span class="l">110: </span>
<span class="l">111: </span>
<span class="l">112: </span>
<span class="l">113: </span>
<span class="l">114: </span>
<span class="l">115: </span>
<span class="l">116: </span>
<span class="l">117: </span>
<span class="l">118: </span>
<span class="l">119: </span>
<span class="l">120: </span>
<span class="l">121: </span>
<span class="l">122: </span>
<span class="l">123: </span>
<span class="l">124: </span>
<span class="l">125: </span>
<span class="l">126: </span>
<span class="l">127: </span>
<span class="l">128: </span>
<span class="l">129: </span>
<span class="l">130: </span>
<span class="l">131: </span>
<span class="l">132: </span>
<span class="l">133: </span>
<span class="l">134: </span>
<span class="l">135: </span>
<span class="l">136: </span>
<span class="l">137: </span>
<span class="l">138: </span>
<span class="l">139: </span>
<span class="l">140: </span>
<span class="l">141: </span>
<span class="l">142: </span>
<span class="l">143: </span>
<span class="l">144: </span>
<span class="l">145: </span>
<span class="l">146: </span>
<span class="l">147: </span>
<span class="l">148: </span>
<span class="l">149: </span>
<span class="l">150: </span>
<span class="l">151: </span>
<span class="l">152: </span>
<span class="l">153: </span>
<span class="l">154: </span>
<span class="l">155: </span>
<span class="l">156: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="cs">Predicted label: 7
Image:
 DM <span class="o">:</span> 28 x 28







      ■■■■■■
      ■■■■■■■■■■■■■■■■
      ■■■■■■■■■■■■■■■■
            ■ ■■■■ ■■■
                  ■■■
                  ■■■
                 ■■■■
                ■■■■
                ■■■
                ■■■
               ■■■
              ■■■■
              ■■■
             ■■■■
            ■■■■
           ■■■■
           ■■■■
          ■■■■■
          ■■■■■
          ■■■


Predicted label: 2
Image:
 DM <span class="o">:</span> 28 x 28



          ■■■■■■■
         ■■■■■■■■
        ■■■■■■■■■■
       ■■■■    ■■■
       ■■■    ■■■■
              ■■■■
             ■■■■
            ■■■■■
            ■■■■
           ■■■■
           ■■■
          ■■■■
         ■■■■
         ■■■■
        ■■■■
        ■■■
        ■■■■         ■■■■■
        ■■■■■■■■■■■■■■■■■■■
        ■■■■■■■■■■■■■■■■■■■
         ■■■■■■■■■■■■






Predicted label: 1
Image:
 DM <span class="o">:</span> 28 x 28




                ■■■
                ■■■
                ■■
               ■■■
               ■■■
               ■■
              ■■■
              ■■■
              ■■■
             ■■■
             ■■■
             ■■■
            ■■■
            ■■■
            ■■■
            ■■■
           ■■■■
           ■■■
           ■■■
           ■■





Predicted label: 0
Image:
 DM <span class="o">:</span> 28 x 28




             ■■■
             ■■■■
            ■■■■■
          ■■■■■■■■■
          ■■■■■■■■■■
         ■■■■■■■■■■■
        ■■■■■■■■■■■■■
        ■■■■■■    ■■■■
        ■■■■      ■■■■
        ■■■        ■■■
        ■■         ■■■■
       ■■■        ■■■■
       ■■■       ■■■■■
       ■■■      ■■■■■■
       ■■■     ■■■■■■
       ■■■■■■■■■■■■■
       ■■■■■■■■■■■■■
        ■■■■■■■■■■
        ■■■■■■■■■
          ■■■■■■





Predicted label: 4
Image:
 DM <span class="o">:</span> 28 x 28





          ■■       ■■
          ■■       ■■
          ■■       ■■
         ■■■       ■■
        ■■■        ■■
        ■■■        ■■
       ■■■        ■■■
       ■■■       ■■■■
       ■■        ■■■
       ■■        ■■■
       ■■        ■■■
       ■■■■■■■■■■■■■
       ■■■■■■■■■■■■
         ■■■■■  ■■■
                ■■■■
                ■■■
                ■■■
                ■■■
                ■■■
                ■■          </code></pre></td></tr></table>

          <div class="tip" id="fs1">namespace DiffSharp</div>
<div class="tip" id="fs2">namespace DiffSharp.AD</div>
<div class="tip" id="fs3">module Float64<br /><br />from DiffSharp.AD</div>
<div class="tip" id="fs4">module Util<br /><br />from DiffSharp</div>
<div class="tip" id="fs5">type Layer =<br />&#160;&#160;{mutable W: DM;<br />&#160;&#160;&#160;mutable b: DV;<br />&#160;&#160;&#160;a: DV -&gt; DV;}<br /><br />Full name: Examples-neuralnetworks.Layer</div>
<div class="tip" id="fs6">Layer.W: DM</div>
<div class="tip" id="fs7">Multiple items<br />union case DM.DM: float [,] -&gt; DM<br /><br />--------------------<br />module DM<br /><br />from DiffSharp.AD.Float64<br /><br />--------------------<br />type DM =<br />&#160;&#160;| DM of float [,]<br />&#160;&#160;| DMF of DM * DM * uint32<br />&#160;&#160;| DMR of DM * DM ref * TraceOp * uint32 ref * uint32<br />&#160;&#160;member Copy : unit -&gt; DM<br />&#160;&#160;member GetCols : unit -&gt; seq&lt;DV&gt;<br />&#160;&#160;member GetForward : t:DM * i:uint32 -&gt; DM<br />&#160;&#160;member GetReverse : i:uint32 -&gt; DM<br />&#160;&#160;member GetRows : unit -&gt; seq&lt;DV&gt;<br />&#160;&#160;member GetSlice : rowStart:int option * rowFinish:int option * col:int -&gt; DV<br />&#160;&#160;member GetSlice : row:int * colStart:int option * colFinish:int option -&gt; DV<br />&#160;&#160;member GetSlice : rowStart:int option * rowFinish:int option * colStart:int option * colFinish:int option -&gt; DM<br />&#160;&#160;member ToMathematicaString : unit -&gt; string<br />&#160;&#160;member ToMatlabString : unit -&gt; string<br />&#160;&#160;override ToString : unit -&gt; string<br />&#160;&#160;member Visualize : unit -&gt; string<br />&#160;&#160;member A : DM<br />&#160;&#160;member Cols : int<br />&#160;&#160;member F : uint32<br />&#160;&#160;member Item : i:int * j:int -&gt; D with get<br />&#160;&#160;member Length : int<br />&#160;&#160;member P : DM<br />&#160;&#160;member PD : DM<br />&#160;&#160;member Rows : int<br />&#160;&#160;member T : DM<br />&#160;&#160;member A : DM with set<br />&#160;&#160;member F : uint32 with set<br />&#160;&#160;static member Abs : a:DM -&gt; DM<br />&#160;&#160;static member Acos : a:DM -&gt; DM<br />&#160;&#160;static member AddDiagonal : a:DM * b:DV -&gt; DM<br />&#160;&#160;static member AddItem : a:DM * i:int * j:int * b:D -&gt; DM<br />&#160;&#160;static member AddSubMatrix : a:DM * i:int * j:int * b:DM -&gt; DM<br />&#160;&#160;static member Asin : a:DM -&gt; DM<br />&#160;&#160;static member Atan : a:DM -&gt; DM<br />&#160;&#160;static member Atan2 : a:int * b:DM -&gt; DM<br />&#160;&#160;static member Atan2 : a:DM * b:int -&gt; DM<br />&#160;&#160;static member Atan2 : a:float * b:DM -&gt; DM<br />&#160;&#160;static member Atan2 : a:DM * b:float -&gt; DM<br />&#160;&#160;static member Atan2 : a:D * b:DM -&gt; DM<br />&#160;&#160;static member Atan2 : a:DM * b:D -&gt; DM<br />&#160;&#160;static member Atan2 : a:DM * b:DM -&gt; DM<br />&#160;&#160;static member Ceiling : a:DM -&gt; DM<br />&#160;&#160;static member Cos : a:DM -&gt; DM<br />&#160;&#160;static member Cosh : a:DM -&gt; DM<br />&#160;&#160;static member Det : a:DM -&gt; D<br />&#160;&#160;static member Diagonal : a:DM -&gt; DV<br />&#160;&#160;static member Exp : a:DM -&gt; DM<br />&#160;&#160;static member Floor : a:DM -&gt; DM<br />&#160;&#160;static member Inverse : a:DM -&gt; DM<br />&#160;&#160;static member Log : a:DM -&gt; DM<br />&#160;&#160;static member Log10 : a:DM -&gt; DM<br />&#160;&#160;static member Max : a:DM -&gt; D<br />&#160;&#160;static member Max : a:D * b:DM -&gt; DM<br />&#160;&#160;static member Max : a:DM * b:D -&gt; DM<br />&#160;&#160;static member Max : a:DM * b:DM -&gt; DM<br />&#160;&#160;static member MaxIndex : a:DM -&gt; int * int<br />&#160;&#160;static member Mean : a:DM -&gt; D<br />&#160;&#160;static member Min : a:DM -&gt; D<br />&#160;&#160;static member Min : a:D * b:DM -&gt; DM<br />&#160;&#160;static member Min : a:DM * b:D -&gt; DM<br />&#160;&#160;static member Min : a:DM * b:DM -&gt; DM<br />&#160;&#160;static member MinIndex : a:DM -&gt; int * int<br />&#160;&#160;static member Normalize : a:DM -&gt; DM<br />&#160;&#160;static member OfArray : m:int * a:D [] -&gt; DM<br />&#160;&#160;static member OfArray2D : a:D [,] -&gt; DM<br />&#160;&#160;static member OfCols : n:int * a:DV -&gt; DM<br />&#160;&#160;static member OfRows : s:seq&lt;DV&gt; -&gt; DM<br />&#160;&#160;static member OfRows : m:int * a:DV -&gt; DM<br />&#160;&#160;static member Op_DM_D : a:DM * ff:(float [,] -&gt; float) * fd:(DM -&gt; D) * df:(D * DM * DM -&gt; D) * r:(DM -&gt; TraceOp) -&gt; D<br />&#160;&#160;static member Op_DM_DM : a:DM * ff:(float [,] -&gt; float [,]) * fd:(DM -&gt; DM) * df:(DM * DM * DM -&gt; DM) * r:(DM -&gt; TraceOp) -&gt; DM<br />&#160;&#160;static member Op_DM_DM_DM : a:DM * b:DM * ff:(float [,] * float [,] -&gt; float [,]) * fd:(DM * DM -&gt; DM) * df_da:(DM * DM * DM -&gt; DM) * df_db:(DM * DM * DM -&gt; DM) * df_dab:(DM * DM * DM * DM * DM -&gt; DM) * r_d_d:(DM * DM -&gt; TraceOp) * r_d_c:(DM * DM -&gt; TraceOp) * r_c_d:(DM * DM -&gt; TraceOp) -&gt; DM<br />&#160;&#160;static member Op_DM_DV : a:DM * ff:(float [,] -&gt; float []) * fd:(DM -&gt; DV) * df:(DV * DM * DM -&gt; DV) * r:(DM -&gt; TraceOp) -&gt; DV<br />&#160;&#160;static member Op_DM_DV_DM : a:DM * b:DV * ff:(float [,] * float [] -&gt; float [,]) * fd:(DM * DV -&gt; DM) * df_da:(DM * DM * DM -&gt; DM) * df_db:(DM * DV * DV -&gt; DM) * df_dab:(DM * DM * DM * DV * DV -&gt; DM) * r_d_d:(DM * DV -&gt; TraceOp) * r_d_c:(DM * DV -&gt; TraceOp) * r_c_d:(DM * DV -&gt; TraceOp) -&gt; DM<br />&#160;&#160;static member Op_DM_DV_DV : a:DM * b:DV * ff:(float [,] * float [] -&gt; float []) * fd:(DM * DV -&gt; DV) * df_da:(DV * DM * DM -&gt; DV) * df_db:(DV * DV * DV -&gt; DV) * df_dab:(DV * DM * DM * DV * DV -&gt; DV) * r_d_d:(DM * DV -&gt; TraceOp) * r_d_c:(DM * DV -&gt; TraceOp) * r_c_d:(DM * DV -&gt; TraceOp) -&gt; DV<br />&#160;&#160;static member Op_DM_D_DM : a:DM * b:D * ff:(float [,] * float -&gt; float [,]) * fd:(DM * D -&gt; DM) * df_da:(DM * DM * DM -&gt; DM) * df_db:(DM * D * D -&gt; DM) * df_dab:(DM * DM * DM * D * D -&gt; DM) * r_d_d:(DM * D -&gt; TraceOp) * r_d_c:(DM * D -&gt; TraceOp) * r_c_d:(DM * D -&gt; TraceOp) -&gt; DM<br />&#160;&#160;static member Op_DV_DM_DM : a:DV * b:DM * ff:(float [] * float [,] -&gt; float [,]) * fd:(DV * DM -&gt; DM) * df_da:(DM * DV * DV -&gt; DM) * df_db:(DM * DM * DM -&gt; DM) * df_dab:(DM * DV * DV * DM * DM -&gt; DM) * r_d_d:(DV * DM -&gt; TraceOp) * r_d_c:(DV * DM -&gt; TraceOp) * r_c_d:(DV * DM -&gt; TraceOp) -&gt; DM<br />&#160;&#160;static member Op_DV_DM_DV : a:DV * b:DM * ff:(float [] * float [,] -&gt; float []) * fd:(DV * DM -&gt; DV) * df_da:(DV * DV * DV -&gt; DV) * df_db:(DV * DM * DM -&gt; DV) * df_dab:(DV * DV * DV * DM * DM -&gt; DV) * r_d_d:(DV * DM -&gt; TraceOp) * r_d_c:(DV * DM -&gt; TraceOp) * r_c_d:(DV * DM -&gt; TraceOp) -&gt; DV<br />&#160;&#160;static member Op_D_DM_DM : a:D * b:DM * ff:(float * float [,] -&gt; float [,]) * fd:(D * DM -&gt; DM) * df_da:(DM * D * D -&gt; DM) * df_db:(DM * DM * DM -&gt; DM) * df_dab:(DM * D * D * DM * DM -&gt; DM) * r_d_d:(D * DM -&gt; TraceOp) * r_d_c:(D * DM -&gt; TraceOp) * r_c_d:(D * DM -&gt; TraceOp) -&gt; DM<br />&#160;&#160;static member Pow : a:int * b:DM -&gt; DM<br />&#160;&#160;static member Pow : a:DM * b:int -&gt; DM<br />&#160;&#160;static member Pow : a:float * b:DM -&gt; DM<br />&#160;&#160;static member Pow : a:DM * b:float -&gt; DM<br />&#160;&#160;static member Pow : a:D * b:DM -&gt; DM<br />&#160;&#160;static member Pow : a:DM * b:D -&gt; DM<br />&#160;&#160;static member Pow : a:DM * b:DM -&gt; DM<br />&#160;&#160;static member ReLU : a:DM -&gt; DM<br />&#160;&#160;static member ReshapeToDV : a:DM -&gt; DV<br />&#160;&#160;static member Round : a:DM -&gt; DM<br />&#160;&#160;static member Sigmoid : a:DM -&gt; DM<br />&#160;&#160;static member Sign : a:DM -&gt; DM<br />&#160;&#160;static member Sin : a:DM -&gt; DM<br />&#160;&#160;static member Sinh : a:DM -&gt; DM<br />&#160;&#160;static member SoftPlus : a:DM -&gt; DM<br />&#160;&#160;static member SoftSign : a:DM -&gt; DM<br />&#160;&#160;static member Solve : a:DM * b:DV -&gt; DV<br />&#160;&#160;static member SolveSymmetric : a:DM * b:DV -&gt; DV<br />&#160;&#160;static member Sqrt : a:DM -&gt; DM<br />&#160;&#160;static member StandardDev : a:DM -&gt; D<br />&#160;&#160;static member Standardize : a:DM -&gt; DM<br />&#160;&#160;static member Sum : a:DM -&gt; D<br />&#160;&#160;static member Tan : a:DM -&gt; DM<br />&#160;&#160;static member Tanh : a:DM -&gt; DM<br />&#160;&#160;static member Trace : a:DM -&gt; D<br />&#160;&#160;static member Transpose : a:DM -&gt; DM<br />&#160;&#160;static member Variance : a:DM -&gt; D<br />&#160;&#160;static member ZeroMN : m:int -&gt; n:int -&gt; DM<br />&#160;&#160;static member Zero : DM<br />&#160;&#160;static member ( + ) : a:int * b:DM -&gt; DM<br />&#160;&#160;static member ( + ) : a:DM * b:int -&gt; DM<br />&#160;&#160;static member ( + ) : a:float * b:DM -&gt; DM<br />&#160;&#160;static member ( + ) : a:DM * b:float -&gt; DM<br />&#160;&#160;static member ( + ) : a:DM * b:DV -&gt; DM<br />&#160;&#160;static member ( + ) : a:DV * b:DM -&gt; DM<br />&#160;&#160;static member ( + ) : a:D * b:DM -&gt; DM<br />&#160;&#160;static member ( + ) : a:DM * b:D -&gt; DM<br />&#160;&#160;static member ( + ) : a:DM * b:DM -&gt; DM<br />&#160;&#160;static member ( / ) : a:int * b:DM -&gt; DM<br />&#160;&#160;static member ( / ) : a:DM * b:int -&gt; DM<br />&#160;&#160;static member ( / ) : a:float * b:DM -&gt; DM<br />&#160;&#160;static member ( / ) : a:DM * b:float -&gt; DM<br />&#160;&#160;static member ( / ) : a:D * b:DM -&gt; DM<br />&#160;&#160;static member ( / ) : a:DM * b:D -&gt; DM<br />&#160;&#160;static member ( ./ ) : a:DM * b:DM -&gt; DM<br />&#160;&#160;static member ( .* ) : a:DM * b:DM -&gt; DM<br />&#160;&#160;static member op_Explicit : d:float [,] -&gt; DM<br />&#160;&#160;static member op_Explicit : d:DM -&gt; float [,]<br />&#160;&#160;static member ( * ) : a:int * b:DM -&gt; DM<br />&#160;&#160;static member ( * ) : a:DM * b:int -&gt; DM<br />&#160;&#160;static member ( * ) : a:float * b:DM -&gt; DM<br />&#160;&#160;static member ( * ) : a:DM * b:float -&gt; DM<br />&#160;&#160;static member ( * ) : a:D * b:DM -&gt; DM<br />&#160;&#160;static member ( * ) : a:DM * b:D -&gt; DM<br />&#160;&#160;static member ( * ) : a:DV * b:DM -&gt; DV<br />&#160;&#160;static member ( * ) : a:DM * b:DV -&gt; DV<br />&#160;&#160;static member ( * ) : a:DM * b:DM -&gt; DM<br />&#160;&#160;static member ( - ) : a:int * b:DM -&gt; DM<br />&#160;&#160;static member ( - ) : a:DM * b:int -&gt; DM<br />&#160;&#160;static member ( - ) : a:float * b:DM -&gt; DM<br />&#160;&#160;static member ( - ) : a:DM * b:float -&gt; DM<br />&#160;&#160;static member ( - ) : a:D * b:DM -&gt; DM<br />&#160;&#160;static member ( - ) : a:DM * b:D -&gt; DM<br />&#160;&#160;static member ( - ) : a:DM * b:DM -&gt; DM<br />&#160;&#160;static member ( ~- ) : a:DM -&gt; DM<br /><br />Full name: DiffSharp.AD.Float64.DM</div>
<div class="tip" id="fs8">Layer.b: DV</div>
<div class="tip" id="fs9">Multiple items<br />union case DV.DV: float [] -&gt; DV<br /><br />--------------------<br />module DV<br /><br />from DiffSharp.AD.Float64<br /><br />--------------------<br />type DV =<br />&#160;&#160;| DV of float []<br />&#160;&#160;| DVF of DV * DV * uint32<br />&#160;&#160;| DVR of DV * DV ref * TraceOp * uint32 ref * uint32<br />&#160;&#160;member Copy : unit -&gt; DV<br />&#160;&#160;member GetForward : t:DV * i:uint32 -&gt; DV<br />&#160;&#160;member GetReverse : i:uint32 -&gt; DV<br />&#160;&#160;member GetSlice : lower:int option * upper:int option -&gt; DV<br />&#160;&#160;member ToArray : unit -&gt; D []<br />&#160;&#160;member ToColDM : unit -&gt; DM<br />&#160;&#160;member ToMathematicaString : unit -&gt; string<br />&#160;&#160;member ToMatlabString : unit -&gt; string<br />&#160;&#160;member ToRowDM : unit -&gt; DM<br />&#160;&#160;override ToString : unit -&gt; string<br />&#160;&#160;member Visualize : unit -&gt; string<br />&#160;&#160;member A : DV<br />&#160;&#160;member F : uint32<br />&#160;&#160;member Item : i:int -&gt; D with get<br />&#160;&#160;member Length : int<br />&#160;&#160;member P : DV<br />&#160;&#160;member PD : DV<br />&#160;&#160;member T : DV<br />&#160;&#160;member A : DV with set<br />&#160;&#160;member F : uint32 with set<br />&#160;&#160;static member Abs : a:DV -&gt; DV<br />&#160;&#160;static member Acos : a:DV -&gt; DV<br />&#160;&#160;static member AddItem : a:DV * i:int * b:D -&gt; DV<br />&#160;&#160;static member AddSubVector : a:DV * i:int * b:DV -&gt; DV<br />&#160;&#160;static member Append : a:DV * b:DV -&gt; DV<br />&#160;&#160;static member Asin : a:DV -&gt; DV<br />&#160;&#160;static member Atan : a:DV -&gt; DV<br />&#160;&#160;static member Atan2 : a:int * b:DV -&gt; DV<br />&#160;&#160;static member Atan2 : a:DV * b:int -&gt; DV<br />&#160;&#160;static member Atan2 : a:float * b:DV -&gt; DV<br />&#160;&#160;static member Atan2 : a:DV * b:float -&gt; DV<br />&#160;&#160;static member Atan2 : a:D * b:DV -&gt; DV<br />&#160;&#160;static member Atan2 : a:DV * b:D -&gt; DV<br />&#160;&#160;static member Atan2 : a:DV * b:DV -&gt; DV<br />&#160;&#160;static member Ceiling : a:DV -&gt; DV<br />&#160;&#160;static member Cos : a:DV -&gt; DV<br />&#160;&#160;static member Cosh : a:DV -&gt; DV<br />&#160;&#160;static member Exp : a:DV -&gt; DV<br />&#160;&#160;static member Floor : a:DV -&gt; DV<br />&#160;&#160;static member L1Norm : a:DV -&gt; D<br />&#160;&#160;static member L2Norm : a:DV -&gt; D<br />&#160;&#160;static member L2NormSq : a:DV -&gt; D<br />&#160;&#160;static member Log : a:DV -&gt; DV<br />&#160;&#160;static member Log10 : a:DV -&gt; DV<br />&#160;&#160;static member LogSumExp : a:DV -&gt; D<br />&#160;&#160;static member Max : a:DV -&gt; D<br />&#160;&#160;static member Max : a:D * b:DV -&gt; DV<br />&#160;&#160;static member Max : a:DV * b:D -&gt; DV<br />&#160;&#160;static member Max : a:DV * b:DV -&gt; DV<br />&#160;&#160;static member MaxIndex : a:DV -&gt; int<br />&#160;&#160;static member Mean : a:DV -&gt; D<br />&#160;&#160;static member Min : a:DV -&gt; D<br />&#160;&#160;static member Min : a:D * b:DV -&gt; DV<br />&#160;&#160;static member Min : a:DV * b:D -&gt; DV<br />&#160;&#160;static member Min : a:DV * b:DV -&gt; DV<br />&#160;&#160;static member MinIndex : a:DV -&gt; int<br />&#160;&#160;static member Normalize : a:DV -&gt; DV<br />&#160;&#160;static member OfArray : a:D [] -&gt; DV<br />&#160;&#160;static member Op_DV_D : a:DV * ff:(float [] -&gt; float) * fd:(DV -&gt; D) * df:(D * DV * DV -&gt; D) * r:(DV -&gt; TraceOp) -&gt; D<br />&#160;&#160;static member Op_DV_DM : a:DV * ff:(float [] -&gt; float [,]) * fd:(DV -&gt; DM) * df:(DM * DV * DV -&gt; DM) * r:(DV -&gt; TraceOp) -&gt; DM<br />&#160;&#160;static member Op_DV_DV : a:DV * ff:(float [] -&gt; float []) * fd:(DV -&gt; DV) * df:(DV * DV * DV -&gt; DV) * r:(DV -&gt; TraceOp) -&gt; DV<br />&#160;&#160;static member Op_DV_DV_D : a:DV * b:DV * ff:(float [] * float [] -&gt; float) * fd:(DV * DV -&gt; D) * df_da:(D * DV * DV -&gt; D) * df_db:(D * DV * DV -&gt; D) * df_dab:(D * DV * DV * DV * DV -&gt; D) * r_d_d:(DV * DV -&gt; TraceOp) * r_d_c:(DV * DV -&gt; TraceOp) * r_c_d:(DV * DV -&gt; TraceOp) -&gt; D<br />&#160;&#160;static member Op_DV_DV_DM : a:DV * b:DV * ff:(float [] * float [] -&gt; float [,]) * fd:(DV * DV -&gt; DM) * df_da:(DM * DV * DV -&gt; DM) * df_db:(DM * DV * DV -&gt; DM) * df_dab:(DM * DV * DV * DV * DV -&gt; DM) * r_d_d:(DV * DV -&gt; TraceOp) * r_d_c:(DV * DV -&gt; TraceOp) * r_c_d:(DV * DV -&gt; TraceOp) -&gt; DM<br />&#160;&#160;static member Op_DV_DV_DV : a:DV * b:DV * ff:(float [] * float [] -&gt; float []) * fd:(DV * DV -&gt; DV) * df_da:(DV * DV * DV -&gt; DV) * df_db:(DV * DV * DV -&gt; DV) * df_dab:(DV * DV * DV * DV * DV -&gt; DV) * r_d_d:(DV * DV -&gt; TraceOp) * r_d_c:(DV * DV -&gt; TraceOp) * r_c_d:(DV * DV -&gt; TraceOp) -&gt; DV<br />&#160;&#160;static member Op_DV_D_DV : a:DV * b:D * ff:(float [] * float -&gt; float []) * fd:(DV * D -&gt; DV) * df_da:(DV * DV * DV -&gt; DV) * df_db:(DV * D * D -&gt; DV) * df_dab:(DV * DV * DV * D * D -&gt; DV) * r_d_d:(DV * D -&gt; TraceOp) * r_d_c:(DV * D -&gt; TraceOp) * r_c_d:(DV * D -&gt; TraceOp) -&gt; DV<br />&#160;&#160;static member Op_D_DV_DV : a:D * b:DV * ff:(float * float [] -&gt; float []) * fd:(D * DV -&gt; DV) * df_da:(DV * D * D -&gt; DV) * df_db:(DV * DV * DV -&gt; DV) * df_dab:(DV * D * D * DV * DV -&gt; DV) * r_d_d:(D * DV -&gt; TraceOp) * r_d_c:(D * DV -&gt; TraceOp) * r_c_d:(D * DV -&gt; TraceOp) -&gt; DV<br />&#160;&#160;static member Pow : a:int * b:DV -&gt; DV<br />&#160;&#160;static member Pow : a:DV * b:int -&gt; DV<br />&#160;&#160;static member Pow : a:float * b:DV -&gt; DV<br />&#160;&#160;static member Pow : a:DV * b:float -&gt; DV<br />&#160;&#160;static member Pow : a:D * b:DV -&gt; DV<br />&#160;&#160;static member Pow : a:DV * b:D -&gt; DV<br />&#160;&#160;static member Pow : a:DV * b:DV -&gt; DV<br />&#160;&#160;static member ReLU : a:DV -&gt; DV<br />&#160;&#160;static member ReshapeToDM : m:int * a:DV -&gt; DM<br />&#160;&#160;static member Round : a:DV -&gt; DV<br />&#160;&#160;static member Sigmoid : a:DV -&gt; DV<br />&#160;&#160;static member Sign : a:DV -&gt; DV<br />&#160;&#160;static member Sin : a:DV -&gt; DV<br />&#160;&#160;static member Sinh : a:DV -&gt; DV<br />&#160;&#160;static member SoftMax : a:DV -&gt; DV<br />&#160;&#160;static member SoftPlus : a:DV -&gt; DV<br />&#160;&#160;static member SoftSign : a:DV -&gt; DV<br />&#160;&#160;static member Split : d:DV * n:seq&lt;int&gt; -&gt; seq&lt;DV&gt;<br />&#160;&#160;static member Sqrt : a:DV -&gt; DV<br />&#160;&#160;static member StandardDev : a:DV -&gt; D<br />&#160;&#160;static member Standardize : a:DV -&gt; DV<br />&#160;&#160;static member Sum : a:DV -&gt; D<br />&#160;&#160;static member Tan : a:DV -&gt; DV<br />&#160;&#160;static member Tanh : a:DV -&gt; DV<br />&#160;&#160;static member Variance : a:DV -&gt; D<br />&#160;&#160;static member ZeroN : n:int -&gt; DV<br />&#160;&#160;static member Zero : DV<br />&#160;&#160;static member ( + ) : a:int * b:DV -&gt; DV<br />&#160;&#160;static member ( + ) : a:DV * b:int -&gt; DV<br />&#160;&#160;static member ( + ) : a:float * b:DV -&gt; DV<br />&#160;&#160;static member ( + ) : a:DV * b:float -&gt; DV<br />&#160;&#160;static member ( + ) : a:D * b:DV -&gt; DV<br />&#160;&#160;static member ( + ) : a:DV * b:D -&gt; DV<br />&#160;&#160;static member ( + ) : a:DV * b:DV -&gt; DV<br />&#160;&#160;static member ( &amp;* ) : a:DV * b:DV -&gt; DM<br />&#160;&#160;static member ( / ) : a:int * b:DV -&gt; DV<br />&#160;&#160;static member ( / ) : a:DV * b:int -&gt; DV<br />&#160;&#160;static member ( / ) : a:float * b:DV -&gt; DV<br />&#160;&#160;static member ( / ) : a:DV * b:float -&gt; DV<br />&#160;&#160;static member ( / ) : a:D * b:DV -&gt; DV<br />&#160;&#160;static member ( / ) : a:DV * b:D -&gt; DV<br />&#160;&#160;static member ( ./ ) : a:DV * b:DV -&gt; DV<br />&#160;&#160;static member ( .* ) : a:DV * b:DV -&gt; DV<br />&#160;&#160;static member op_Explicit : d:float [] -&gt; DV<br />&#160;&#160;static member op_Explicit : d:DV -&gt; float []<br />&#160;&#160;static member ( * ) : a:int * b:DV -&gt; DV<br />&#160;&#160;static member ( * ) : a:DV * b:int -&gt; DV<br />&#160;&#160;static member ( * ) : a:float * b:DV -&gt; DV<br />&#160;&#160;static member ( * ) : a:DV * b:float -&gt; DV<br />&#160;&#160;static member ( * ) : a:D * b:DV -&gt; DV<br />&#160;&#160;static member ( * ) : a:DV * b:D -&gt; DV<br />&#160;&#160;static member ( * ) : a:DV * b:DV -&gt; D<br />&#160;&#160;static member ( - ) : a:int * b:DV -&gt; DV<br />&#160;&#160;static member ( - ) : a:DV * b:int -&gt; DV<br />&#160;&#160;static member ( - ) : a:float * b:DV -&gt; DV<br />&#160;&#160;static member ( - ) : a:DV * b:float -&gt; DV<br />&#160;&#160;static member ( - ) : a:D * b:DV -&gt; DV<br />&#160;&#160;static member ( - ) : a:DV * b:D -&gt; DV<br />&#160;&#160;static member ( - ) : a:DV * b:DV -&gt; DV<br />&#160;&#160;static member ( ~- ) : a:DV -&gt; DV<br /><br />Full name: DiffSharp.AD.Float64.DV</div>
<div class="tip" id="fs10">Layer.a: DV -&gt; DV</div>
<div class="tip" id="fs11">type Network =<br />&#160;&#160;{layers: Layer [];}<br /><br />Full name: Examples-neuralnetworks.Network</div>
<div class="tip" id="fs12">Network.layers: Layer []</div>
<div class="tip" id="fs13">val runLayer : x:DV -&gt; l:Layer -&gt; DV<br /><br />Full name: Examples-neuralnetworks.runLayer</div>
<div class="tip" id="fs14">val x : DV</div>
<div class="tip" id="fs15">val l : Layer</div>
<div class="tip" id="fs16">val runNetwork : x:DV -&gt; n:Network -&gt; DV<br /><br />Full name: Examples-neuralnetworks.runNetwork</div>
<div class="tip" id="fs17">val n : Network</div>
<div class="tip" id="fs18">Multiple items<br />module Array<br /><br />from DiffSharp.Util<br /><br />--------------------<br />module Array<br /><br />from Microsoft.FSharp.Collections</div>
<div class="tip" id="fs19">val fold : folder:(&#39;State -&gt; &#39;T -&gt; &#39;State) -&gt; state:&#39;State -&gt; array:&#39;T [] -&gt; &#39;State<br /><br />Full name: Microsoft.FSharp.Collections.Array.fold</div>
<div class="tip" id="fs20">val rnd : System.Random<br /><br />Full name: Examples-neuralnetworks.rnd</div>
<div class="tip" id="fs21">namespace System</div>
<div class="tip" id="fs22">Multiple items<br />type Random =<br />&#160;&#160;new : unit -&gt; Random + 1 overload<br />&#160;&#160;member Next : unit -&gt; int + 2 overloads<br />&#160;&#160;member NextBytes : buffer:byte[] -&gt; unit<br />&#160;&#160;member NextDouble : unit -&gt; float<br /><br />Full name: System.Random<br /><br />--------------------<br />System.Random() : unit<br />System.Random(Seed: int) : unit</div>
<div class="tip" id="fs23">val createNetwork : l:int [] -&gt; Network<br /><br />Full name: Examples-neuralnetworks.createNetwork</div>
<div class="tip" id="fs24">val l : int []</div>
<div class="tip" id="fs25">Multiple items<br />val int : value:&#39;T -&gt; int (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.int<br /><br />--------------------<br />type int = int32<br /><br />Full name: Microsoft.FSharp.Core.int<br /><br />--------------------<br />type int&lt;&#39;Measure&gt; = int<br /><br />Full name: Microsoft.FSharp.Core.int&lt;_&gt;</div>
<div class="tip" id="fs26">val init : count:int -&gt; initializer:(int -&gt; &#39;T) -&gt; &#39;T []<br /><br />Full name: Microsoft.FSharp.Collections.Array.init</div>
<div class="tip" id="fs27">property System.Array.Length: int</div>
<div class="tip" id="fs28">val i : int</div>
<div class="tip" id="fs29">val init : m:int -&gt; n:int -&gt; f:(int -&gt; int -&gt; &#39;a) -&gt; DM<br /><br />Full name: DiffSharp.AD.Float64.DM.init</div>
<div class="tip" id="fs30">System.Random.NextDouble() : float</div>
<div class="tip" id="fs31">val init : n:int -&gt; f:(int -&gt; &#39;a) -&gt; DV<br /><br />Full name: DiffSharp.AD.Float64.DV.init</div>
<div class="tip" id="fs32">val sigmoid : x:&#39;a -&gt; &#39;a (requires member Sigmoid)<br /><br />Full name: DiffSharp.Util.sigmoid</div>
<div class="tip" id="fs33">val net1 : Network<br /><br />Full name: Examples-neuralnetworks.net1</div>
<div class="tip" id="fs34">val backprop : n:Network -&gt; eta:float -&gt; epochs:int -&gt; x:DV [] -&gt; y:DV [] -&gt; seq&lt;float&gt;<br /><br />Full name: Examples-neuralnetworks.backprop</div>
<div class="tip" id="fs35">val eta : float</div>
<div class="tip" id="fs36">val epochs : int</div>
<div class="tip" id="fs37">val x : DV []</div>
<div class="tip" id="fs38">val y : DV []</div>
<div class="tip" id="fs39">val i : uint32</div>
<div class="tip" id="fs40">Multiple items<br />type GlobalTagger =<br />&#160;&#160;new : unit -&gt; GlobalTagger<br />&#160;&#160;static member Next : uint32<br />&#160;&#160;static member Reset : unit<br /><br />Full name: DiffSharp.Util.GlobalTagger<br /><br />--------------------<br />new : unit -&gt; GlobalTagger</div>
<div class="tip" id="fs41">property GlobalTagger.Next: uint32</div>
<div class="tip" id="fs42">Multiple items<br />val seq : sequence:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Core.Operators.seq<br /><br />--------------------<br />type seq&lt;&#39;T&gt; = System.Collections.Generic.IEnumerable&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Collections.seq&lt;_&gt;</div>
<div class="tip" id="fs43">val j : int</div>
<div class="tip" id="fs44">val makeReverse : i:uint32 -&gt; p:&#39;a -&gt; &#39;a (requires member GetReverse)<br /><br />Full name: DiffSharp.AD.Float64.DOps.makeReverse</div>
<div class="tip" id="fs45">val L : D</div>
<div class="tip" id="fs46">val map2 : mapping:(&#39;T1 -&gt; &#39;T2 -&gt; &#39;U) -&gt; array1:&#39;T1 [] -&gt; array2:&#39;T2 [] -&gt; &#39;U []<br /><br />Full name: Microsoft.FSharp.Collections.Array.map2</div>
<div class="tip" id="fs47">val y : DV</div>
<div class="tip" id="fs48">val l2normSq : v:DV -&gt; D<br /><br />Full name: DiffSharp.AD.Float64.DV.l2normSq</div>
<div class="tip" id="fs49">val sum : array:&#39;T [] -&gt; &#39;T (requires member ( + ) and member get_Zero)<br /><br />Full name: Microsoft.FSharp.Collections.Array.sum</div>
<div class="tip" id="fs50">val reverseProp : v:obj -&gt; d:obj -&gt; unit<br /><br />Full name: DiffSharp.AD.Float64.DOps.reverseProp</div>
<div class="tip" id="fs51">union case D.D: float -&gt; D</div>
<div class="tip" id="fs52">val primal : d:&#39;a -&gt; &#39;a (requires member get_P)<br /><br />Full name: DiffSharp.AD.Float64.DOps.primal</div>
<div class="tip" id="fs53">property DM.P: DM</div>
<div class="tip" id="fs54">property DM.A: DM</div>
<div class="tip" id="fs55">property DV.P: DV</div>
<div class="tip" id="fs56">property DV.A: DV</div>
<div class="tip" id="fs57">val printfn : format:Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.printfn</div>
<div class="tip" id="fs58">Multiple items<br />val float : value:&#39;T -&gt; float (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.float<br /><br />--------------------<br />type float = System.Double<br /><br />Full name: Microsoft.FSharp.Core.float<br /><br />--------------------<br />type float&lt;&#39;Measure&gt; = float<br /><br />Full name: Microsoft.FSharp.Core.float&lt;_&gt;</div>
<div class="tip" id="fs59">namespace FSharp</div>
<div class="tip" id="fs60">namespace FSharp.Charting</div>
<div class="tip" id="fs61">val ORx : DV []<br /><br />Full name: Examples-neuralnetworks.ORx</div>
<div class="tip" id="fs62">val toDV : v:seq&lt;&#39;a&gt; -&gt; DV (requires member op_Explicit)<br /><br />Full name: DiffSharp.AD.Float64.DOps.toDV</div>
<div class="tip" id="fs63">val ORy : DV []<br /><br />Full name: Examples-neuralnetworks.ORy</div>
<div class="tip" id="fs64">val net2 : Network<br /><br />Full name: Examples-neuralnetworks.net2</div>
<div class="tip" id="fs65">val train2 : seq&lt;float&gt;<br /><br />Full name: Examples-neuralnetworks.train2</div>
<div class="tip" id="fs66">type Chart =<br />&#160;&#160;static member Area : data:seq&lt;#value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string -&gt; GenericChart<br />&#160;&#160;static member Area : data:seq&lt;#key * #value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string -&gt; GenericChart<br />&#160;&#160;static member Bar : data:seq&lt;#value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string -&gt; GenericChart<br />&#160;&#160;static member Bar : data:seq&lt;#key * #value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string -&gt; GenericChart<br />&#160;&#160;static member BoxPlotFromData : data:seq&lt;#key * #seq&lt;&#39;a2&gt;&gt; * ?Name:string * ?Title:string * ?Color:Color * ?XTitle:string * ?YTitle:string * ?Percentile:int * ?ShowAverage:bool * ?ShowMedian:bool * ?ShowUnusualValues:bool * ?WhiskerPercentile:int -&gt; GenericChart (requires &#39;a2 :&gt; value)<br />&#160;&#160;static member BoxPlotFromStatistics : data:seq&lt;#key * #value * #value * #value * #value * #value * #value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string * ?Percentile:int * ?ShowAverage:bool * ?ShowMedian:bool * ?ShowUnusualValues:bool * ?WhiskerPercentile:int -&gt; GenericChart<br />&#160;&#160;static member Bubble : data:seq&lt;#value * #value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string * ?BubbleMaxSize:int * ?BubbleMinSize:int * ?BubbleScaleMax:float * ?BubbleScaleMin:float * ?UseSizeForLabel:bool -&gt; GenericChart<br />&#160;&#160;static member Bubble : data:seq&lt;#key * #value * #value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string * ?BubbleMaxSize:int * ?BubbleMinSize:int * ?BubbleScaleMax:float * ?BubbleScaleMin:float * ?UseSizeForLabel:bool -&gt; GenericChart<br />&#160;&#160;static member Candlestick : data:seq&lt;#value * #value * #value * #value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string -&gt; CandlestickChart<br />&#160;&#160;static member Candlestick : data:seq&lt;#key * #value * #value * #value * #value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string -&gt; CandlestickChart<br />&#160;&#160;...<br /><br />Full name: FSharp.Charting.Chart</div>
<div class="tip" id="fs67">static member Chart.Line : data:seq&lt;#value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:System.Drawing.Color * ?XTitle:string * ?YTitle:string -&gt; ChartTypes.GenericChart<br />static member Chart.Line : data:seq&lt;#key * #value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:System.Drawing.Color * ?XTitle:string * ?YTitle:string -&gt; ChartTypes.GenericChart</div>
<div class="tip" id="fs68">val XORx : DV []<br /><br />Full name: Examples-neuralnetworks.XORx</div>
<div class="tip" id="fs69">val XORy : DV []<br /><br />Full name: Examples-neuralnetworks.XORy</div>
<div class="tip" id="fs70">val net3 : Network<br /><br />Full name: Examples-neuralnetworks.net3</div>
<div class="tip" id="fs71">val train3 : seq&lt;float&gt;<br /><br />Full name: Examples-neuralnetworks.train3</div>
<div class="tip" id="fs72">type Layer&#39; =<br />&#160;&#160;{mutable W: DM;<br />&#160;&#160;&#160;mutable b: DV;<br />&#160;&#160;&#160;a: DM -&gt; DM;}<br /><br />Full name: Examples-neuralnetworks.Layer&#39;</div>
<div class="tip" id="fs73">Layer&#39;.W: DM</div>
<div class="tip" id="fs74">Layer&#39;.b: DV</div>
<div class="tip" id="fs75">Layer&#39;.a: DM -&gt; DM</div>
<div class="tip" id="fs76">type Network&#39; =<br />&#160;&#160;{layers: Layer&#39; [];}<br /><br />Full name: Examples-neuralnetworks.Network&#39;</div>
<div class="tip" id="fs77">Network&#39;.layers: Layer&#39; []</div>
<div class="tip" id="fs78">val runLayer&#39; : x:DM -&gt; l:Layer&#39; -&gt; DM<br /><br />Full name: Examples-neuralnetworks.runLayer&#39;</div>
<div class="tip" id="fs79">val x : DM</div>
<div class="tip" id="fs80">val l : Layer&#39;</div>
<div class="tip" id="fs81">val createCols : n:int -&gt; v:DV -&gt; DM<br /><br />Full name: DiffSharp.AD.Float64.DM.createCols</div>
<div class="tip" id="fs82">property DM.Cols: int</div>
<div class="tip" id="fs83">val runNetwork&#39; : x:DM -&gt; n:Network&#39; -&gt; DM<br /><br />Full name: Examples-neuralnetworks.runNetwork&#39;</div>
<div class="tip" id="fs84">val n : Network&#39;</div>
<div class="tip" id="fs85">val backprop&#39; : n:Network&#39; -&gt; eta:float -&gt; epochs:int -&gt; mbsize:int -&gt; loss:(DM -&gt; DM -&gt; D) -&gt; x:DM -&gt; y:DM -&gt; unit<br /><br />Full name: Examples-neuralnetworks.backprop&#39;</div>
<div class="tip" id="fs86">val mbsize : int</div>
<div class="tip" id="fs87">val loss : (DM -&gt; DM -&gt; D)</div>
<div class="tip" id="fs88">val y : DM</div>
<div class="tip" id="fs89">val mutable b : int</div>
<div class="tip" id="fs90">val batches : int</div>
<div class="tip" id="fs91">val mutable j : int</div>
<div class="tip" id="fs92">val mbX : DM</div>
<div class="tip" id="fs93">val mbY : DM</div>
<div class="tip" id="fs94">type D =<br />&#160;&#160;| D of float<br />&#160;&#160;| DF of D * D * uint32<br />&#160;&#160;| DR of D * D ref * TraceOp * uint32 ref * uint32<br />&#160;&#160;interface IComparable<br />&#160;&#160;member Copy : unit -&gt; D<br />&#160;&#160;override Equals : other:obj -&gt; bool<br />&#160;&#160;member GetForward : t:D * i:uint32 -&gt; D<br />&#160;&#160;override GetHashCode : unit -&gt; int<br />&#160;&#160;member GetReverse : i:uint32 -&gt; D<br />&#160;&#160;override ToString : unit -&gt; string<br />&#160;&#160;member A : D<br />&#160;&#160;member F : uint32<br />&#160;&#160;member P : D<br />&#160;&#160;member PD : D<br />&#160;&#160;member T : D<br />&#160;&#160;member A : D with set<br />&#160;&#160;member F : uint32 with set<br />&#160;&#160;static member Abs : a:D -&gt; D<br />&#160;&#160;static member Acos : a:D -&gt; D<br />&#160;&#160;static member Asin : a:D -&gt; D<br />&#160;&#160;static member Atan : a:D -&gt; D<br />&#160;&#160;static member Atan2 : a:int * b:D -&gt; D<br />&#160;&#160;static member Atan2 : a:D * b:int -&gt; D<br />&#160;&#160;static member Atan2 : a:float * b:D -&gt; D<br />&#160;&#160;static member Atan2 : a:D * b:float -&gt; D<br />&#160;&#160;static member Atan2 : a:D * b:D -&gt; D<br />&#160;&#160;static member Ceiling : a:D -&gt; D<br />&#160;&#160;static member Cos : a:D -&gt; D<br />&#160;&#160;static member Cosh : a:D -&gt; D<br />&#160;&#160;static member Exp : a:D -&gt; D<br />&#160;&#160;static member Floor : a:D -&gt; D<br />&#160;&#160;static member Log : a:D -&gt; D<br />&#160;&#160;static member Log10 : a:D -&gt; D<br />&#160;&#160;static member LogSumExp : a:D -&gt; D<br />&#160;&#160;static member Max : a:D * b:D -&gt; D<br />&#160;&#160;static member Min : a:D * b:D -&gt; D<br />&#160;&#160;static member Op_D_D : a:D * ff:(float -&gt; float) * fd:(D -&gt; D) * df:(D * D * D -&gt; D) * r:(D -&gt; TraceOp) -&gt; D<br />&#160;&#160;static member Op_D_D_D : a:D * b:D * ff:(float * float -&gt; float) * fd:(D * D -&gt; D) * df_da:(D * D * D -&gt; D) * df_db:(D * D * D -&gt; D) * df_dab:(D * D * D * D * D -&gt; D) * r_d_d:(D * D -&gt; TraceOp) * r_d_c:(D * D -&gt; TraceOp) * r_c_d:(D * D -&gt; TraceOp) -&gt; D<br />&#160;&#160;static member Pow : a:int * b:D -&gt; D<br />&#160;&#160;static member Pow : a:D * b:int -&gt; D<br />&#160;&#160;static member Pow : a:float * b:D -&gt; D<br />&#160;&#160;static member Pow : a:D * b:float -&gt; D<br />&#160;&#160;static member Pow : a:D * b:D -&gt; D<br />&#160;&#160;static member ReLU : a:D -&gt; D<br />&#160;&#160;static member Round : a:D -&gt; D<br />&#160;&#160;static member Sigmoid : a:D -&gt; D<br />&#160;&#160;static member Sign : a:D -&gt; D<br />&#160;&#160;static member Sin : a:D -&gt; D<br />&#160;&#160;static member Sinh : a:D -&gt; D<br />&#160;&#160;static member SoftPlus : a:D -&gt; D<br />&#160;&#160;static member SoftSign : a:D -&gt; D<br />&#160;&#160;static member Sqrt : a:D -&gt; D<br />&#160;&#160;static member Tan : a:D -&gt; D<br />&#160;&#160;static member Tanh : a:D -&gt; D<br />&#160;&#160;static member One : D<br />&#160;&#160;static member Zero : D<br />&#160;&#160;static member ( + ) : a:int * b:D -&gt; D<br />&#160;&#160;static member ( + ) : a:D * b:int -&gt; D<br />&#160;&#160;static member ( + ) : a:float * b:D -&gt; D<br />&#160;&#160;static member ( + ) : a:D * b:float -&gt; D<br />&#160;&#160;static member ( + ) : a:D * b:D -&gt; D<br />&#160;&#160;static member ( / ) : a:int * b:D -&gt; D<br />&#160;&#160;static member ( / ) : a:D * b:int -&gt; D<br />&#160;&#160;static member ( / ) : a:float * b:D -&gt; D<br />&#160;&#160;static member ( / ) : a:D * b:float -&gt; D<br />&#160;&#160;static member ( / ) : a:D * b:D -&gt; D<br />&#160;&#160;static member op_Explicit : d:D -&gt; float<br />&#160;&#160;static member ( * ) : a:int * b:D -&gt; D<br />&#160;&#160;static member ( * ) : a:D * b:int -&gt; D<br />&#160;&#160;static member ( * ) : a:float * b:D -&gt; D<br />&#160;&#160;static member ( * ) : a:D * b:float -&gt; D<br />&#160;&#160;static member ( * ) : a:D * b:D -&gt; D<br />&#160;&#160;static member ( - ) : a:int * b:D -&gt; D<br />&#160;&#160;static member ( - ) : a:D * b:int -&gt; D<br />&#160;&#160;static member ( - ) : a:float * b:D -&gt; D<br />&#160;&#160;static member ( - ) : a:D * b:float -&gt; D<br />&#160;&#160;static member ( - ) : a:D * b:D -&gt; D<br />&#160;&#160;static member ( ~- ) : a:D -&gt; D<br /><br />Full name: DiffSharp.AD.Float64.D</div>
<div class="tip" id="fs95">namespace System.IO</div>
<div class="tip" id="fs96">type MNIST =<br />&#160;&#160;static member Load : filename:string -&gt; DM<br />&#160;&#160;static member Load : filename:string * items:int -&gt; DM<br /><br />Full name: Examples-neuralnetworks.MNIST</div>
<div class="tip" id="fs97">static member MNIST.Load : filename:string * items:int -&gt; DM<br /><br />Full name: Examples-neuralnetworks.MNIST.Load</div>
<div class="tip" id="fs98">val filename : string</div>
<div class="tip" id="fs99">val items : int</div>
<div class="tip" id="fs100">val d : BinaryReader</div>
<div class="tip" id="fs101">Multiple items<br />type BinaryReader =<br />&#160;&#160;new : input:Stream -&gt; BinaryReader + 1 overload<br />&#160;&#160;member BaseStream : Stream<br />&#160;&#160;member Close : unit -&gt; unit<br />&#160;&#160;member Dispose : unit -&gt; unit<br />&#160;&#160;member PeekChar : unit -&gt; int<br />&#160;&#160;member Read : unit -&gt; int + 2 overloads<br />&#160;&#160;member ReadBoolean : unit -&gt; bool<br />&#160;&#160;member ReadByte : unit -&gt; byte<br />&#160;&#160;member ReadBytes : count:int -&gt; byte[]<br />&#160;&#160;member ReadChar : unit -&gt; char<br />&#160;&#160;...<br /><br />Full name: System.IO.BinaryReader<br /><br />--------------------<br />BinaryReader(input: Stream) : unit<br />BinaryReader(input: Stream, encoding: System.Text.Encoding) : unit</div>
<div class="tip" id="fs102">type File =<br />&#160;&#160;static member AppendAllLines : path:string * contents:IEnumerable&lt;string&gt; -&gt; unit + 1 overload<br />&#160;&#160;static member AppendAllText : path:string * contents:string -&gt; unit + 1 overload<br />&#160;&#160;static member AppendText : path:string -&gt; StreamWriter<br />&#160;&#160;static member Copy : sourceFileName:string * destFileName:string -&gt; unit + 1 overload<br />&#160;&#160;static member Create : path:string -&gt; FileStream + 3 overloads<br />&#160;&#160;static member CreateText : path:string -&gt; StreamWriter<br />&#160;&#160;static member Decrypt : path:string -&gt; unit<br />&#160;&#160;static member Delete : path:string -&gt; unit<br />&#160;&#160;static member Encrypt : path:string -&gt; unit<br />&#160;&#160;static member Exists : path:string -&gt; bool<br />&#160;&#160;...<br /><br />Full name: System.IO.File</div>
<div class="tip" id="fs103">File.Open(path: string, mode: FileMode) : FileStream<br />File.Open(path: string, mode: FileMode, access: FileAccess) : FileStream<br />File.Open(path: string, mode: FileMode, access: FileAccess, share: FileShare) : FileStream</div>
<div class="tip" id="fs104">type FileMode =<br />&#160;&#160;| CreateNew = 1<br />&#160;&#160;| Create = 2<br />&#160;&#160;| Open = 3<br />&#160;&#160;| OpenOrCreate = 4<br />&#160;&#160;| Truncate = 5<br />&#160;&#160;| Append = 6<br /><br />Full name: System.IO.FileMode</div>
<div class="tip" id="fs105">field FileMode.Open = 3</div>
<div class="tip" id="fs106">type FileAccess =<br />&#160;&#160;| Read = 1<br />&#160;&#160;| Write = 2<br />&#160;&#160;| ReadWrite = 3<br /><br />Full name: System.IO.FileAccess</div>
<div class="tip" id="fs107">field FileAccess.Read = 1</div>
<div class="tip" id="fs108">type FileShare =<br />&#160;&#160;| None = 0<br />&#160;&#160;| Read = 1<br />&#160;&#160;| Write = 2<br />&#160;&#160;| ReadWrite = 3<br />&#160;&#160;| Delete = 4<br />&#160;&#160;| Inheritable = 16<br /><br />Full name: System.IO.FileShare</div>
<div class="tip" id="fs109">field FileShare.Read = 1</div>
<div class="tip" id="fs110">val magicnumber : int</div>
<div class="tip" id="fs111">BinaryReader.ReadInt32() : int</div>
<div class="tip" id="fs112">namespace System.Net</div>
<div class="tip" id="fs113">Multiple items<br />type IPAddress =<br />&#160;&#160;new : newAddress:int64 -&gt; IPAddress + 2 overloads<br />&#160;&#160;member Address : int64 with get, set<br />&#160;&#160;member AddressFamily : AddressFamily<br />&#160;&#160;member Equals : comparand:obj -&gt; bool<br />&#160;&#160;member GetAddressBytes : unit -&gt; byte[]<br />&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;member IsIPv6LinkLocal : bool<br />&#160;&#160;member IsIPv6Multicast : bool<br />&#160;&#160;member IsIPv6SiteLocal : bool<br />&#160;&#160;member IsIPv6Teredo : bool<br />&#160;&#160;...<br /><br />Full name: System.Net.IPAddress<br /><br />--------------------<br />System.Net.IPAddress(newAddress: int64) : unit<br />System.Net.IPAddress(address: byte []) : unit<br />System.Net.IPAddress(address: byte [], scopeid: int64) : unit</div>
<div class="tip" id="fs114">System.Net.IPAddress.NetworkToHostOrder(network: int16) : int16<br />System.Net.IPAddress.NetworkToHostOrder(network: int) : int<br />System.Net.IPAddress.NetworkToHostOrder(network: int64) : int64</div>
<div class="tip" id="fs115">val maxitems : int</div>
<div class="tip" id="fs116">BinaryReader.ReadBytes(count: int) : byte []</div>
<div class="tip" id="fs117">val min : e1:&#39;T -&gt; e2:&#39;T -&gt; &#39;T (requires comparison)<br /><br />Full name: Microsoft.FSharp.Core.Operators.min</div>
<div class="tip" id="fs118">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; array:&#39;T [] -&gt; &#39;U []<br /><br />Full name: Microsoft.FSharp.Collections.Array.map</div>
<div class="tip" id="fs119">val ofDV : m:int -&gt; v:DV -&gt; DM<br /><br />Full name: DiffSharp.AD.Float64.DM.ofDV</div>
<div class="tip" id="fs120">val rows : int</div>
<div class="tip" id="fs121">val cols : int</div>
<div class="tip" id="fs122">val n : int</div>
<div class="tip" id="fs123">val transpose : m:DM -&gt; DM<br /><br />Full name: DiffSharp.AD.Float64.DM.transpose</div>
<div class="tip" id="fs124">val failwith : message:string -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.Operators.failwith</div>
<div class="tip" id="fs125">static member MNIST.Load : filename:string -&gt; DM<br /><br />Full name: Examples-neuralnetworks.MNIST.Load</div>
<div class="tip" id="fs126">static member MNIST.Load : filename:string -&gt; DM<br />static member MNIST.Load : filename:string * items:int -&gt; DM</div>
<div class="tip" id="fs127">type Int32 =<br />&#160;&#160;struct<br />&#160;&#160;&#160;&#160;member CompareTo : value:obj -&gt; int + 1 overload<br />&#160;&#160;&#160;&#160;member Equals : obj:obj -&gt; bool + 1 overload<br />&#160;&#160;&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;&#160;&#160;member GetTypeCode : unit -&gt; TypeCode<br />&#160;&#160;&#160;&#160;member ToString : unit -&gt; string + 3 overloads<br />&#160;&#160;&#160;&#160;static val MaxValue : int<br />&#160;&#160;&#160;&#160;static val MinValue : int<br />&#160;&#160;&#160;&#160;static member Parse : s:string -&gt; int + 3 overloads<br />&#160;&#160;&#160;&#160;static member TryParse : s:string * result:int -&gt; bool + 1 overload<br />&#160;&#160;end<br /><br />Full name: System.Int32</div>
<div class="tip" id="fs128">field int.MaxValue = 2147483647</div>
<div class="tip" id="fs129">val mnistTrainX : DM<br /><br />Full name: Examples-neuralnetworks.mnistTrainX</div>
<div class="tip" id="fs130">val mnistTrainY : DM<br /><br />Full name: Examples-neuralnetworks.mnistTrainY</div>
<div class="tip" id="fs131">val l0 : Layer&#39;<br /><br />Full name: Examples-neuralnetworks.l0</div>
<div class="tip" id="fs132">val zeroCreate : n:int -&gt; DV<br /><br />Full name: DiffSharp.AD.Float64.DV.zeroCreate</div>
<div class="tip" id="fs133">val tanh : value:&#39;T -&gt; &#39;T (requires member Tanh)<br /><br />Full name: Microsoft.FSharp.Core.Operators.tanh</div>
<div class="tip" id="fs134">val l1 : Layer&#39;<br /><br />Full name: Examples-neuralnetworks.l1</div>
<div class="tip" id="fs135">val mapCols : f:(DV -&gt; DV) -&gt; m:DM -&gt; DM<br /><br />Full name: DiffSharp.AD.Float64.DM.mapCols</div>
<div class="tip" id="fs136">val softmax : x:&#39;a -&gt; &#39;a (requires member SoftMax)<br /><br />Full name: DiffSharp.Util.softmax</div>
<div class="tip" id="fs137">val nn : Network&#39;<br /><br />Full name: Examples-neuralnetworks.nn</div>
<div class="tip" id="fs138">val crossEntropy : x:DM -&gt; y:DM -&gt; D<br /><br />Full name: Examples-neuralnetworks.crossEntropy</div>
<div class="tip" id="fs139">val toCols : m:DM -&gt; seq&lt;DV&gt;<br /><br />Full name: DiffSharp.AD.Float64.DM.toCols</div>
<div class="tip" id="fs140">module Seq<br /><br />from Microsoft.FSharp.Collections</div>
<div class="tip" id="fs141">val mapi : mapping:(int -&gt; &#39;T -&gt; &#39;U) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;U&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.mapi</div>
<div class="tip" id="fs142">val v : DV</div>
<div class="tip" id="fs143">val standardBasis : n:int -&gt; i:int -&gt; DV<br /><br />Full name: DiffSharp.AD.Float64.DV.standardBasis</div>
<div class="tip" id="fs144">property DV.Length: int</div>
<div class="tip" id="fs145">val log : value:&#39;T -&gt; &#39;T (requires member Log)<br /><br />Full name: Microsoft.FSharp.Core.Operators.log</div>
<div class="tip" id="fs146">val sum : source:seq&lt;&#39;T&gt; -&gt; &#39;T (requires member ( + ) and member get_Zero)<br /><br />Full name: Microsoft.FSharp.Collections.Seq.sum</div>
<div class="tip" id="fs147">val mnistTestX : DM<br /><br />Full name: Examples-neuralnetworks.mnistTestX</div>
<div class="tip" id="fs148">val mnistTestY : DM<br /><br />Full name: Examples-neuralnetworks.mnistTestY</div>
<div class="tip" id="fs149">val testY : DM<br /><br />Full name: Examples-neuralnetworks.testY</div>
<div class="tip" id="fs150">val testLoss : D<br /><br />Full name: Examples-neuralnetworks.testLoss</div>
<div class="tip" id="fs151">val testPredict : int []<br /><br />Full name: Examples-neuralnetworks.testPredict</div>
<div class="tip" id="fs152">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;U&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.map</div>
<div class="tip" id="fs153">val maxIndex : v:DV -&gt; int<br /><br />Full name: DiffSharp.AD.Float64.DV.maxIndex</div>
<div class="tip" id="fs154">val toArray : source:seq&lt;&#39;T&gt; -&gt; &#39;T []<br /><br />Full name: Microsoft.FSharp.Collections.Seq.toArray</div>
<div class="tip" id="fs155">val testTrue : DM<br /><br />Full name: Examples-neuralnetworks.testTrue</div>

        </div>
        <div class="span3">
          <a href="index.html"><img src="img/diffsharp-logo.png" style="width:140px;height:140px;margin:10px 0px 0px 20px;border-style:none;"/></a>

          <ul class="nav nav-list" id="menu">
            <li class="nav-header">DiffSharp</li>
            <li class="divider"></li>
            <li><a href="index.html">Home Page</a></li>
            <li><a href="https://github.com/DiffSharp/DiffSharp">GitHub Page</a></li>
            <li><a href="download.html">Download and FAQ</a></li>
            <li><a href="https://github.com/DiffSharp/DiffSharp/releases">Release Notes</a></li>

            <li class="nav-header">Getting Started</li>
            <li class="divider"></li>
            <li><a href="api-overview.html">API Overview</a></li>
            <li><a href="gettingstarted-nestedad.html">Nested AD</a></li>
            <li><a href="gettingstarted-numericaldifferentiation.html">Numerical Differentiation</a></li>
            <li><a href="gettingstarted-symbolicdifferentiation.html">Symbolic Differentiation</a></li>
            <li><a href="gettingstarted-typeinference.html">Type Inference</a></li>
            <li><a href="benchmarks.html">Benchmarks</a></li>
            <li><a href="csharp.html">C# and Other Languages</a></li>
            <li><a href="reference/index.html">API Reference</a></li>

            <li class="nav-header">Examples</li>
            <li class="divider"></li>

            <li class="nav-header">Machine Learning</li>
            <li><a href="examples-gradientdescent.html">Gradient Descent</a></li>
            <li><a href="examples-newtonsmethod.html">Newton's Method</a></li>
            <li><a href="examples-stochasticgradientdescent.html">Stochastic Gradient Descent</a></li>
            <li><a href="examples-kmeansclustering.html">K-Means Clustering</a></li>
            <li><a href="examples-hamiltonianmontecarlo.html">Hamiltonian Monte Carlo</a></li>
            <li><a href="examples-neuralnetworks.html">Neural Networks</a></li>
            <li>Neural Turing Machines (to come)</li>
            <li>Probabilistic Programming<br>(to come)</li>

            <li class="nav-header">Dynamical Systems</li>
            <li>Stability Analysis (to come)</li>

            <li class="nav-header">Control</li>
            <li><a href="examples-inversekinematics.html">Inverse Kinematics</a></li>
            <li>Adaptive Control (to come)</li>

            <li class="nav-header">Physics</li>
            <li><a href="examples-kinematics.html">Kinematics</a></li>
            <li>Leapfrog Integration (to come)</li>
            <li><a href="examples-helmholtzenergyfunction.html">Helmholtz Energy Function</a></li>

            <li class="nav-header">Math</li>
            <li><a href="examples-lhopitalsrule.html">l'Hôpital's Rule</a></li>

            <li class="nav-header">Makers</li>
            <li class="divider"></li>
            <li><a href="https://www.cs.nuim.ie/~gunes/">Atılım Güneş Baydin</a></li>
            <li><a href="http://www.bcl.hamilton.ie/~barak/">Barak A. Pearlmutter</a></li>
            <li><a href="http://www.bcl.hamilton.ie/">Brain and Computation Lab</a></li>
          </ul>
        </div>
      </div>
    </div>
    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=10059115;
    var sc_invisible=1;
    var sc_security="92275ee1";
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="https://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="https://c.statcounter.com/10059115/0/92275ee1/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->
  </body>
</html>
