<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <!-- 
      The Neural Networks
 parameters will be replaced with the 
      document title extracted from the <h1> element or
      file name, if there is no <h1> heading
    -->
    <title>Neural Networks
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Atılım Güneş Baydin; Barak A. Pearlmutter">
    <meta name="description" content="DiffSharp is an automatic differentiation (AD) library implemented in the F# language by Atılım Güneş Baydin and Barak A. Pearlmutter, mainly for research applications in machine learning, as part of their work at the Brain and Computation Lab, Hamilton Institute, National University of Ireland Maynooth.">

    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">
    
    <link type="text/css" rel="stylesheet" href="misc/style.css" />
    <script src="misc/tips.js" type="text/javascript"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-48900508-3', 'auto');
      ga('require', 'displayfeatures');
      ga('send', 'pageview');
    </script>
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="https://fsharp.org">fsharp.org</a></li>
        </ul>
        <h3 class="muted">DiffSharp</h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          <div class="row">
    <div class="span9">
    <div class="well well-small" id="nuget" style="background-color:#E0EBEB">
        <b>Please note:</b> the code in this example is provided for illustrating the basics and therefore kept simple and unoptimized. It is not intended for production use. It will be replaced with a better version supporting more complex cases.
    </div>
    </div>
</div>

<h1>Neural Networks</h1>

<p><a href="https://en.wikipedia.org/wiki/Artificial_neural_network">Artificial neural networks</a> are computational architectures based on the properties of biological neural systems, capable of learning and pattern recognition.</p>

<p>Let us create a <a href="https://en.wikipedia.org/wiki/Feedforward_neural_network">feedforward neural network</a> model and use the DiffSharp library for implementing the <a href="https://en.wikipedia.org/wiki/Backpropagation">backpropagation</a> algorithm for training it.</p>

<p>We start by defining our neural network structure.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">DiffSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">AD</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">FsAlg</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="i">Generic</span>

<span class="c">// A layer of neurons</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="t">Layer</span> <span class="o">=</span>
    {<span onmouseout="hideTip(event, 'fs6', 6)" onmouseover="showTip(event, 'fs6', 6)" class="i">W</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs7', 7)" onmouseover="showTip(event, 'fs7', 7)" class="t">Matrix</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs8', 8)" onmouseover="showTip(event, 'fs8', 8)" class="t">D</span><span class="o">&gt;</span>  <span class="c">// Weight matrix</span>
     <span onmouseout="hideTip(event, 'fs9', 9)" onmouseover="showTip(event, 'fs9', 9)" class="i">b</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs10', 10)" onmouseover="showTip(event, 'fs10', 10)" class="t">Vector</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs8', 11)" onmouseover="showTip(event, 'fs8', 11)" class="t">D</span><span class="o">&gt;</span>} <span class="c">// Bias vector</span>

<span class="c">// A feedforward network of neuron layers</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs11', 12)" onmouseover="showTip(event, 'fs11', 12)" class="t">Network</span> <span class="o">=</span>
    {<span onmouseout="hideTip(event, 'fs12', 13)" onmouseover="showTip(event, 'fs12', 13)" class="i">layers</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs5', 14)" onmouseover="showTip(event, 'fs5', 14)" class="t">Layer</span>[]} <span class="c">// The layers forming this network</span>
</pre>
</td>
</tr>
</table>

<p>The network will consist of several layers of neurons. Each neuron works by taking inputs <span class="math">\(\{x_1, \dots, x_n\}\)</span> and calculating the activation (output)</p>

<p><span class="math">\[  a = \sigma \left(\sum_{i} w_i x_i + b\right) \; ,\]</span></p>

<p>where <span class="math">\(w_i\)</span> are synapse weights associated with each input, <span class="math">\(b\)</span> is a bias, and <span class="math">\(\sigma\)</span> is an <a href="https://en.wikipedia.org/wiki/Activation_function">activation function</a> representing the rate of <a href="https://en.wikipedia.org/wiki/Action_potential">action potential</a> firing in the neuron.</p>

<div class="row">
    <div class="span6 offset2">
        <img src="img/examples-neuralnetworks-neuron.png" alt="Chart" style="width:400px;"/>
    </div>
</div>

<p>The activation function is commonly taken as the <a href="https://en.wikipedia.org/wiki/Sigmoid_function">sigmoid function</a></p>

<p><span class="math">\[  \sigma (z) = \frac{1}{1 + e^{-z}} \; ,\]</span></p>

<p>due to its "nice" and simple derivative and gain control properties.</p>

<p>Now let us write the network evaluation code and a function for creating a given network configuration and initializing the weights and biases with small random values.</p>

<p>A pleasant way of implementing network evaluation is to use linear algebra, where we have a weight matrix <span class="math">\(\mathbf{W}^l\)</span> holding the weights of all neurons in layer <span class="math">\(l\)</span>. The elements of this matrix <span class="math">\(w_{ij}\)</span> represent the weight between the <span class="math">\(j\)</span>-th neuron in layer <span class="math">\(l - 1\)</span> and the <span class="math">\(i\)</span>-th neuron in layer <span class="math">\(l\)</span>. We also have a bias vector <span class="math">\(\mathbf{b}^l\)</span> holding the biases of all neurons in layer <span class="math">\(l\)</span> (one bias per neuron). Then network evaluation is just a matter of computing the activation</p>

<p><span class="math">\[  \mathbf{a}^l = \mathbf{W}^l \mathbf{a}^{l - 1} + \mathbf{b}^l \; ,\]</span></p>

<p>for each layer and passing the activation vector (output) of each layer as the input to the next layer, until we have the network output as the output vector of the last layer.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs13', 15)" onmouseover="showTip(event, 'fs13', 15)" class="f">sigmoid</span> (<span onmouseout="hideTip(event, 'fs14', 16)" onmouseover="showTip(event, 'fs14', 16)" class="i">x</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs8', 17)" onmouseover="showTip(event, 'fs8', 17)" class="t">D</span>) <span class="o">=</span> <span class="n">1.</span> <span class="o">/</span> (<span class="n">1.</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs15', 18)" onmouseover="showTip(event, 'fs15', 18)" class="f">exp</span> <span class="o">-</span><span onmouseout="hideTip(event, 'fs14', 19)" onmouseover="showTip(event, 'fs14', 19)" class="i">x</span>)

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs16', 20)" onmouseover="showTip(event, 'fs16', 20)" class="f">runLayer</span> (<span onmouseout="hideTip(event, 'fs17', 21)" onmouseover="showTip(event, 'fs17', 21)" class="i">x</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs10', 22)" onmouseover="showTip(event, 'fs10', 22)" class="t">Vector</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs8', 23)" onmouseover="showTip(event, 'fs8', 23)" class="t">D</span><span class="o">&gt;</span>) (<span onmouseout="hideTip(event, 'fs18', 24)" onmouseover="showTip(event, 'fs18', 24)" class="i">l</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs5', 25)" onmouseover="showTip(event, 'fs5', 25)" class="t">Layer</span>) <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs18', 26)" onmouseover="showTip(event, 'fs18', 26)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs6', 27)" onmouseover="showTip(event, 'fs6', 27)" class="i">W</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs17', 28)" onmouseover="showTip(event, 'fs17', 28)" class="i">x</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs18', 29)" onmouseover="showTip(event, 'fs18', 29)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs9', 30)" onmouseover="showTip(event, 'fs9', 30)" class="i">b</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs10', 31)" onmouseover="showTip(event, 'fs10', 31)" class="t">Vector</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs19', 32)" onmouseover="showTip(event, 'fs19', 32)" class="f">map</span> <span onmouseout="hideTip(event, 'fs13', 33)" onmouseover="showTip(event, 'fs13', 33)" class="f">sigmoid</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs20', 34)" onmouseover="showTip(event, 'fs20', 34)" class="f">runNetwork</span> (<span onmouseout="hideTip(event, 'fs17', 35)" onmouseover="showTip(event, 'fs17', 35)" class="i">x</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs10', 36)" onmouseover="showTip(event, 'fs10', 36)" class="t">Vector</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs8', 37)" onmouseover="showTip(event, 'fs8', 37)" class="t">D</span><span class="o">&gt;</span>) (<span onmouseout="hideTip(event, 'fs21', 38)" onmouseover="showTip(event, 'fs21', 38)" class="i">n</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs11', 39)" onmouseover="showTip(event, 'fs11', 39)" class="t">Network</span>) <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs22', 40)" onmouseover="showTip(event, 'fs22', 40)" class="t">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs23', 41)" onmouseover="showTip(event, 'fs23', 41)" class="f">fold</span> <span onmouseout="hideTip(event, 'fs16', 42)" onmouseover="showTip(event, 'fs16', 42)" class="f">runLayer</span> <span onmouseout="hideTip(event, 'fs17', 43)" onmouseover="showTip(event, 'fs17', 43)" class="i">x</span> <span onmouseout="hideTip(event, 'fs21', 44)" onmouseover="showTip(event, 'fs21', 44)" class="i">n</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 45)" onmouseover="showTip(event, 'fs12', 45)" class="i">layers</span>


<span class="k">let</span> <span onmouseout="hideTip(event, 'fs24', 46)" onmouseover="showTip(event, 'fs24', 46)" class="i">rnd</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs25', 47)" onmouseover="showTip(event, 'fs25', 47)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs26', 48)" onmouseover="showTip(event, 'fs26', 48)" class="t">Random</span>()

<span class="c">// Initialize a fully connected feedforward neural network</span>
<span class="c">// Weights and biases between -0.5 and 0.5</span>
<span class="c">// l : number of inputs and number of neurons in each subsequent layer</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs27', 49)" onmouseover="showTip(event, 'fs27', 49)" class="f">createNetwork</span> (<span onmouseout="hideTip(event, 'fs28', 50)" onmouseover="showTip(event, 'fs28', 50)" class="i">l</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs29', 51)" onmouseover="showTip(event, 'fs29', 51)" class="t">int</span>[]) <span class="o">=</span>
    {<span class="i">layers</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs22', 52)" onmouseover="showTip(event, 'fs22', 52)" class="t">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs30', 53)" onmouseover="showTip(event, 'fs30', 53)" class="f">init</span> (<span onmouseout="hideTip(event, 'fs28', 54)" onmouseover="showTip(event, 'fs28', 54)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs31', 55)" onmouseover="showTip(event, 'fs31', 55)" class="i">Length</span> <span class="o">-</span> <span class="n">1</span>) (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs32', 56)" onmouseover="showTip(event, 'fs32', 56)" class="i">i</span> <span class="k">-&gt;</span>
        {<span onmouseout="hideTip(event, 'fs6', 57)" onmouseover="showTip(event, 'fs6', 57)" class="i">W</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs7', 58)" onmouseover="showTip(event, 'fs7', 58)" class="t">Matrix</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs33', 59)" onmouseover="showTip(event, 'fs33', 59)" class="f">init</span> <span onmouseout="hideTip(event, 'fs28', 60)" onmouseover="showTip(event, 'fs28', 60)" class="i">l</span><span class="o">.</span>[<span onmouseout="hideTip(event, 'fs32', 61)" onmouseover="showTip(event, 'fs32', 61)" class="i">i</span> <span class="o">+</span> <span class="n">1</span>] <span onmouseout="hideTip(event, 'fs28', 62)" onmouseover="showTip(event, 'fs28', 62)" class="i">l</span><span class="o">.</span>[<span onmouseout="hideTip(event, 'fs32', 63)" onmouseover="showTip(event, 'fs32', 63)" class="i">i</span>] (<span class="k">fun</span> _ _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs34', 64)" onmouseover="showTip(event, 'fs34', 64)" class="p">D</span> (<span class="o">-</span><span class="n">0.5</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs24', 65)" onmouseover="showTip(event, 'fs24', 65)" class="i">rnd</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs35', 66)" onmouseover="showTip(event, 'fs35', 66)" class="f">NextDouble</span>()))
         <span onmouseout="hideTip(event, 'fs9', 67)" onmouseover="showTip(event, 'fs9', 67)" class="i">b</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs10', 68)" onmouseover="showTip(event, 'fs10', 68)" class="t">Vector</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs36', 69)" onmouseover="showTip(event, 'fs36', 69)" class="f">init</span> <span onmouseout="hideTip(event, 'fs28', 70)" onmouseover="showTip(event, 'fs28', 70)" class="i">l</span><span class="o">.</span>[<span onmouseout="hideTip(event, 'fs32', 71)" onmouseover="showTip(event, 'fs32', 71)" class="i">i</span> <span class="o">+</span> <span class="n">1</span>] (<span class="k">fun</span> _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs34', 72)" onmouseover="showTip(event, 'fs34', 72)" class="p">D</span> (<span class="o">-</span><span class="n">0.5</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs24', 73)" onmouseover="showTip(event, 'fs24', 73)" class="i">rnd</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs35', 74)" onmouseover="showTip(event, 'fs35', 74)" class="f">NextDouble</span>()))})}
</pre>
</td>
</tr>
</table>

<p>This gives us a highly scalable feedforward network architecture capable of expressing any number of inputs, outputs, and hidden layers. The network is fully connected, meaning that each neuron in a layer receives the outputs of all the neurons in the previous layer as its input.</p>

<p>For example, using the code</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs37', 75)" onmouseover="showTip(event, 'fs37', 75)" class="i">net1</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs27', 76)" onmouseover="showTip(event, 'fs27', 76)" class="f">createNetwork</span> [|<span class="n">3</span>; <span class="n">4</span>; <span class="n">2</span>|]
</pre>
</td>
</tr>
</table>

<p>would give us the following network with 3 input nodes, a hidden layer with 4 neurons, and an output layer with 2 neurons:</p>

<div class="row">
    <div class="span6 offset2">
        <img src="img/examples-neuralnetworks-network.png" alt="Chart" style="width:400px;"/>
    </div>
</div>

<p>We can also have more than one hidden layer.</p>

<p>For training networks, we will make use of reverse mode AD for propagating the error at the output <span class="math">\(E\)</span> backwards through the network synapse weights. This will give us the partial derivative of the error at the output with respect to each weight <span class="math">\(w_i\)</span> and bias <span class="math">\(b_i\)</span> in the network, which we will then use in an update rule</p>

<p><span class="math">\[ \begin{eqnarray*}
 \Delta w_i &amp;=&amp; -\eta \frac{\partial E}{\partial w_i} \; ,\\
 \Delta b_i &amp;=&amp; -\eta \frac{\partial E}{\partial b_i} \; ,\\
 \end{eqnarray*}\]</span></p>

<p>where <span class="math">\(\eta\)</span> is the learning rate.</p>

<p>It is important to note that the backpropagation algorithm is just a special case of reverse mode AD, with which it shares a common history. Please see the <a href="gettingstarted-nestedad.html">Nested AD</a> page for an explanation of the usage of adjoints and their backwards propagation.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// The backpropagation algorithm</span>
<span class="c">// n: network to be trained</span>
<span class="c">// eta: learning rate</span>
<span class="c">// epsilon: error threshold</span>
<span class="c">// timeout: maximum number of iterations</span>
<span class="c">// t: training set consisting of input and output vectors</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs38', 77)" onmouseover="showTip(event, 'fs38', 77)" class="f">backprop</span> (<span onmouseout="hideTip(event, 'fs21', 78)" onmouseover="showTip(event, 'fs21', 78)" class="i">n</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs11', 79)" onmouseover="showTip(event, 'fs11', 79)" class="t">Network</span>) <span onmouseout="hideTip(event, 'fs39', 80)" onmouseover="showTip(event, 'fs39', 80)" class="i">eta</span> <span onmouseout="hideTip(event, 'fs40', 81)" onmouseover="showTip(event, 'fs40', 81)" class="i">epsilon</span> <span onmouseout="hideTip(event, 'fs41', 82)" onmouseover="showTip(event, 'fs41', 82)" class="i">timeout</span> (<span onmouseout="hideTip(event, 'fs42', 83)" onmouseover="showTip(event, 'fs42', 83)" class="i">t</span><span class="o">:</span>(<span onmouseout="hideTip(event, 'fs10', 84)" onmouseover="showTip(event, 'fs10', 84)" class="t">Vector</span><span class="o">&lt;</span>_<span class="o">&gt;</span><span class="o">*</span><span onmouseout="hideTip(event, 'fs10', 85)" onmouseover="showTip(event, 'fs10', 85)" class="t">Vector</span><span class="o">&lt;</span>_<span class="o">&gt;</span>)[]) <span class="o">=</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs43', 86)" onmouseover="showTip(event, 'fs43', 86)" class="i">i</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs1', 87)" onmouseover="showTip(event, 'fs1', 87)" class="i">DiffSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs44', 88)" onmouseover="showTip(event, 'fs44', 88)" class="t">Util</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs45', 89)" onmouseover="showTip(event, 'fs45', 89)" class="t">GlobalTagger</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs46', 90)" onmouseover="showTip(event, 'fs46', 90)" class="i">Next</span>
    <span onmouseout="hideTip(event, 'fs47', 91)" onmouseover="showTip(event, 'fs47', 91)" class="i">seq</span> {<span class="k">for</span> <span onmouseout="hideTip(event, 'fs48', 92)" onmouseover="showTip(event, 'fs48', 92)" class="i">j</span> <span class="k">in</span> <span class="n">0</span> <span class="o">..</span> <span onmouseout="hideTip(event, 'fs41', 93)" onmouseover="showTip(event, 'fs41', 93)" class="i">timeout</span> <span class="k">do</span>
            <span class="k">for</span> <span onmouseout="hideTip(event, 'fs18', 94)" onmouseover="showTip(event, 'fs18', 94)" class="i">l</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs21', 95)" onmouseover="showTip(event, 'fs21', 95)" class="i">n</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 96)" onmouseover="showTip(event, 'fs12', 96)" class="i">layers</span> <span class="k">do</span>
                <span onmouseout="hideTip(event, 'fs18', 97)" onmouseover="showTip(event, 'fs18', 97)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs6', 98)" onmouseover="showTip(event, 'fs6', 98)" class="i">W</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs7', 99)" onmouseover="showTip(event, 'fs7', 99)" class="t">Matrix</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs49', 100)" onmouseover="showTip(event, 'fs49', 100)" class="f">replace</span> (<span onmouseout="hideTip(event, 'fs50', 101)" onmouseover="showTip(event, 'fs50', 101)" class="f">makeDR</span> <span onmouseout="hideTip(event, 'fs43', 102)" onmouseover="showTip(event, 'fs43', 102)" class="i">i</span>)
                <span onmouseout="hideTip(event, 'fs18', 103)" onmouseover="showTip(event, 'fs18', 103)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs9', 104)" onmouseover="showTip(event, 'fs9', 104)" class="i">b</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs10', 105)" onmouseover="showTip(event, 'fs10', 105)" class="t">Vector</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs51', 106)" onmouseover="showTip(event, 'fs51', 106)" class="f">replace</span> (<span onmouseout="hideTip(event, 'fs50', 107)" onmouseover="showTip(event, 'fs50', 107)" class="f">makeDR</span> <span onmouseout="hideTip(event, 'fs43', 108)" onmouseover="showTip(event, 'fs43', 108)" class="i">i</span>) 

            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs52', 109)" onmouseover="showTip(event, 'fs52', 109)" class="i">error</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs42', 110)" onmouseover="showTip(event, 'fs42', 110)" class="i">t</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs22', 111)" onmouseover="showTip(event, 'fs22', 111)" class="t">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs53', 112)" onmouseover="showTip(event, 'fs53', 112)" class="f">sumBy</span> (<span class="k">fun</span> (<span onmouseout="hideTip(event, 'fs17', 113)" onmouseover="showTip(event, 'fs17', 113)" class="i">x</span>, <span onmouseout="hideTip(event, 'fs54', 114)" onmouseover="showTip(event, 'fs54', 114)" class="i">y</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs10', 115)" onmouseover="showTip(event, 'fs10', 115)" class="t">Vector</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs55', 116)" onmouseover="showTip(event, 'fs55', 116)" class="f">normSq</span> (<span onmouseout="hideTip(event, 'fs54', 117)" onmouseover="showTip(event, 'fs54', 117)" class="i">y</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs20', 118)" onmouseover="showTip(event, 'fs20', 118)" class="f">runNetwork</span> <span onmouseout="hideTip(event, 'fs17', 119)" onmouseover="showTip(event, 'fs17', 119)" class="i">x</span> <span onmouseout="hideTip(event, 'fs21', 120)" onmouseover="showTip(event, 'fs21', 120)" class="i">n</span>))
            <span onmouseout="hideTip(event, 'fs52', 121)" onmouseover="showTip(event, 'fs52', 121)" class="i">error</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs56', 122)" onmouseover="showTip(event, 'fs56', 122)" class="f">reverseProp</span> (<span onmouseout="hideTip(event, 'fs34', 123)" onmouseover="showTip(event, 'fs34', 123)" class="p">D</span> <span class="n">1.</span>) <span class="c">// Propagate adjoint value 1 backward</span>

            <span class="k">for</span> <span onmouseout="hideTip(event, 'fs18', 124)" onmouseover="showTip(event, 'fs18', 124)" class="i">l</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs21', 125)" onmouseover="showTip(event, 'fs21', 125)" class="i">n</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 126)" onmouseover="showTip(event, 'fs12', 126)" class="i">layers</span> <span class="k">do</span>
                <span onmouseout="hideTip(event, 'fs18', 127)" onmouseover="showTip(event, 'fs18', 127)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs6', 128)" onmouseover="showTip(event, 'fs6', 128)" class="i">W</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs7', 129)" onmouseover="showTip(event, 'fs7', 129)" class="t">Matrix</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs49', 130)" onmouseover="showTip(event, 'fs49', 130)" class="f">replace</span> (<span class="k">fun</span> (<span onmouseout="hideTip(event, 'fs14', 131)" onmouseover="showTip(event, 'fs14', 131)" class="i">x</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs8', 132)" onmouseover="showTip(event, 'fs8', 132)" class="t">D</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs14', 133)" onmouseover="showTip(event, 'fs14', 133)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs57', 134)" onmouseover="showTip(event, 'fs57', 134)" class="i">P</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs39', 135)" onmouseover="showTip(event, 'fs39', 135)" class="i">eta</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs14', 136)" onmouseover="showTip(event, 'fs14', 136)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs58', 137)" onmouseover="showTip(event, 'fs58', 137)" class="i">A</span>)
                <span onmouseout="hideTip(event, 'fs18', 138)" onmouseover="showTip(event, 'fs18', 138)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs9', 139)" onmouseover="showTip(event, 'fs9', 139)" class="i">b</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs10', 140)" onmouseover="showTip(event, 'fs10', 140)" class="t">Vector</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs51', 141)" onmouseover="showTip(event, 'fs51', 141)" class="f">replace</span> (<span class="k">fun</span> (<span onmouseout="hideTip(event, 'fs14', 142)" onmouseover="showTip(event, 'fs14', 142)" class="i">x</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs8', 143)" onmouseover="showTip(event, 'fs8', 143)" class="t">D</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs14', 144)" onmouseover="showTip(event, 'fs14', 144)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs57', 145)" onmouseover="showTip(event, 'fs57', 145)" class="i">P</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs39', 146)" onmouseover="showTip(event, 'fs39', 146)" class="i">eta</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs14', 147)" onmouseover="showTip(event, 'fs14', 147)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs58', 148)" onmouseover="showTip(event, 'fs58', 148)" class="i">A</span>)

            <span class="k">if</span> <span onmouseout="hideTip(event, 'fs48', 149)" onmouseover="showTip(event, 'fs48', 149)" class="i">j</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs41', 150)" onmouseover="showTip(event, 'fs41', 150)" class="i">timeout</span> <span class="k">then</span> <span onmouseout="hideTip(event, 'fs59', 151)" onmouseover="showTip(event, 'fs59', 151)" class="f">printfn</span> <span class="s">&quot;Failed to converge within </span><span class="pf">%i</span><span class="s"> steps.&quot;</span> <span onmouseout="hideTip(event, 'fs41', 152)" onmouseover="showTip(event, 'fs41', 152)" class="i">timeout</span>
            <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs60', 153)" onmouseover="showTip(event, 'fs60', 153)" class="f">float</span> <span onmouseout="hideTip(event, 'fs52', 154)" onmouseover="showTip(event, 'fs52', 154)" class="i">error</span>}
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs61', 155)" onmouseover="showTip(event, 'fs61', 155)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs62', 156)" onmouseover="showTip(event, 'fs62', 156)" class="f">takeWhile</span> ((<span class="o">&lt;</span>) <span onmouseout="hideTip(event, 'fs40', 157)" onmouseover="showTip(event, 'fs40', 157)" class="i">epsilon</span>)
</pre>
</td>
</tr>
</table>

<p>Using reverse mode AD here has two big advantages: it makes the backpropagation code succinct and straightforward to write and maintain; and it allows us to freely choose activation functions without the burden of coding their derivatives or modifying the backpropagation code accordingly.</p>

<p>We can now test the algorithm by training some networks.</p>

<p>It is known that <a href="https://en.wikipedia.org/wiki/Linear_separability">linearly separable</a> rules such as <a href="https://en.wikipedia.org/wiki/Logical_disjunction">logical disjunction</a> can be learned by a single neuron.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs63', 158)" onmouseover="showTip(event, 'fs63', 158)" class="i">FSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs64', 159)" onmouseover="showTip(event, 'fs64', 159)" class="i">Charting</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs65', 160)" onmouseover="showTip(event, 'fs65', 160)" class="i">trainOR</span> <span class="o">=</span> [|<span onmouseout="hideTip(event, 'fs66', 161)" onmouseover="showTip(event, 'fs66', 161)" class="f">vector</span> [<span onmouseout="hideTip(event, 'fs34', 162)" onmouseover="showTip(event, 'fs34', 162)" class="p">D</span> <span class="n">0.</span>; <span onmouseout="hideTip(event, 'fs34', 163)" onmouseover="showTip(event, 'fs34', 163)" class="p">D</span> <span class="n">0.</span>], <span onmouseout="hideTip(event, 'fs66', 164)" onmouseover="showTip(event, 'fs66', 164)" class="f">vector</span> [<span onmouseout="hideTip(event, 'fs34', 165)" onmouseover="showTip(event, 'fs34', 165)" class="p">D</span> <span class="n">0.</span>]
                <span onmouseout="hideTip(event, 'fs66', 166)" onmouseover="showTip(event, 'fs66', 166)" class="f">vector</span> [<span onmouseout="hideTip(event, 'fs34', 167)" onmouseover="showTip(event, 'fs34', 167)" class="p">D</span> <span class="n">0.</span>; <span onmouseout="hideTip(event, 'fs34', 168)" onmouseover="showTip(event, 'fs34', 168)" class="p">D</span> <span class="n">1.</span>], <span onmouseout="hideTip(event, 'fs66', 169)" onmouseover="showTip(event, 'fs66', 169)" class="f">vector</span> [<span onmouseout="hideTip(event, 'fs34', 170)" onmouseover="showTip(event, 'fs34', 170)" class="p">D</span> <span class="n">1.</span>]
                <span onmouseout="hideTip(event, 'fs66', 171)" onmouseover="showTip(event, 'fs66', 171)" class="f">vector</span> [<span onmouseout="hideTip(event, 'fs34', 172)" onmouseover="showTip(event, 'fs34', 172)" class="p">D</span> <span class="n">1.</span>; <span onmouseout="hideTip(event, 'fs34', 173)" onmouseover="showTip(event, 'fs34', 173)" class="p">D</span> <span class="n">0.</span>], <span onmouseout="hideTip(event, 'fs66', 174)" onmouseover="showTip(event, 'fs66', 174)" class="f">vector</span> [<span onmouseout="hideTip(event, 'fs34', 175)" onmouseover="showTip(event, 'fs34', 175)" class="p">D</span> <span class="n">1.</span>]
                <span onmouseout="hideTip(event, 'fs66', 176)" onmouseover="showTip(event, 'fs66', 176)" class="f">vector</span> [<span onmouseout="hideTip(event, 'fs34', 177)" onmouseover="showTip(event, 'fs34', 177)" class="p">D</span> <span class="n">1.</span>; <span onmouseout="hideTip(event, 'fs34', 178)" onmouseover="showTip(event, 'fs34', 178)" class="p">D</span> <span class="n">1.</span>], <span onmouseout="hideTip(event, 'fs66', 179)" onmouseover="showTip(event, 'fs66', 179)" class="f">vector</span> [<span onmouseout="hideTip(event, 'fs34', 180)" onmouseover="showTip(event, 'fs34', 180)" class="p">D</span> <span class="n">1.</span>]|]

<span class="c">// 2 inputs, one layer with one neuron</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs67', 181)" onmouseover="showTip(event, 'fs67', 181)" class="i">net2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs27', 182)" onmouseover="showTip(event, 'fs27', 182)" class="f">createNetwork</span> [|<span class="n">2</span>; <span class="n">1</span>|]

<span class="c">// Train</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs68', 183)" onmouseover="showTip(event, 'fs68', 183)" class="i">train2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs38', 184)" onmouseover="showTip(event, 'fs38', 184)" class="f">backprop</span> <span onmouseout="hideTip(event, 'fs67', 185)" onmouseover="showTip(event, 'fs67', 185)" class="i">net2</span> <span class="n">0.9</span> <span class="n">0.005</span> <span class="n">10000</span> <span onmouseout="hideTip(event, 'fs65', 186)" onmouseover="showTip(event, 'fs65', 186)" class="i">trainOR</span>

<span class="c">// Plot the error during training</span>
<span onmouseout="hideTip(event, 'fs69', 187)" onmouseover="showTip(event, 'fs69', 187)" class="t">Chart</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs70', 188)" onmouseover="showTip(event, 'fs70', 188)" class="f">Line</span> <span onmouseout="hideTip(event, 'fs68', 189)" onmouseover="showTip(event, 'fs68', 189)" class="i">train2</span>
</pre>
</td>
</tr>
</table>

<table class="pre"><tr><td><pre><code>val net2 : Network =
  {l = [|{n = [|{w = Vector [|D -0.3042126283; D -0.2509630955|];
                 b = D 0.4165584179;}|];}|];}
val train2 : seq&lt;float&gt;</code></pre></td></tr></table>

<div class="row">
    <div class="span6 offset1">
        <img src="img/examples-neuralnetworks-chart1.png" alt="Chart" style="width:550px"/>
    </div>
</div>

<p>Linearly inseparable problems such as <a href="https://en.wikipedia.org/wiki/Exclusive_or">exclusive or</a> require one or more hidden layers to learn.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs72', 191)" onmouseover="showTip(event, 'fs72', 191)" class="i">trainXOR</span> <span class="o">=</span> [|<span onmouseout="hideTip(event, 'fs66', 192)" onmouseover="showTip(event, 'fs66', 192)" class="f">vector</span> [<span onmouseout="hideTip(event, 'fs34', 193)" onmouseover="showTip(event, 'fs34', 193)" class="p">D</span> <span class="n">0.</span>; <span onmouseout="hideTip(event, 'fs34', 194)" onmouseover="showTip(event, 'fs34', 194)" class="p">D</span> <span class="n">0.</span>], <span onmouseout="hideTip(event, 'fs66', 195)" onmouseover="showTip(event, 'fs66', 195)" class="f">vector</span> [<span onmouseout="hideTip(event, 'fs34', 196)" onmouseover="showTip(event, 'fs34', 196)" class="p">D</span> <span class="n">0.</span>]
                 <span onmouseout="hideTip(event, 'fs66', 197)" onmouseover="showTip(event, 'fs66', 197)" class="f">vector</span> [<span onmouseout="hideTip(event, 'fs34', 198)" onmouseover="showTip(event, 'fs34', 198)" class="p">D</span> <span class="n">0.</span>; <span onmouseout="hideTip(event, 'fs34', 199)" onmouseover="showTip(event, 'fs34', 199)" class="p">D</span> <span class="n">1.</span>], <span onmouseout="hideTip(event, 'fs66', 200)" onmouseover="showTip(event, 'fs66', 200)" class="f">vector</span> [<span onmouseout="hideTip(event, 'fs34', 201)" onmouseover="showTip(event, 'fs34', 201)" class="p">D</span> <span class="n">1.</span>]
                 <span onmouseout="hideTip(event, 'fs66', 202)" onmouseover="showTip(event, 'fs66', 202)" class="f">vector</span> [<span onmouseout="hideTip(event, 'fs34', 203)" onmouseover="showTip(event, 'fs34', 203)" class="p">D</span> <span class="n">1.</span>; <span onmouseout="hideTip(event, 'fs34', 204)" onmouseover="showTip(event, 'fs34', 204)" class="p">D</span> <span class="n">0.</span>], <span onmouseout="hideTip(event, 'fs66', 205)" onmouseover="showTip(event, 'fs66', 205)" class="f">vector</span> [<span onmouseout="hideTip(event, 'fs34', 206)" onmouseover="showTip(event, 'fs34', 206)" class="p">D</span> <span class="n">1.</span>]
                 <span onmouseout="hideTip(event, 'fs66', 207)" onmouseover="showTip(event, 'fs66', 207)" class="f">vector</span> [<span onmouseout="hideTip(event, 'fs34', 208)" onmouseover="showTip(event, 'fs34', 208)" class="p">D</span> <span class="n">1.</span>; <span onmouseout="hideTip(event, 'fs34', 209)" onmouseover="showTip(event, 'fs34', 209)" class="p">D</span> <span class="n">1.</span>], <span onmouseout="hideTip(event, 'fs66', 210)" onmouseover="showTip(event, 'fs66', 210)" class="f">vector</span> [<span onmouseout="hideTip(event, 'fs34', 211)" onmouseover="showTip(event, 'fs34', 211)" class="p">D</span> <span class="n">0.</span>]|]

<span class="c">// 2 inputs, 3 neurons in a hidden layer, 1 neuron in the output layer</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs73', 212)" onmouseover="showTip(event, 'fs73', 212)" class="i">net3</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs27', 213)" onmouseover="showTip(event, 'fs27', 213)" class="f">createNetwork</span> [|<span class="n">2</span>; <span class="n">3</span>; <span class="n">1</span>|]

<span class="c">// Train</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs74', 214)" onmouseover="showTip(event, 'fs74', 214)" class="i">train3</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs38', 215)" onmouseover="showTip(event, 'fs38', 215)" class="f">backprop</span> <span onmouseout="hideTip(event, 'fs73', 216)" onmouseover="showTip(event, 'fs73', 216)" class="i">net3</span> <span class="n">0.9</span> <span class="n">0.005</span> <span class="n">10000</span> <span onmouseout="hideTip(event, 'fs72', 217)" onmouseover="showTip(event, 'fs72', 217)" class="i">trainXOR</span>

<span class="c">// Plot the error during training</span>
<span onmouseout="hideTip(event, 'fs69', 218)" onmouseover="showTip(event, 'fs69', 218)" class="t">Chart</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs70', 219)" onmouseover="showTip(event, 'fs70', 219)" class="f">Line</span> <span onmouseout="hideTip(event, 'fs74', 220)" onmouseover="showTip(event, 'fs74', 220)" class="i">train3</span>
</pre>
</td>
</tr>
</table>

<table class="pre"><tr><td><pre><code>val net3 : Network =
  {layers =
    [|{W = Matrix [[D 0.3691323418; D -0.4268625504]
                   [D 0.2538574085; D 0.4656410399]
                   [D 0.3023036475; D -0.09005093509]];
       b = Vector [|D -0.1326141556; D 0.1238703284; D 0.461187453|];};
      {W = Matrix [[D 0.1193747351; D 0.4290782972; D -0.1465413457]];
       b = Vector [|D -0.4840164538|];}|];}
val train3 : seq&lt;float&gt;</code></pre></td></tr></table>

<div class="row">
    <div class="span6 offset1">
        <img src="img/examples-neuralnetworks-chart2.png" alt="Chart" style="width:550px"/>
    </div>
</div>

          <div class="tip" id="fs1">namespace DiffSharp</div>
<div class="tip" id="fs2">namespace DiffSharp.AD</div>
<div class="tip" id="fs3">namespace FsAlg</div>
<div class="tip" id="fs4">namespace FsAlg.Generic</div>
<div class="tip" id="fs5">type Layer =<br />&#160;&#160;{W: Matrix&lt;D&gt;;<br />&#160;&#160;&#160;b: Vector&lt;D&gt;;}<br /><br />Full name: Examples-neuralnetworks.Layer</div>
<div class="tip" id="fs6">Layer.W: Matrix&lt;D&gt;</div>
<div class="tip" id="fs7">Multiple items<br />union case Matrix.Matrix: &#39;T [,] -&gt; Matrix&lt;&#39;T&gt;<br /><br />--------------------<br />module Matrix<br /><br />from FsAlg.Generic<br /><br />--------------------<br />type Matrix&lt;&#39;T (requires member get_Zero and member get_One and member ( + ) and member ( - ) and member ( * ) and member ( / ) and member ( ~- ) and member Abs and member Pow and member Sqrt and member op_Explicit and comparison)&gt; =<br />&#160;&#160;| ZeroMatrix of &#39;T<br />&#160;&#160;| Matrix of &#39;T [,]<br />&#160;&#160;member Copy : unit -&gt; Matrix&lt;&#39;T&gt;<br />&#160;&#160;member GetDeterminant : unit -&gt; &#39;T<br />&#160;&#160;member GetDiagonal : unit -&gt; &#39;T []<br />&#160;&#160;member GetEigenvalues : unit -&gt; &#39;T []<br />&#160;&#160;member GetEnumerator : unit -&gt; IEnumerator&lt;&#39;T&gt;<br />&#160;&#160;member GetInverse : unit -&gt; Matrix&lt;&#39;T&gt;<br />&#160;&#160;member GetLUDecomposition : unit -&gt; Matrix&lt;&#39;T&gt; * int [] * &#39;T<br />&#160;&#160;member GetQRDecomposition : unit -&gt; Matrix&lt;&#39;T&gt; * Matrix&lt;&#39;T&gt;<br />&#160;&#160;member GetSlice : rowStart:int option * rowFinish:int option * col:int -&gt; Vector&lt;&#39;T&gt;<br />&#160;&#160;member GetSlice : row:int * colStart:int option * colFinish:int option -&gt; Vector&lt;&#39;T&gt;<br />&#160;&#160;member GetSlice : rowStart:int option * rowFinish:int option * colStart:int option * colFinish:int option -&gt; Matrix&lt;&#39;T&gt;<br />&#160;&#160;member GetTrace : unit -&gt; &#39;T<br />&#160;&#160;member GetTranspose : unit -&gt; Matrix&lt;&#39;T&gt;<br />&#160;&#160;member ToArray : unit -&gt; &#39;T [] []<br />&#160;&#160;member ToArray2D : unit -&gt; &#39;T [,]<br />&#160;&#160;member ToMathematicaString : unit -&gt; string<br />&#160;&#160;member ToMatlabString : unit -&gt; string<br />&#160;&#160;member ToSeq : unit -&gt; seq&lt;&#39;T&gt;<br />&#160;&#160;member Cols : int<br />&#160;&#160;member Item : i:int * j:int -&gt; &#39;T with get<br />&#160;&#160;member Rows : int<br />&#160;&#160;member Item : i:int * j:int -&gt; &#39;T with set<br />&#160;&#160;static member Zero : Matrix&lt;&#39;T&gt;<br />&#160;&#160;static member ( + ) : a:&#39;T * b:Matrix&lt;&#39;T&gt; -&gt; Matrix&lt;&#39;T&gt;<br />&#160;&#160;static member ( + ) : a:Matrix&lt;&#39;T&gt; * b:&#39;T -&gt; Matrix&lt;&#39;T&gt;<br />&#160;&#160;static member ( + ) : a:Matrix&lt;&#39;T&gt; * b:Matrix&lt;&#39;T&gt; -&gt; Matrix&lt;&#39;T&gt;<br />&#160;&#160;static member ( / ) : a:&#39;T * b:Matrix&lt;&#39;T&gt; -&gt; Matrix&lt;&#39;T&gt;<br />&#160;&#160;static member ( / ) : a:Matrix&lt;&#39;T&gt; * b:&#39;T -&gt; Matrix&lt;&#39;T&gt;<br />&#160;&#160;static member ( ./ ) : a:Matrix&lt;&#39;T&gt; * b:Matrix&lt;&#39;T&gt; -&gt; Matrix&lt;&#39;T&gt;<br />&#160;&#160;static member ( .* ) : a:Matrix&lt;&#39;T&gt; * b:Matrix&lt;&#39;T&gt; -&gt; Matrix&lt;&#39;T&gt;<br />&#160;&#160;static member op_Explicit : m:Matrix&lt;&#39;T&gt; -&gt; float [,]<br />&#160;&#160;static member ( * ) : a:&#39;T * b:Matrix&lt;&#39;T&gt; -&gt; Matrix&lt;&#39;T&gt;<br />&#160;&#160;static member ( * ) : a:Matrix&lt;&#39;T&gt; * b:&#39;T -&gt; Matrix&lt;&#39;T&gt;<br />&#160;&#160;static member ( * ) : a:Vector&lt;&#39;T&gt; * b:Matrix&lt;&#39;T&gt; -&gt; Vector&lt;&#39;T&gt;<br />&#160;&#160;static member ( * ) : a:Matrix&lt;&#39;T&gt; * b:Vector&lt;&#39;T&gt; -&gt; Vector&lt;&#39;T&gt;<br />&#160;&#160;static member ( * ) : a:Matrix&lt;&#39;T&gt; * b:Matrix&lt;&#39;T&gt; -&gt; Matrix&lt;&#39;T&gt;<br />&#160;&#160;static member ( - ) : a:&#39;T * b:Matrix&lt;&#39;T&gt; -&gt; Matrix&lt;&#39;T&gt;<br />&#160;&#160;static member ( - ) : a:Matrix&lt;&#39;T&gt; * b:&#39;T -&gt; Matrix&lt;&#39;T&gt;<br />&#160;&#160;static member ( - ) : a:Matrix&lt;&#39;T&gt; * b:Matrix&lt;&#39;T&gt; -&gt; Matrix&lt;&#39;T&gt;<br />&#160;&#160;static member ( ~- ) : a:Matrix&lt;&#39;T&gt; -&gt; Matrix&lt;&#39;T&gt;<br /><br />Full name: FsAlg.Generic.Matrix&lt;_&gt;</div>
<div class="tip" id="fs8">type D =<br />&#160;&#160;| D of float<br />&#160;&#160;| DF of D * D * uint32<br />&#160;&#160;| DR of D * D ref * TraceOp * uint32 ref * uint32<br />&#160;&#160;interface IComparable<br />&#160;&#160;override Equals : other:obj -&gt; bool<br />&#160;&#160;override GetHashCode : unit -&gt; int<br />&#160;&#160;member A : D<br />&#160;&#160;member F : uint32<br />&#160;&#160;member P : D<br />&#160;&#160;member T : D<br />&#160;&#160;member A : D with set<br />&#160;&#160;member F : uint32 with set<br />&#160;&#160;static member Abs : a:D -&gt; D<br />&#160;&#160;static member Acos : a:D -&gt; D<br />&#160;&#160;static member Asin : a:D -&gt; D<br />&#160;&#160;static member Atan : a:D -&gt; D<br />&#160;&#160;static member Atan2 : a:int * b:D -&gt; D<br />&#160;&#160;static member Atan2 : a:D * b:int -&gt; D<br />&#160;&#160;static member Atan2 : a:float * b:D -&gt; D<br />&#160;&#160;static member Atan2 : a:D * b:float -&gt; D<br />&#160;&#160;static member Atan2 : a:D * b:D -&gt; D<br />&#160;&#160;static member Ceiling : a:D -&gt; D<br />&#160;&#160;static member Cos : a:D -&gt; D<br />&#160;&#160;static member Cosh : a:D -&gt; D<br />&#160;&#160;static member DivideByInt : d:D * i:int -&gt; D<br />&#160;&#160;static member Exp : a:D -&gt; D<br />&#160;&#160;static member Floor : a:D -&gt; D<br />&#160;&#160;static member Log : a:D -&gt; D<br />&#160;&#160;static member Log10 : a:D -&gt; D<br />&#160;&#160;static member Pow : a:int * b:D -&gt; D<br />&#160;&#160;static member Pow : a:D * b:int -&gt; D<br />&#160;&#160;static member Pow : a:float * b:D -&gt; D<br />&#160;&#160;static member Pow : a:D * b:float -&gt; D<br />&#160;&#160;static member Pow : a:D * b:D -&gt; D<br />&#160;&#160;static member Round : a:D -&gt; D<br />&#160;&#160;static member Sin : a:D -&gt; D<br />&#160;&#160;static member Sinh : a:D -&gt; D<br />&#160;&#160;static member Sqrt : a:D -&gt; D<br />&#160;&#160;static member Tan : a:D -&gt; D<br />&#160;&#160;static member Tanh : a:D -&gt; D<br />&#160;&#160;static member One : D<br />&#160;&#160;static member Zero : D<br />&#160;&#160;static member ( + ) : a:int * b:D -&gt; D<br />&#160;&#160;static member ( + ) : a:D * b:int -&gt; D<br />&#160;&#160;static member ( + ) : a:float * b:D -&gt; D<br />&#160;&#160;static member ( + ) : a:D * b:float -&gt; D<br />&#160;&#160;static member ( + ) : a:D * b:D -&gt; D<br />&#160;&#160;static member ( / ) : a:int * b:D -&gt; D<br />&#160;&#160;static member ( / ) : a:D * b:int -&gt; D<br />&#160;&#160;static member ( / ) : a:float * b:D -&gt; D<br />&#160;&#160;static member ( / ) : a:D * b:float -&gt; D<br />&#160;&#160;static member ( / ) : a:D * b:D -&gt; D<br />&#160;&#160;static member op_Explicit : d:D -&gt; int<br />&#160;&#160;static member op_Explicit : d:D -&gt; float<br />&#160;&#160;static member ( * ) : a:int * b:D -&gt; D<br />&#160;&#160;static member ( * ) : a:D * b:int -&gt; D<br />&#160;&#160;static member ( * ) : a:float * b:D -&gt; D<br />&#160;&#160;static member ( * ) : a:D * b:float -&gt; D<br />&#160;&#160;static member ( * ) : a:D * b:D -&gt; D<br />&#160;&#160;static member ( - ) : a:int * b:D -&gt; D<br />&#160;&#160;static member ( - ) : a:D * b:int -&gt; D<br />&#160;&#160;static member ( - ) : a:float * b:D -&gt; D<br />&#160;&#160;static member ( - ) : a:D * b:float -&gt; D<br />&#160;&#160;static member ( - ) : a:D * b:D -&gt; D<br />&#160;&#160;static member ( ~- ) : a:D -&gt; D<br /><br />Full name: DiffSharp.AD.D</div>
<div class="tip" id="fs9">Layer.b: Vector&lt;D&gt;</div>
<div class="tip" id="fs10">Multiple items<br />union case Vector.Vector: &#39;T [] -&gt; Vector&lt;&#39;T&gt;<br /><br />--------------------<br />module Vector<br /><br />from FsAlg.Generic<br /><br />--------------------<br />module Vector<br /><br />from DiffSharp.AD<br /><br />--------------------<br />type Vector&lt;&#39;T (requires member get_Zero and member get_One and member ( + ) and member ( - ) and member ( * ) and member ( / ) and member ( ~- ) and member Abs and member Pow and member Sqrt and member op_Explicit and comparison)&gt; =<br />&#160;&#160;| ZeroVector of &#39;T<br />&#160;&#160;| Vector of &#39;T []<br />&#160;&#160;member Convert : f:(&#39;T -&gt; &#39;a) -&gt; Vector&lt;&#39;a&gt; (requires member get_Zero and member get_One and member ( + ) and member ( - ) and member ( * ) and member ( / ) and member ( ~- ) and member Abs and member Pow and member Sqrt and member op_Explicit and comparison)<br />&#160;&#160;member Copy : unit -&gt; Vector&lt;&#39;T&gt;<br />&#160;&#160;member GetEnumerator : unit -&gt; IEnumerator&lt;&#39;T&gt;<br />&#160;&#160;member GetL1Norm : unit -&gt; &#39;T<br />&#160;&#160;member GetL2Norm : unit -&gt; &#39;T<br />&#160;&#160;member GetL2NormSq : unit -&gt; &#39;T<br />&#160;&#160;member GetLPNorm : p:&#39;T -&gt; &#39;T<br />&#160;&#160;member GetMax : unit -&gt; &#39;T<br />&#160;&#160;member GetMaxBy : f:(&#39;T -&gt; &#39;a1) -&gt; &#39;T (requires comparison)<br />&#160;&#160;member GetMin : unit -&gt; &#39;T<br />&#160;&#160;member GetMinBy : f:(&#39;T -&gt; &#39;a1) -&gt; &#39;T (requires comparison)<br />&#160;&#160;member GetSlice : lower:int option * upper:int option -&gt; Vector&lt;&#39;T&gt;<br />&#160;&#160;member GetSubVector : s:int * c:int -&gt; Vector&lt;&#39;T&gt;<br />&#160;&#160;member GetUnitVector : unit -&gt; Vector&lt;&#39;T&gt;<br />&#160;&#160;member Split : n:seq&lt;int&gt; -&gt; seq&lt;Vector&lt;&#39;T&gt;&gt;<br />&#160;&#160;member SplitEqual : n:int -&gt; seq&lt;Vector&lt;&#39;T&gt;&gt;<br />&#160;&#160;member ToArray : unit -&gt; &#39;T []<br />&#160;&#160;member ToMathematicaString : unit -&gt; string<br />&#160;&#160;member ToMatlabString : unit -&gt; string<br />&#160;&#160;member ToSeq : unit -&gt; seq&lt;&#39;T&gt;<br />&#160;&#160;member FirstItem : &#39;T<br />&#160;&#160;member Item : i:int -&gt; &#39;T with get<br />&#160;&#160;member Length : int<br />&#160;&#160;member Item : i:int -&gt; &#39;T with set<br />&#160;&#160;static member Zero : Vector&lt;&#39;T&gt;<br />&#160;&#160;static member ( + ) : a:&#39;T * b:Vector&lt;&#39;T&gt; -&gt; Vector&lt;&#39;T&gt;<br />&#160;&#160;static member ( + ) : a:Vector&lt;&#39;T&gt; * b:&#39;T -&gt; Vector&lt;&#39;T&gt;<br />&#160;&#160;static member ( + ) : a:Vector&lt;&#39;T&gt; * b:Vector&lt;&#39;T&gt; -&gt; Vector&lt;&#39;T&gt;<br />&#160;&#160;static member ( / ) : a:&#39;T * b:Vector&lt;&#39;T&gt; -&gt; Vector&lt;&#39;T&gt;<br />&#160;&#160;static member ( / ) : a:Vector&lt;&#39;T&gt; * b:&#39;T -&gt; Vector&lt;&#39;T&gt;<br />&#160;&#160;static member ( ./ ) : a:Vector&lt;&#39;T&gt; * b:Vector&lt;&#39;T&gt; -&gt; Vector&lt;&#39;T&gt;<br />&#160;&#160;static member ( .* ) : a:Vector&lt;&#39;T&gt; * b:Vector&lt;&#39;T&gt; -&gt; Vector&lt;&#39;T&gt;<br />&#160;&#160;static member op_Explicit : v:Vector&lt;&#39;T&gt; -&gt; float []<br />&#160;&#160;static member ( * ) : a:&#39;T * b:Vector&lt;&#39;T&gt; -&gt; Vector&lt;&#39;T&gt;<br />&#160;&#160;static member ( * ) : a:Vector&lt;&#39;T&gt; * b:&#39;T -&gt; Vector&lt;&#39;T&gt;<br />&#160;&#160;static member ( * ) : a:Vector&lt;&#39;T&gt; * b:Vector&lt;&#39;T&gt; -&gt; &#39;T<br />&#160;&#160;static member ( %* ) : a:Vector&lt;&#39;T&gt; * b:Vector&lt;&#39;T&gt; -&gt; Vector&lt;&#39;T&gt;<br />&#160;&#160;static member ( - ) : a:&#39;T * b:Vector&lt;&#39;T&gt; -&gt; Vector&lt;&#39;T&gt;<br />&#160;&#160;static member ( - ) : a:Vector&lt;&#39;T&gt; * b:&#39;T -&gt; Vector&lt;&#39;T&gt;<br />&#160;&#160;static member ( - ) : a:Vector&lt;&#39;T&gt; * b:Vector&lt;&#39;T&gt; -&gt; Vector&lt;&#39;T&gt;<br />&#160;&#160;static member ( ~- ) : a:Vector&lt;&#39;T&gt; -&gt; Vector&lt;&#39;T&gt;<br /><br />Full name: FsAlg.Generic.Vector&lt;_&gt;</div>
<div class="tip" id="fs11">type Network =<br />&#160;&#160;{layers: Layer [];}<br /><br />Full name: Examples-neuralnetworks.Network</div>
<div class="tip" id="fs12">Network.layers: Layer []</div>
<div class="tip" id="fs13">val sigmoid : x:D -&gt; D<br /><br />Full name: Examples-neuralnetworks.sigmoid</div>
<div class="tip" id="fs14">val x : D</div>
<div class="tip" id="fs15">val exp : value:&#39;T -&gt; &#39;T (requires member Exp)<br /><br />Full name: Microsoft.FSharp.Core.Operators.exp</div>
<div class="tip" id="fs16">val runLayer : x:Vector&lt;D&gt; -&gt; l:Layer -&gt; Vector&lt;D&gt;<br /><br />Full name: Examples-neuralnetworks.runLayer</div>
<div class="tip" id="fs17">val x : Vector&lt;D&gt;</div>
<div class="tip" id="fs18">val l : Layer</div>
<div class="tip" id="fs19">val map : f:(&#39;T -&gt; &#39;U) -&gt; v:Vector&lt;&#39;T&gt; -&gt; Vector&lt;&#39;U&gt; (requires member get_Zero and member get_One and member ( + ) and member ( - ) and member ( * ) and member ( / ) and member ( ~- ) and member Abs and member Pow and member Sqrt and member op_Explicit and comparison and member get_Zero and member get_One and member ( + ) and member ( - ) and member ( * ) and member ( / ) and member ( ~- ) and member Abs and member Pow and member Sqrt and member op_Explicit and comparison)<br /><br />Full name: FsAlg.Generic.Vector.map</div>
<div class="tip" id="fs20">val runNetwork : x:Vector&lt;D&gt; -&gt; n:Network -&gt; Vector&lt;D&gt;<br /><br />Full name: Examples-neuralnetworks.runNetwork</div>
<div class="tip" id="fs21">val n : Network</div>
<div class="tip" id="fs22">module Array<br /><br />from Microsoft.FSharp.Collections</div>
<div class="tip" id="fs23">val fold : folder:(&#39;State -&gt; &#39;T -&gt; &#39;State) -&gt; state:&#39;State -&gt; array:&#39;T [] -&gt; &#39;State<br /><br />Full name: Microsoft.FSharp.Collections.Array.fold</div>
<div class="tip" id="fs24">val rnd : System.Random<br /><br />Full name: Examples-neuralnetworks.rnd</div>
<div class="tip" id="fs25">namespace System</div>
<div class="tip" id="fs26">Multiple items<br />type Random =<br />&#160;&#160;new : unit -&gt; Random + 1 overload<br />&#160;&#160;member Next : unit -&gt; int + 2 overloads<br />&#160;&#160;member NextBytes : buffer:byte[] -&gt; unit<br />&#160;&#160;member NextDouble : unit -&gt; float<br /><br />Full name: System.Random<br /><br />--------------------<br />System.Random() : unit<br />System.Random(Seed: int) : unit</div>
<div class="tip" id="fs27">val createNetwork : l:int [] -&gt; Network<br /><br />Full name: Examples-neuralnetworks.createNetwork</div>
<div class="tip" id="fs28">val l : int []</div>
<div class="tip" id="fs29">Multiple items<br />val int : value:&#39;T -&gt; int (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.int<br /><br />--------------------<br />type int = int32<br /><br />Full name: Microsoft.FSharp.Core.int<br /><br />--------------------<br />type int&lt;&#39;Measure&gt; = int<br /><br />Full name: Microsoft.FSharp.Core.int&lt;_&gt;</div>
<div class="tip" id="fs30">val init : count:int -&gt; initializer:(int -&gt; &#39;T) -&gt; &#39;T []<br /><br />Full name: Microsoft.FSharp.Collections.Array.init</div>
<div class="tip" id="fs31">property System.Array.Length: int</div>
<div class="tip" id="fs32">val i : int</div>
<div class="tip" id="fs33">val init : m:int -&gt; n:int -&gt; f:(int -&gt; int -&gt; &#39;T) -&gt; Matrix&lt;&#39;T&gt; (requires member get_Zero and member get_One and member ( + ) and member ( - ) and member ( * ) and member ( / ) and member ( ~- ) and member Abs and member Pow and member Sqrt and member op_Explicit and comparison)<br /><br />Full name: FsAlg.Generic.Matrix.init</div>
<div class="tip" id="fs34">union case D.D: float -&gt; D</div>
<div class="tip" id="fs35">System.Random.NextDouble() : float</div>
<div class="tip" id="fs36">val init : n:int -&gt; f:(int -&gt; &#39;T) -&gt; Vector&lt;&#39;T&gt; (requires member get_Zero and member get_One and member ( + ) and member ( - ) and member ( * ) and member ( / ) and member ( ~- ) and member Abs and member Pow and member Sqrt and member op_Explicit and comparison)<br /><br />Full name: FsAlg.Generic.Vector.init</div>
<div class="tip" id="fs37">val net1 : Network<br /><br />Full name: Examples-neuralnetworks.net1</div>
<div class="tip" id="fs38">val backprop : n:Network -&gt; eta:float -&gt; epsilon:float -&gt; timeout:int -&gt; t:(Vector&lt;D&gt; * Vector&lt;D&gt;) [] -&gt; seq&lt;float&gt;<br /><br />Full name: Examples-neuralnetworks.backprop</div>
<div class="tip" id="fs39">val eta : float</div>
<div class="tip" id="fs40">val epsilon : float</div>
<div class="tip" id="fs41">val timeout : int</div>
<div class="tip" id="fs42">val t : (Vector&lt;D&gt; * Vector&lt;D&gt;) []</div>
<div class="tip" id="fs43">val i : uint32</div>
<div class="tip" id="fs44">module Util<br /><br />from DiffSharp</div>
<div class="tip" id="fs45">Multiple items<br />type GlobalTagger =<br />&#160;&#160;new : unit -&gt; GlobalTagger<br />&#160;&#160;static member Next : uint32<br />&#160;&#160;static member Reset : unit<br /><br />Full name: DiffSharp.Util.GlobalTagger<br /><br />--------------------<br />new : unit -&gt; DiffSharp.Util.GlobalTagger</div>
<div class="tip" id="fs46">property DiffSharp.Util.GlobalTagger.Next: uint32</div>
<div class="tip" id="fs47">Multiple items<br />val seq : sequence:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Core.Operators.seq<br /><br />--------------------<br />type seq&lt;&#39;T&gt; = System.Collections.Generic.IEnumerable&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Collections.seq&lt;_&gt;</div>
<div class="tip" id="fs48">val j : int</div>
<div class="tip" id="fs49">val replace : f:(&#39;T -&gt; &#39;T) -&gt; m:Matrix&lt;&#39;T&gt; -&gt; unit (requires member get_Zero and member get_One and member ( + ) and member ( - ) and member ( * ) and member ( / ) and member ( ~- ) and member Abs and member Pow and member Sqrt and member op_Explicit and comparison)<br /><br />Full name: FsAlg.Generic.Matrix.replace</div>
<div class="tip" id="fs50">val makeDR : i:uint32 -&gt; p:D -&gt; D<br /><br />Full name: DiffSharp.AD.DOps.makeDR</div>
<div class="tip" id="fs51">val replace : f:(&#39;T -&gt; &#39;T) -&gt; v:Vector&lt;&#39;T&gt; -&gt; unit (requires member get_Zero and member get_One and member ( + ) and member ( - ) and member ( * ) and member ( / ) and member ( ~- ) and member Abs and member Pow and member Sqrt and member op_Explicit and comparison)<br /><br />Full name: FsAlg.Generic.Vector.replace</div>
<div class="tip" id="fs52">val error : D</div>
<div class="tip" id="fs53">val sumBy : projection:(&#39;T -&gt; &#39;U) -&gt; array:&#39;T [] -&gt; &#39;U (requires member ( + ) and member get_Zero)<br /><br />Full name: Microsoft.FSharp.Collections.Array.sumBy</div>
<div class="tip" id="fs54">val y : Vector&lt;D&gt;</div>
<div class="tip" id="fs55">val normSq : v:Vector&lt;&#39;T&gt; -&gt; &#39;T (requires member get_Zero and member get_One and member ( + ) and member ( - ) and member ( * ) and member ( / ) and member ( ~- ) and member Abs and member Pow and member Sqrt and member op_Explicit and comparison)<br /><br />Full name: FsAlg.Generic.Vector.normSq</div>
<div class="tip" id="fs56">val reverseProp : v:D -&gt; d:D -&gt; unit<br /><br />Full name: DiffSharp.AD.DOps.reverseProp</div>
<div class="tip" id="fs57">property D.P: D</div>
<div class="tip" id="fs58">property D.A: D</div>
<div class="tip" id="fs59">val printfn : format:Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.printfn</div>
<div class="tip" id="fs60">Multiple items<br />val float : value:&#39;T -&gt; float (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.float<br /><br />--------------------<br />type float = System.Double<br /><br />Full name: Microsoft.FSharp.Core.float<br /><br />--------------------<br />type float&lt;&#39;Measure&gt; = float<br /><br />Full name: Microsoft.FSharp.Core.float&lt;_&gt;</div>
<div class="tip" id="fs61">module Seq<br /><br />from Microsoft.FSharp.Collections</div>
<div class="tip" id="fs62">val takeWhile : predicate:(&#39;T -&gt; bool) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.takeWhile</div>
<div class="tip" id="fs63">namespace FSharp</div>
<div class="tip" id="fs64">namespace FSharp.Charting</div>
<div class="tip" id="fs65">val trainOR : (Vector&lt;D&gt; * Vector&lt;D&gt;) []<br /><br />Full name: Examples-neuralnetworks.trainOR</div>
<div class="tip" id="fs66">val vector : v:seq&lt;&#39;T&gt; -&gt; Vector&lt;&#39;T&gt; (requires member get_Zero and member get_One and member ( + ) and member ( - ) and member ( * ) and member ( / ) and member ( ~- ) and member Abs and member Pow and member Sqrt and member op_Explicit and comparison)<br /><br />Full name: FsAlg.Generic.Ops.vector</div>
<div class="tip" id="fs67">val net2 : Network<br /><br />Full name: Examples-neuralnetworks.net2</div>
<div class="tip" id="fs68">val train2 : seq&lt;float&gt;<br /><br />Full name: Examples-neuralnetworks.train2</div>
<div class="tip" id="fs69">type Chart =<br />&#160;&#160;static member Area : data:seq&lt;#value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string -&gt; GenericChart<br />&#160;&#160;static member Area : data:seq&lt;#key * #value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string -&gt; GenericChart<br />&#160;&#160;static member Bar : data:seq&lt;#value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string -&gt; GenericChart<br />&#160;&#160;static member Bar : data:seq&lt;#key * #value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string -&gt; GenericChart<br />&#160;&#160;static member BoxPlotFromData : data:seq&lt;#key * #seq&lt;&#39;a2&gt;&gt; * ?Name:string * ?Title:string * ?Color:Color * ?XTitle:string * ?YTitle:string * ?Percentile:int * ?ShowAverage:bool * ?ShowMedian:bool * ?ShowUnusualValues:bool * ?WhiskerPercentile:int -&gt; GenericChart (requires &#39;a2 :&gt; value)<br />&#160;&#160;static member BoxPlotFromStatistics : data:seq&lt;#key * #value * #value * #value * #value * #value * #value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string * ?Percentile:int * ?ShowAverage:bool * ?ShowMedian:bool * ?ShowUnusualValues:bool * ?WhiskerPercentile:int -&gt; GenericChart<br />&#160;&#160;static member Bubble : data:seq&lt;#value * #value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string * ?BubbleMaxSize:int * ?BubbleMinSize:int * ?BubbleScaleMax:float * ?BubbleScaleMin:float * ?UseSizeForLabel:bool -&gt; GenericChart<br />&#160;&#160;static member Bubble : data:seq&lt;#key * #value * #value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string * ?BubbleMaxSize:int * ?BubbleMinSize:int * ?BubbleScaleMax:float * ?BubbleScaleMin:float * ?UseSizeForLabel:bool -&gt; GenericChart<br />&#160;&#160;static member Candlestick : data:seq&lt;#value * #value * #value * #value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string -&gt; CandlestickChart<br />&#160;&#160;static member Candlestick : data:seq&lt;#key * #value * #value * #value * #value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:Color * ?XTitle:string * ?YTitle:string -&gt; CandlestickChart<br />&#160;&#160;...<br /><br />Full name: FSharp.Charting.Chart</div>
<div class="tip" id="fs70">static member Chart.Line : data:seq&lt;#value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:System.Drawing.Color * ?XTitle:string * ?YTitle:string -&gt; ChartTypes.GenericChart<br />static member Chart.Line : data:seq&lt;#key * #value&gt; * ?Name:string * ?Title:string * ?Labels:#seq&lt;string&gt; * ?Color:System.Drawing.Color * ?XTitle:string * ?YTitle:string -&gt; ChartTypes.GenericChart</div>
<div class="tip" id="fs71">val printf : format:Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.printf</div>
<div class="tip" id="fs72">val trainXOR : (Vector&lt;D&gt; * Vector&lt;D&gt;) []<br /><br />Full name: Examples-neuralnetworks.trainXOR</div>
<div class="tip" id="fs73">val net3 : Network<br /><br />Full name: Examples-neuralnetworks.net3</div>
<div class="tip" id="fs74">val train3 : seq&lt;float&gt;<br /><br />Full name: Examples-neuralnetworks.train3</div>
          
        </div>
        <div class="span3">
          <a href="index.html"><img src="img/diffsharp-logo.png" style="width:140px;height:140px;margin:10px 0px 0px 20px;border-style:none;"/></a>

          <ul class="nav nav-list" id="menu">
            <li class="nav-header">DiffSharp</li>
            <li class="divider"></li>
            <li><a href="index.html">Home Page</a></li>
            <li><a href="https://www.nuget.org/packages/diffsharp">Get DiffSharp via NuGet</a></li>
            <li><a href="https://github.com/DiffSharp/DiffSharp">GitHub Page</a></li>
            <li><a href="https://github.com/DiffSharp/DiffSharp/releases">Release Notes</a></li>

            <li class="nav-header">Getting Started</li>
            <li class="divider"></li>
            <li><a href="gettingstarted-typeinference.html">Type Inference</a></li>
            <li><a href="api-overview.html">API Overview</a></li>
            <li><a href="gettingstarted-nestedad.html">Nested AD</a></li>
            <li><a href="gettingstarted-nonnestedad.html">Non-nested AD</a></li>
            <li><a href="gettingstarted-numericaldifferentiation.html">Numerical Differentiation</a></li>
            <li><a href="gettingstarted-symbolicdifferentiation.html">Symbolic Differentiation</a></li>
            <li><a href="benchmarks.html">Benchmarks</a></li>
            <li><a href="csharp.html">C# and Other Languages</a></li>            
            <li><a href="reference/index.html">API Reference</a></li>

            <li class="nav-header">Examples</li>
            <li class="divider"></li>

            <li class="nav-header">Machine Learning</li>
            <li><a href="examples-gradientdescent.html">Gradient Descent</a></li>
            <li><a href="examples-newtonsmethod.html">Newton's Method</a></li>
            <li><a href="examples-stochasticgradientdescent.html">Stochastic Gradient Descent</a></li>
            <li><a href="examples-kmeansclustering.html">K-Means Clustering</a></li>
            <li><a href="examples-hamiltonianmontecarlo.html">Hamiltonian Monte Carlo</a></li>
            <li><a href="examples-neuralnetworks.html">Neural Networks</a></li>
            <li>Neural Turing Machines (to come)</li>
            <li>Probabilistic Programming<br>(to come)</li>

            <li class="nav-header">Dynamical Systems</li>
            <li>Stability Analysis (to come)</li>

            <li class="nav-header">Control</li>
            <li><a href="examples-inversekinematics.html">Inverse Kinematics</a></li>
            <li>Adaptive Control (to come)</li>

            <li class="nav-header">Physics</li>
            <li><a href="examples-kinematics.html">Kinematics</a></li>
            <li>Leapfrog Integration (to come)</li>
            <li><a href="examples-helmholtzenergyfunction.html">Helmholtz Energy Function</a></li>

            <li class="nav-header">Math</li>
            <li><a href="examples-lhopitalsrule.html">l'Hôpital's Rule</a></li>

            <li class="nav-header">Makers</li>
            <li class="divider"></li>
            <li><a href="https://www.cs.nuim.ie/~gunes/">Atılım Güneş Baydin</a></li>
            <li><a href="http://www.bcl.hamilton.ie/~barak/">Barak A. Pearlmutter</a></li>
            <li><a href="http://www.bcl.hamilton.ie/">Brain and Computation Lab</a></li>
          </ul>
        </div>
      </div>
    </div>
    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=10059115; 
    var sc_invisible=1; 
    var sc_security="92275ee1"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="https://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="https://c.statcounter.com/10059115/0/92275ee1/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->
  </body>
</html>